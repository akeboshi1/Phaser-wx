!function webpackUniversalModuleDefinition(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.main=factory():root.main=factory()}(self,(function(){return(()=>{"use strict";var __webpack_modules__={"./raycaster/BoundsToPolygon.js":
/*!**************************************!*\
  !*** ./raycaster/BoundsToPolygon.js ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _GetBounds_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! ./GetBounds.js */"./raycaster/GetBounds.js");const Polygon=Phaser.Geom.Polygon;var BoundsToPolygon;const __WEBPACK_DEFAULT_EXPORT__=function(gameObject,out){void 0===out&&(out=new Polygon);var p0=(0,_GetBounds_js__WEBPACK_IMPORTED_MODULE_0__.GetTopLeft)(gameObject),p1=(0,_GetBounds_js__WEBPACK_IMPORTED_MODULE_0__.GetTopRight)(gameObject),p2=(0,_GetBounds_js__WEBPACK_IMPORTED_MODULE_0__.GetBottomRight)(gameObject),p3=(0,_GetBounds_js__WEBPACK_IMPORTED_MODULE_0__.GetBottomLeft)(gameObject);return out.setTo([p0,p1,p2,p3,p0]),out}},"./raycaster/Clear.js":
/*!****************************!*\
  !*** ./raycaster/Clear.js ***!
  \****************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var Clear;__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function(obj){if("object"!=typeof obj||null===obj)return obj;if(Array.isArray(obj))obj.length=0;else for(var key in obj)delete obj[key];return obj}},"./raycaster/Clone.js":
/*!****************************!*\
  !*** ./raycaster/Clone.js ***!
  \****************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _Clear_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! ./Clear.js */"./raycaster/Clear.js"),Clone;const __WEBPACK_DEFAULT_EXPORT__=function(obj,out){var objIsArray=Array.isArray(obj);if(void 0===out?out=objIsArray?[]:{}:(0,_Clear_js__WEBPACK_IMPORTED_MODULE_0__.default)(out),objIsArray){out.length=obj.length;for(var i=0,cnt=obj.length;i<cnt;i++)out[i]=obj[i]}else for(var key in obj)out[key]=obj[key];return out}},"./raycaster/GetBounds.js":
/*!********************************!*\
  !*** ./raycaster/GetBounds.js ***!
  \********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{GetBounds:()=>GetBounds,GetTopLeft:()=>GetTopLeft,GetTopRight:()=>GetTopRight,GetBottomLeft:()=>GetBottomLeft,GetBottomRight:()=>GetBottomRight});var _GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! ./GetDisplaySize.js */"./raycaster/GetDisplaySize.js");const Rectangle=Phaser.Geom.Rectangle,Vector2=Phaser.Math.Vector2,RotateAround=Phaser.Math.RotateAround;var GetBounds=function(gameObject,output){if(void 0===output?output=new Rectangle:!0===output&&(void 0===GlobRect&&(GlobRect=new Rectangle),output=GlobRect),gameObject.getBounds)return gameObject.getBounds(output);var TLx,TLy,TRx,TRy,BLx,BLy,BRx,BRy;if(gameObject.parentContainer){var parentMatrix=gameObject.parentContainer.getBoundsTransformMatrix();GetTopLeft(gameObject,output),parentMatrix.transformPoint(output.x,output.y,output),TLx=output.x,TLy=output.y,GetTopRight(gameObject,output),parentMatrix.transformPoint(output.x,output.y,output),TRx=output.x,TRy=output.y,GetBottomLeft(gameObject,output),parentMatrix.transformPoint(output.x,output.y,output),BLx=output.x,BLy=output.y,GetBottomRight(gameObject,output),parentMatrix.transformPoint(output.x,output.y,output),BRx=output.x,BRy=output.y}else GetTopLeft(gameObject,output),TLx=output.x,TLy=output.y,GetTopRight(gameObject,output),TRx=output.x,TRy=output.y,GetBottomLeft(gameObject,output),BLx=output.x,BLy=output.y,GetBottomRight(gameObject,output),BRx=output.x,BRy=output.y;return output.x=Math.min(TLx,TRx,BLx,BRx),output.y=Math.min(TLy,TRy,BLy,BRy),output.width=Math.max(TLx,TRx,BLx,BRx)-output.x,output.height=Math.max(TLy,TRy,BLy,BRy)-output.y,output},GlobRect=void 0,GetTopLeft=function(gameObject,output,includeParent){return void 0===output?output=new Vector2:!0===output&&(void 0===GlobVector&&(GlobVector=new Vector2),output=GlobVector),gameObject.getTopLeft?gameObject.getTopLeft(output):(output.x=gameObject.x-(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayWidth)(gameObject)*gameObject.originX,output.y=gameObject.y-(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayHeight)(gameObject)*gameObject.originY,PrepareBoundsOutput(gameObject,output,includeParent))},GetTopRight=function(gameObject,output,includeParent){return void 0===output?output=new Vector2:!0===output&&(void 0===GlobVector&&(GlobVector=new Vector2),output=GlobVector),gameObject.getTopRight?gameObject.getTopRight(output):(output.x=gameObject.x-(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayWidth)(gameObject)*gameObject.originX+(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayWidth)(gameObject),output.y=gameObject.y-(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayHeight)(gameObject)*gameObject.originY,PrepareBoundsOutput(gameObject,output,includeParent))},GetBottomLeft=function(gameObject,output,includeParent){return void 0===output?output=new Vector2:!0===output&&(void 0===GlobVector&&(GlobVector=new Vector2),output=GlobVector),gameObject.getBottomLeft?gameObject.getBottomLeft(output):(output.x=gameObject.x-(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayWidth)(gameObject)*gameObject.originX,output.y=gameObject.y-(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayHeight)(gameObject)*gameObject.originY+(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayHeight)(gameObject),PrepareBoundsOutput(gameObject,output,includeParent))},GetBottomRight=function(gameObject,output,includeParent){return void 0===output?output=new Vector2:!0===output&&(void 0===GlobVector&&(GlobVector=new Vector2),output=GlobVector),gameObject.getBottomRight?gameObject.getBottomRight(output):(output.x=gameObject.x-(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayWidth)(gameObject)*gameObject.originX+(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayWidth)(gameObject),output.y=gameObject.y-(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayHeight)(gameObject)*gameObject.originY+(0,_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__.GetDisplayHeight)(gameObject),PrepareBoundsOutput(gameObject,output,includeParent))},GlobVector=void 0,PrepareBoundsOutput=function(gameObject,output,includeParent){var parentMatrix;(void 0===includeParent&&(includeParent=!1),0!==gameObject.rotation&&RotateAround(output,gameObject.x,gameObject.y,gameObject.rotation),includeParent&&gameObject.parentContainer)&&gameObject.parentContainer.getBoundsTransformMatrix().transformPoint(output.x,output.y,output);return output}},"./raycaster/GetDisplaySize.js":
/*!*************************************!*\
  !*** ./raycaster/GetDisplaySize.js ***!
  \*************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{GetDisplayWidth:()=>GetDisplayWidth,GetDisplayHeight:()=>GetDisplayHeight});var GetDisplayWidth=function(gameObject){return void 0!==gameObject.displayWidth?gameObject.displayWidth:gameObject.width},GetDisplayHeight=function(gameObject){return void 0!==gameObject.displayHeight?gameObject.displayHeight:gameObject.height}},"./raycaster/GetLineToPoints.js":
/*!**************************************!*\
  !*** ./raycaster/GetLineToPoints.js ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});const GetLineToLine=Phaser.Geom.Intersects.GetLineToLine,PointToLine=Phaser.Geom.Intersects.PointToLine;var GetLineToPoints=function(line,points,out){void 0===out?out={}:!0===out&&(out=globResult);var closestIntersect=!1;startPoint.setTo(line.x1,line.y1),out.d=1/0,tempIntersect.set();for(var prev=points[0],i=1;i<points.length;i++){var current=points[i];segment.setTo(prev.x,prev.y,current.x,current.y),prev=current,PointToLine(startPoint,segment)||GetLineToLine(line,segment,tempIntersect)&&tempIntersect.z<out.d&&(out.x=tempIntersect.x,out.y=tempIntersect.y,out.d=tempIntersect.z,out.segIndex=i-1,closestIntersect=!0)}return closestIntersect?out:null},globResult={},startPoint=new Phaser.Geom.Point,segment=new Phaser.Geom.Line,tempIntersect=new Phaser.Math.Vector3;const __WEBPACK_DEFAULT_EXPORT__=GetLineToPoints},"./raycaster/GetLineToPolygon.js":
/*!***************************************!*\
  !*** ./raycaster/GetLineToPolygon.js ***!
  \***************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _GetLineToPoints_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! ./GetLineToPoints.js */"./raycaster/GetLineToPoints.js"),_Clone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(/*! ./Clone.js */"./raycaster/Clone.js");const GetAABB=Phaser.Geom.Polygon.GetAABB,LineToRectangle=Phaser.Geom.Intersects.LineToRectangle;var GetLineToPolygon=function(line,polygons,out){void 0===out?out={}:!0===out&&(out=globResult),Array.isArray(polygons)||(polygons=[polygons]);var closestIntersect=!1;out.d=1/0;for(var i=0;i<polygons.length;i++){var polygon=polygons[i];if(!(polygon.points.length>9)||LineToRectangle(line,GetAABB(polygon,AABBRect))){var intersectionResult=(0,_GetLineToPoints_js__WEBPACK_IMPORTED_MODULE_0__.default)(line,polygon.points,!0);intersectionResult&&intersectionResult.d<out.d&&((0,_Clone_js__WEBPACK_IMPORTED_MODULE_1__.default)(intersectionResult,out),out.shapeIndex=i,closestIntersect=!0)}}return closestIntersect?out:null},globResult={},AABBRect=new Phaser.Geom.Rectangle;const __WEBPACK_DEFAULT_EXPORT__=GetLineToPolygon},"./raycaster/IsGameObject.js":
/*!***********************************!*\
  !*** ./raycaster/IsGameObject.js ***!
  \***********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});const GameObjectClass=Phaser.GameObjects.GameObject;var IsGameObject;const __WEBPACK_DEFAULT_EXPORT__=function(object){return object instanceof GameObjectClass}},"./raycaster/Obstacles.js":
/*!********************************!*\
  !*** ./raycaster/Obstacles.js ***!
  \********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _IsGameObject_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! ./IsGameObject.js */"./raycaster/IsGameObject.js"),_BoundsToPolygon_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(/*! ./BoundsToPolygon.js */"./raycaster/BoundsToPolygon.js");const Polygon=Phaser.Geom.Polygon,SpliceOne=Phaser.Utils.Array.SpliceOne;class Obstacles{constructor(){this.gameObjects=[],this.polygons=[]}contains(gameObject){return-1!==this.gameObjects.indexOf(gameObject)}get(index){return Obstacle.gameObject=this.gameObjects[index],Obstacle.polygon=this.polygons[index],Obstacle}addDestroyCallback(gameObject){if(Array.isArray(gameObject)){for(var gameObjects=gameObject,i=0,cnt=gameObjects.length;i<cnt;i++)this.addDestroyCallback(gameObjects[i]);return this}return gameObject.on&&gameObject.once("destroy",this.onChildDestroy,this),this}removeDestroyCallback(gameObject){if(Array.isArray(gameObject)){for(var gameObjects=gameObject,i=0,cnt=gameObjects.length;i<cnt;i++)this.removeDestroyCallback(gameObjects[i]);return this}return gameObject.off&&gameObject.off("destroy",this.onChildDestroy,this),this}clear(){return this.removeDestroyCallback(this.gameObjects),this.gameObjects.length=0,this.polygons.length=0,this}add(gameObject,polygon){return this.contains(gameObject)?this:((0,_IsGameObject_js__WEBPACK_IMPORTED_MODULE_0__.default)(gameObject)?void 0===polygon&&(polygon=(0,_BoundsToPolygon_js__WEBPACK_IMPORTED_MODULE_1__.default)(gameObject)):gameObject instanceof Polygon&&(polygon=gameObject),this.gameObjects.push(gameObject),this.polygons.push(polygon),this.addDestroyCallback(gameObject),this)}remove(gameObject){var index=this.gameObjects.indexOf(gameObject);return-1===index?this:(SpliceOne(this.gameObjects,index),SpliceOne(this.polygons,index),this.removeDestroyCallback(gameObject),this)}onChildDestroy(child,fromScene){this.remove(child)}update(gameObject,polygon){var index=this.gameObjects.indexOf(gameObject);return-1===index?this:(void 0===polygon&&(polygon=(0,_BoundsToPolygon_js__WEBPACK_IMPORTED_MODULE_1__.default)(gameObject,this.polygons[index])),this.polygons[index]=polygon,this)}}var Obstacle={};const __WEBPACK_DEFAULT_EXPORT__=Obstacles},"./raycaster/Raycaster.js":
/*!********************************!*\
  !*** ./raycaster/Raycaster.js ***!
  \********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RayCaster:()=>RayCaster});var _Obstacles_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! ./Obstacles.js */"./raycaster/Obstacles.js"),_GetLineToPolygon_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(/*! ./GetLineToPolygon.js */"./raycaster/GetLineToPolygon.js");const GetValue=Phaser.Utils.Objects.GetValue,Line=Phaser.Geom.Line,SetToAngle=Phaser.Geom.Line.SetToAngle,ReflectAngle=Phaser.Geom.Line.ReflectAngle;class RayCaster{constructor(config){this.obstacles=new _Obstacles_js__WEBPACK_IMPORTED_MODULE_0__.default,this.ray=new Line,this.setMaxRayLength(GetValue(config,"maxRayLength",1e4)),this.result={hit:!1,x:0,y:0,segment:new Line,polygon:null,gameObject:null,reflectAngle:0}}destroy(){this.obstacles.clear(),this.obstacles=null,this.ray=null,this.result=null}setMaxRayLength(length){return this.maxRayLength=length,this}addObstacle(gameObject,polygon){if(Array.isArray(gameObject))for(var gameObjects=gameObject,i=0,cnt=gameObjects.length;i<cnt;i++)this.obstacles.add(gameObjects[i]);else this.obstacles.add(gameObject,polygon);return this}clearObstacle(){return this.obstacles.clear(),this}removeObstacle(gameObject){if(Array.isArray(gameObject))for(var gameObjects=gameObject,i=0,cnt=gameObjects.length;i<cnt;i++)this.obstacles.remove(gameObjects[i]);else this.obstacles.remove(gameObject);return this}updateObstacle(gameObject,polygon){if(Array.isArray(gameObject))for(var gameObjects=gameObject,i=0,cnt=gameObjects.length;i<cnt;i++)this.obstacles.update(gameObjects[i]);else this.obstacles.update(gameObject,polygon);return this}hitTest(){var result=(0,_GetLineToPolygon_js__WEBPACK_IMPORTED_MODULE_1__.default)(this.ray,this.obstacles.polygons,!0);if(result){this.ray.x2=result.x,this.ray.y2=result.y,this.result.hit=!0,this.result.x=result.x,this.result.y=result.y;var obstacle=this.obstacles.get(result.shapeIndex);this.result.polygon=obstacle.polygon,this.result.gameObject=obstacle.gameObject;var points=this.result.polygon.points,segIndex=result.segIndex,p0=points[segIndex],p1=points[segIndex+1],segment=this.result.segment;segment.setTo(p0.x,p0.y,p1.x,p1.y),this.result.reflectAngle=ReflectAngle(this.ray,segment)}else this.result.hit=!1;return!!result&&this.result}rayToward(x,y,angle){return SetToAngle(this.ray,x,y,angle,this.maxRayLength),this.hitTest()}}}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.r=exports=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{
/*!****************************!*\
  !*** ./raycaster/index.js ***!
  \****************************/
__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RayCaster:()=>_Raycaster__WEBPACK_IMPORTED_MODULE_0__.RayCaster});var _Raycaster__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! ./Raycaster */"./raycaster/Raycaster.js")})(),__webpack_exports__})()}));