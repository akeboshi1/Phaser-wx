"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),dragonBones;!function(dragonBones){var DragonBones=function(){function DragonBones(eventManager){this._clock=new dragonBones.WorldClock,this._events=[],this._objects=[],this._eventManager=null,this._eventManager=eventManager,console.info("DragonBones: "+DragonBones.VERSION+"\nWebsite: http://dragonbones.com/\nSource and Demo: https://github.com/DragonBones/")}return DragonBones.prototype.advanceTime=function(passedTime){if(this._objects.length>0){for(var _i=0,_a=this._objects;_i<_a.length;_i++){var object;_a[_i].returnToPool()}this._objects.length=0}if(this._clock.advanceTime(passedTime),this._events.length>0){for(var i=0;i<this._events.length;++i){var eventObject=this._events[i],armature=eventObject.armature;null!==armature._armatureData&&(armature.eventDispatcher.dispatchDBEvent(eventObject.type,eventObject),eventObject.type===dragonBones.EventObject.SOUND_EVENT&&this._eventManager.dispatchDBEvent(eventObject.type,eventObject)),this.bufferObject(eventObject)}this._events.length=0}},DragonBones.prototype.bufferEvent=function(value){this._events.indexOf(value)<0&&this._events.push(value)},DragonBones.prototype.bufferObject=function(object){this._objects.indexOf(object)<0&&this._objects.push(object)},Object.defineProperty(DragonBones.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(DragonBones.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),DragonBones.VERSION="5.7.000",DragonBones.yDown=!0,DragonBones.debug=!1,DragonBones.debugDraw=!1,DragonBones}();dragonBones.DragonBones=DragonBones}(dragonBones||(dragonBones={})),console.warn||(console.warn=function(){}),console.assert||(console.assert=function(){}),Date.now||(Date.now=function now(){return(new Date).getTime()});var __extends=function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r},dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones,dragonBones;if(void 0===global&&"undefined"!=typeof window)var global=window;"object"==typeof exports&&"object"==typeof module?module.exports=dragonBones:"function"==typeof define&&define.amd?define(["dragonBones"],(function(){return dragonBones})):"object"==typeof exports?exports=dragonBones:void 0!==global&&(global.dragonBones=dragonBones),function(dragonBones){var BaseObject=function(){function BaseObject(){this.hashCode=BaseObject._hashCode++,this._isInPool=!1}return BaseObject._returnObject=function(object){var classType=String(object.constructor),maxCount=classType in BaseObject._maxCountMap?BaseObject._maxCountMap[classType]:BaseObject._defaultMaxCount,pool=BaseObject._poolsMap[classType]=BaseObject._poolsMap[classType]||[];pool.length<maxCount&&(object._isInPool?console.warn("The object is already in the pool."):(object._isInPool=!0,pool.push(object)))},BaseObject.toString=function(){throw new Error},BaseObject.setMaxCount=function(objectConstructor,maxCount){var classType,pool;if((maxCount<0||maxCount!=maxCount)&&(maxCount=0),null!==objectConstructor)null!==(pool=(classType=String(objectConstructor))in BaseObject._poolsMap?BaseObject._poolsMap[classType]:null)&&pool.length>maxCount&&(pool.length=maxCount),BaseObject._maxCountMap[classType]=maxCount;else for(var classType in BaseObject._defaultMaxCount=maxCount,BaseObject._poolsMap){var pool;(pool=BaseObject._poolsMap[classType]).length>maxCount&&(pool.length=maxCount),classType in BaseObject._maxCountMap&&(BaseObject._maxCountMap[classType]=maxCount)}},BaseObject.clearPool=function(objectConstructor){if(void 0===objectConstructor&&(objectConstructor=null),null!==objectConstructor){var classType=String(objectConstructor),pool;null!==(pool=classType in BaseObject._poolsMap?BaseObject._poolsMap[classType]:null)&&pool.length>0&&(pool.length=0)}else for(var k in BaseObject._poolsMap){var pool;(pool=BaseObject._poolsMap[k]).length=0}},BaseObject.borrowObject=function(objectConstructor){var classType=String(objectConstructor),pool=classType in BaseObject._poolsMap?BaseObject._poolsMap[classType]:null;if(null!==pool&&pool.length>0){var object_1=pool.pop();return object_1._isInPool=!1,object_1}var object=new objectConstructor;return object._onClear(),object},BaseObject.prototype.returnToPool=function(){this._onClear(),BaseObject._returnObject(this)},BaseObject._hashCode=0,BaseObject._defaultMaxCount=3e3,BaseObject._maxCountMap={},BaseObject._poolsMap={},BaseObject}();dragonBones.BaseObject=BaseObject}(dragonBones||(dragonBones={})),function(dragonBones){var Matrix=function(){function Matrix(a,b,c,d,tx,ty){void 0===a&&(a=1),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),void 0===tx&&(tx=0),void 0===ty&&(ty=0),this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty}return Matrix.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},Matrix.prototype.copyFrom=function(value){return this.a=value.a,this.b=value.b,this.c=value.c,this.d=value.d,this.tx=value.tx,this.ty=value.ty,this},Matrix.prototype.copyFromArray=function(value,offset){return void 0===offset&&(offset=0),this.a=value[offset],this.b=value[offset+1],this.c=value[offset+2],this.d=value[offset+3],this.tx=value[offset+4],this.ty=value[offset+5],this},Matrix.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},Matrix.prototype.concat=function(value){var aA=this.a*value.a,bA=0,cA=0,dA=this.d*value.d,txA=this.tx*value.a+value.tx,tyA=this.ty*value.d+value.ty;return 0===this.b&&0===this.c||(aA+=this.b*value.c,bA+=this.b*value.d,cA+=this.c*value.a,dA+=this.c*value.b),0===value.b&&0===value.c||(bA+=this.a*value.b,cA+=this.d*value.c,txA+=this.ty*value.c,tyA+=this.tx*value.b),this.a=aA,this.b=bA,this.c=cA,this.d=dA,this.tx=txA,this.ty=tyA,this},Matrix.prototype.invert=function(){var aA=this.a,bA=this.b,cA=this.c,dA=this.d,txA=this.tx,tyA=this.ty;if(0===bA&&0===cA)return this.b=this.c=0,0===aA||0===dA?this.a=this.b=this.tx=this.ty=0:(aA=this.a=1/aA,dA=this.d=1/dA,this.tx=-aA*txA,this.ty=-dA*tyA),this;var determinant=aA*dA-bA*cA;if(0===determinant)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;determinant=1/determinant;var k=this.a=dA*determinant;return bA=this.b=-bA*determinant,cA=this.c=-cA*determinant,dA=this.d=aA*determinant,this.tx=-(k*txA+cA*tyA),this.ty=-(bA*txA+dA*tyA),this},Matrix.prototype.transformPoint=function(x,y,result,delta){void 0===delta&&(delta=!1),result.x=this.a*x+this.c*y,result.y=this.b*x+this.d*y,delta||(result.x+=this.tx,result.y+=this.ty)},Matrix.prototype.transformRectangle=function(rectangle,delta){void 0===delta&&(delta=!1);var a=this.a,b=this.b,c=this.c,d=this.d,tx=delta?0:this.tx,ty=delta?0:this.ty,x=rectangle.x,y=rectangle.y,xMax=x+rectangle.width,yMax=y+rectangle.height,x0=a*x+c*y+tx,y0=b*x+d*y+ty,x1=a*xMax+c*y+tx,y1=b*xMax+d*y+ty,x2=a*xMax+c*yMax+tx,y2=b*xMax+d*yMax+ty,x3=a*x+c*yMax+tx,y3=b*x+d*yMax+ty,tmp=0;x0>x1&&(tmp=x0,x0=x1,x1=tmp),x2>x3&&(tmp=x2,x2=x3,x3=tmp),rectangle.x=Math.floor(x0<x2?x0:x2),rectangle.width=Math.ceil((x1>x3?x1:x3)-rectangle.x),y0>y1&&(tmp=y0,y0=y1,y1=tmp),y2>y3&&(tmp=y2,y2=y3,y3=tmp),rectangle.y=Math.floor(y0<y2?y0:y2),rectangle.height=Math.ceil((y1>y3?y1:y3)-rectangle.y)},Matrix}();dragonBones.Matrix=Matrix}(dragonBones||(dragonBones={})),function(dragonBones){var Transform=function(){function Transform(x,y,skew,rotation,scaleX,scaleY){void 0===x&&(x=0),void 0===y&&(y=0),void 0===skew&&(skew=0),void 0===rotation&&(rotation=0),void 0===scaleX&&(scaleX=1),void 0===scaleY&&(scaleY=1),this.x=x,this.y=y,this.skew=skew,this.rotation=rotation,this.scaleX=scaleX,this.scaleY=scaleY}return Transform.normalizeRadian=function(value){return value=(value+Math.PI)%(2*Math.PI),value+=value>0?-Math.PI:Math.PI},Transform.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skew/Math.PI+" skewY:"+180*this.rotation/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},Transform.prototype.copyFrom=function(value){return this.x=value.x,this.y=value.y,this.skew=value.skew,this.rotation=value.rotation,this.scaleX=value.scaleX,this.scaleY=value.scaleY,this},Transform.prototype.identity=function(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this},Transform.prototype.add=function(value){return this.x+=value.x,this.y+=value.y,this.skew+=value.skew,this.rotation+=value.rotation,this.scaleX*=value.scaleX,this.scaleY*=value.scaleY,this},Transform.prototype.minus=function(value){return this.x-=value.x,this.y-=value.y,this.skew-=value.skew,this.rotation-=value.rotation,this.scaleX/=value.scaleX,this.scaleY/=value.scaleY,this},Transform.prototype.fromMatrix=function(matrix){var backupScaleX=this.scaleX,backupScaleY=this.scaleY,PI_Q=Transform.PI_Q;this.x=matrix.tx,this.y=matrix.ty,this.rotation=Math.atan(matrix.b/matrix.a);var skewX=Math.atan(-matrix.c/matrix.d);return this.scaleX=this.rotation>-PI_Q&&this.rotation<PI_Q?matrix.a/Math.cos(this.rotation):matrix.b/Math.sin(this.rotation),this.scaleY=skewX>-PI_Q&&skewX<PI_Q?matrix.d/Math.cos(skewX):-matrix.c/Math.sin(skewX),backupScaleX>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),backupScaleY>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,skewX-=Math.PI),this.skew=skewX-this.rotation,this},Transform.prototype.toMatrix=function(matrix){return 0===this.rotation?(matrix.a=1,matrix.b=0):(matrix.a=Math.cos(this.rotation),matrix.b=Math.sin(this.rotation)),0===this.skew?(matrix.c=-matrix.b,matrix.d=matrix.a):(matrix.c=-Math.sin(this.skew+this.rotation),matrix.d=Math.cos(this.skew+this.rotation)),1!==this.scaleX&&(matrix.a*=this.scaleX,matrix.b*=this.scaleX),1!==this.scaleY&&(matrix.c*=this.scaleY,matrix.d*=this.scaleY),matrix.tx=this.x,matrix.ty=this.y,this},Transform.PI=Math.PI,Transform.PI_D=2*Math.PI,Transform.PI_H=Math.PI/2,Transform.PI_Q=Math.PI/4,Transform.RAD_DEG=180/Math.PI,Transform.DEG_RAD=Math.PI/180,Transform}();dragonBones.Transform=Transform}(dragonBones||(dragonBones={})),function(dragonBones){var ColorTransform=function(){function ColorTransform(alphaMultiplier,redMultiplier,greenMultiplier,blueMultiplier,alphaOffset,redOffset,greenOffset,blueOffset){void 0===alphaMultiplier&&(alphaMultiplier=1),void 0===redMultiplier&&(redMultiplier=1),void 0===greenMultiplier&&(greenMultiplier=1),void 0===blueMultiplier&&(blueMultiplier=1),void 0===alphaOffset&&(alphaOffset=0),void 0===redOffset&&(redOffset=0),void 0===greenOffset&&(greenOffset=0),void 0===blueOffset&&(blueOffset=0),this.alphaMultiplier=alphaMultiplier,this.redMultiplier=redMultiplier,this.greenMultiplier=greenMultiplier,this.blueMultiplier=blueMultiplier,this.alphaOffset=alphaOffset,this.redOffset=redOffset,this.greenOffset=greenOffset,this.blueOffset=blueOffset}return ColorTransform.prototype.copyFrom=function(value){this.alphaMultiplier=value.alphaMultiplier,this.redMultiplier=value.redMultiplier,this.greenMultiplier=value.greenMultiplier,this.blueMultiplier=value.blueMultiplier,this.alphaOffset=value.alphaOffset,this.redOffset=value.redOffset,this.greenOffset=value.greenOffset,this.blueOffset=value.blueOffset},ColorTransform.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},ColorTransform}();dragonBones.ColorTransform=ColorTransform}(dragonBones||(dragonBones={})),function(dragonBones){var Point=function(){function Point(x,y){void 0===x&&(x=0),void 0===y&&(y=0),this.x=x,this.y=y}return Point.prototype.copyFrom=function(value){this.x=value.x,this.y=value.y},Point.prototype.clear=function(){this.x=this.y=0},Point}();dragonBones.Point=Point}(dragonBones||(dragonBones={})),function(dragonBones){var Rectangle=function(){function Rectangle(x,y,width,height){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=0),void 0===height&&(height=0),this.x=x,this.y=y,this.width=width,this.height=height}return Rectangle.prototype.copyFrom=function(value){this.x=value.x,this.y=value.y,this.width=value.width,this.height=value.height},Rectangle.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},Rectangle}();dragonBones.Rectangle=Rectangle}(dragonBones||(dragonBones={})),function(dragonBones){var UserData=function(_super){function UserData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.ints=[],_this.floats=[],_this.strings=[],_this}return __extends(UserData,_super),UserData.toString=function(){return"[class dragonBones.UserData]"},UserData.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},UserData.prototype.addInt=function(value){this.ints.push(value)},UserData.prototype.addFloat=function(value){this.floats.push(value)},UserData.prototype.addString=function(value){this.strings.push(value)},UserData.prototype.getInt=function(index){return void 0===index&&(index=0),index>=0&&index<this.ints.length?this.ints[index]:0},UserData.prototype.getFloat=function(index){return void 0===index&&(index=0),index>=0&&index<this.floats.length?this.floats[index]:0},UserData.prototype.getString=function(index){return void 0===index&&(index=0),index>=0&&index<this.strings.length?this.strings[index]:""},UserData}(dragonBones.BaseObject);dragonBones.UserData=UserData;var ActionData=function(_super){function ActionData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.data=null,_this}return __extends(ActionData,_super),ActionData.toString=function(){return"[class dragonBones.ActionData]"},ActionData.prototype._onClear=function(){null!==this.data&&this.data.returnToPool(),this.type=0,this.name="",this.bone=null,this.slot=null,this.data=null},ActionData}(dragonBones.BaseObject);dragonBones.ActionData=ActionData}(dragonBones||(dragonBones={})),function(dragonBones){var DragonBonesData=function(_super){function DragonBonesData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.frameIndices=[],_this.cachedFrames=[],_this.armatureNames=[],_this.armatures={},_this.userData=null,_this}return __extends(DragonBonesData,_super),DragonBonesData.toString=function(){return"[class dragonBones.DragonBonesData]"},DragonBonesData.prototype._onClear=function(){for(var k in this.armatures)this.armatures[k].returnToPool(),delete this.armatures[k];null!==this.userData&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.colorArray=null,this.userData=null},DragonBonesData.prototype.addArmature=function(value){value.name in this.armatures?console.warn("Same armature: "+value.name):(value.parent=this,this.armatures[value.name]=value,this.armatureNames.push(value.name))},DragonBonesData.prototype.getArmature=function(armatureName){return armatureName in this.armatures?this.armatures[armatureName]:null},DragonBonesData}(dragonBones.BaseObject);dragonBones.DragonBonesData=DragonBonesData}(dragonBones||(dragonBones={})),function(dragonBones){var ArmatureData=function(_super){function ArmatureData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.aabb=new dragonBones.Rectangle,_this.animationNames=[],_this.sortedBones=[],_this.sortedSlots=[],_this.defaultActions=[],_this.actions=[],_this.bones={},_this.slots={},_this.constraints={},_this.skins={},_this.animations={},_this.canvas=null,_this.userData=null,_this}return __extends(ArmatureData,_super),ArmatureData.toString=function(){return"[class dragonBones.ArmatureData]"},ArmatureData.prototype._onClear=function(){for(var _i=0,_a=this.defaultActions;_i<_a.length;_i++){var action;(action=_a[_i]).returnToPool()}for(var _b=0,_c=this.actions;_b<_c.length;_b++){var action;(action=_c[_b]).returnToPool()}for(var k in this.bones)this.bones[k].returnToPool(),delete this.bones[k];for(var k in this.slots)this.slots[k].returnToPool(),delete this.slots[k];for(var k in this.constraints)this.constraints[k].returnToPool(),delete this.constraints[k];for(var k in this.skins)this.skins[k].returnToPool(),delete this.skins[k];for(var k in this.animations)this.animations[k].returnToPool(),delete this.animations[k];null!==this.canvas&&this.canvas.returnToPool(),null!==this.userData&&this.userData.returnToPool(),this.type=0,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null},ArmatureData.prototype.sortBones=function(){var total=this.sortedBones.length;if(!(total<=0)){var sortHelper=this.sortedBones.concat(),index=0,count=0;for(this.sortedBones.length=0;count<total;){var bone=sortHelper[index++];if(index>=total&&(index=0),!(this.sortedBones.indexOf(bone)>=0)){var flag=!1;for(var k in this.constraints){var constraint=this.constraints[k];if(constraint.root===bone&&this.sortedBones.indexOf(constraint.target)<0){flag=!0;break}}flag||null!==bone.parent&&this.sortedBones.indexOf(bone.parent)<0||(this.sortedBones.push(bone),count++)}}}},ArmatureData.prototype.cacheFrames=function(frameRate){if(!(this.cacheFrameRate>0))for(var k in this.cacheFrameRate=frameRate,this.animations)this.animations[k].cacheFrames(this.cacheFrameRate)},ArmatureData.prototype.setCacheFrame=function(globalTransformMatrix,transform){var dataArray=this.parent.cachedFrames,arrayOffset=dataArray.length;return dataArray.length+=10,dataArray[arrayOffset]=globalTransformMatrix.a,dataArray[arrayOffset+1]=globalTransformMatrix.b,dataArray[arrayOffset+2]=globalTransformMatrix.c,dataArray[arrayOffset+3]=globalTransformMatrix.d,dataArray[arrayOffset+4]=globalTransformMatrix.tx,dataArray[arrayOffset+5]=globalTransformMatrix.ty,dataArray[arrayOffset+6]=transform.rotation,dataArray[arrayOffset+7]=transform.skew,dataArray[arrayOffset+8]=transform.scaleX,dataArray[arrayOffset+9]=transform.scaleY,arrayOffset},ArmatureData.prototype.getCacheFrame=function(globalTransformMatrix,transform,arrayOffset){var dataArray=this.parent.cachedFrames;globalTransformMatrix.a=dataArray[arrayOffset],globalTransformMatrix.b=dataArray[arrayOffset+1],globalTransformMatrix.c=dataArray[arrayOffset+2],globalTransformMatrix.d=dataArray[arrayOffset+3],globalTransformMatrix.tx=dataArray[arrayOffset+4],globalTransformMatrix.ty=dataArray[arrayOffset+5],transform.rotation=dataArray[arrayOffset+6],transform.skew=dataArray[arrayOffset+7],transform.scaleX=dataArray[arrayOffset+8],transform.scaleY=dataArray[arrayOffset+9],transform.x=globalTransformMatrix.tx,transform.y=globalTransformMatrix.ty},ArmatureData.prototype.addBone=function(value){value.name in this.bones?console.warn("Same bone: "+value.name):(this.bones[value.name]=value,this.sortedBones.push(value))},ArmatureData.prototype.addSlot=function(value){value.name in this.slots?console.warn("Same slot: "+value.name):(this.slots[value.name]=value,this.sortedSlots.push(value))},ArmatureData.prototype.addConstraint=function(value){value.name in this.constraints?console.warn("Same constraint: "+value.name):this.constraints[value.name]=value},ArmatureData.prototype.addSkin=function(value){value.name in this.skins?console.warn("Same skin: "+value.name):(value.parent=this,this.skins[value.name]=value,null===this.defaultSkin&&(this.defaultSkin=value),"default"===value.name&&(this.defaultSkin=value))},ArmatureData.prototype.addAnimation=function(value){value.name in this.animations?console.warn("Same animation: "+value.name):(value.parent=this,this.animations[value.name]=value,this.animationNames.push(value.name),null===this.defaultAnimation&&(this.defaultAnimation=value))},ArmatureData.prototype.addAction=function(value,isDefault){isDefault?this.defaultActions.push(value):this.actions.push(value)},ArmatureData.prototype.getBone=function(boneName){return boneName in this.bones?this.bones[boneName]:null},ArmatureData.prototype.getSlot=function(slotName){return slotName in this.slots?this.slots[slotName]:null},ArmatureData.prototype.getConstraint=function(constraintName){return constraintName in this.constraints?this.constraints[constraintName]:null},ArmatureData.prototype.getSkin=function(skinName){return skinName in this.skins?this.skins[skinName]:null},ArmatureData.prototype.getMesh=function(skinName,slotName,meshName){var skin=this.getSkin(skinName);return null===skin?null:skin.getDisplay(slotName,meshName)},ArmatureData.prototype.getAnimation=function(animationName){return animationName in this.animations?this.animations[animationName]:null},ArmatureData}(dragonBones.BaseObject);dragonBones.ArmatureData=ArmatureData;var BoneData=function(_super){function BoneData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.transform=new dragonBones.Transform,_this.userData=null,_this}return __extends(BoneData,_super),BoneData.toString=function(){return"[class dragonBones.BoneData]"},BoneData.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.type=0,this.length=0,this.alpha=1,this.name="",this.transform.identity(),this.userData=null,this.parent=null},BoneData}(dragonBones.BaseObject);dragonBones.BoneData=BoneData;var SurfaceData=function(_super){function SurfaceData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.geometry=new dragonBones.GeometryData,_this}return __extends(SurfaceData,_super),SurfaceData.toString=function(){return"[class dragonBones.SurfaceData]"},SurfaceData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.type=1,this.segmentX=0,this.segmentY=0,this.geometry.clear()},SurfaceData}(BoneData);dragonBones.SurfaceData=SurfaceData;var SlotData=function(_super){function SlotData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.color=null,_this.userData=null,_this}return __extends(SlotData,_super),SlotData.createColor=function(){return new dragonBones.ColorTransform},SlotData.toString=function(){return"[class dragonBones.SlotData]"},SlotData.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.blendMode=0,this.displayIndex=0,this.zOrder=0,this.zIndex=0,this.alpha=1,this.name="",this.color=null,this.userData=null,this.parent=null},SlotData.DEFAULT_COLOR=new dragonBones.ColorTransform,SlotData}(dragonBones.BaseObject);dragonBones.SlotData=SlotData}(dragonBones||(dragonBones={})),function(dragonBones){var ConstraintData=function(_super){function ConstraintData(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ConstraintData,_super),ConstraintData.prototype._onClear=function(){this.order=0,this.name="",this.type=0,this.target=null,this.root=null,this.bone=null},ConstraintData}(dragonBones.BaseObject);dragonBones.ConstraintData=ConstraintData;var IKConstraintData=function(_super){function IKConstraintData(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(IKConstraintData,_super),IKConstraintData.toString=function(){return"[class dragonBones.IKConstraintData]"},IKConstraintData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1},IKConstraintData}(ConstraintData);dragonBones.IKConstraintData=IKConstraintData;var PathConstraintData=function(_super){function PathConstraintData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.bones=[],_this}return __extends(PathConstraintData,_super),PathConstraintData.toString=function(){return"[class dragonBones.PathConstraintData]"},PathConstraintData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.pathSlot=null,this.pathDisplayData=null,this.bones.length=0,this.positionMode=0,this.spacingMode=1,this.rotateMode=1,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=0,this.translateMix=0},PathConstraintData.prototype.AddBone=function(value){this.bones.push(value)},PathConstraintData}(ConstraintData);dragonBones.PathConstraintData=PathConstraintData}(dragonBones||(dragonBones={})),function(dragonBones){var CanvasData=function(_super){function CanvasData(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(CanvasData,_super),CanvasData.toString=function(){return"[class dragonBones.CanvasData]"},CanvasData.prototype._onClear=function(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0},CanvasData}(dragonBones.BaseObject);dragonBones.CanvasData=CanvasData}(dragonBones||(dragonBones={})),function(dragonBones){var SkinData=function(_super){function SkinData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.displays={},_this}return __extends(SkinData,_super),SkinData.toString=function(){return"[class dragonBones.SkinData]"},SkinData.prototype._onClear=function(){for(var k in this.displays){for(var slotDisplays,_i=0,slotDisplays_1=this.displays[k];_i<slotDisplays_1.length;_i++){var display=slotDisplays_1[_i];null!==display&&display.returnToPool()}delete this.displays[k]}this.name="",this.parent=null},SkinData.prototype.addDisplay=function(slotName,value){var slotDisplays;slotName in this.displays||(this.displays[slotName]=[]),null!==value&&(value.parent=this),this.displays[slotName].push(value)},SkinData.prototype.getDisplay=function(slotName,displayName){var slotDisplays=this.getDisplays(slotName);if(null!==slotDisplays)for(var _i=0,slotDisplays_2=slotDisplays;_i<slotDisplays_2.length;_i++){var display=slotDisplays_2[_i];if(null!==display&&display.name===displayName)return display}return null},SkinData.prototype.getDisplays=function(slotName){return slotName in this.displays?this.displays[slotName]:null},SkinData}(dragonBones.BaseObject);dragonBones.SkinData=SkinData}(dragonBones||(dragonBones={})),function(dragonBones){var GeometryData=function(){function GeometryData(){this.weight=null}return GeometryData.prototype.clear=function(){this.isShared||null===this.weight||this.weight.returnToPool(),this.isShared=!1,this.inheritDeform=!1,this.offset=0,this.data=null,this.weight=null},GeometryData.prototype.shareFrom=function(value){this.isShared=!0,this.offset=value.offset,this.weight=value.weight},Object.defineProperty(GeometryData.prototype,"vertexCount",{get:function(){var intArray;return this.data.intArray[this.offset+0]},enumerable:!0,configurable:!0}),Object.defineProperty(GeometryData.prototype,"triangleCount",{get:function(){var intArray;return this.data.intArray[this.offset+1]},enumerable:!0,configurable:!0}),GeometryData}();dragonBones.GeometryData=GeometryData;var DisplayData=function(_super){function DisplayData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.transform=new dragonBones.Transform,_this}return __extends(DisplayData,_super),DisplayData.prototype._onClear=function(){this.name="",this.path="",this.transform.identity(),this.parent=null},DisplayData}(dragonBones.BaseObject);dragonBones.DisplayData=DisplayData;var ImageDisplayData=function(_super){function ImageDisplayData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.pivot=new dragonBones.Point,_this}return __extends(ImageDisplayData,_super),ImageDisplayData.toString=function(){return"[class dragonBones.ImageDisplayData]"},ImageDisplayData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.type=0,this.pivot.clear(),this.texture=null},ImageDisplayData}(DisplayData);dragonBones.ImageDisplayData=ImageDisplayData;var ArmatureDisplayData=function(_super){function ArmatureDisplayData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.actions=[],_this}return __extends(ArmatureDisplayData,_super),ArmatureDisplayData.toString=function(){return"[class dragonBones.ArmatureDisplayData]"},ArmatureDisplayData.prototype._onClear=function(){_super.prototype._onClear.call(this);for(var _i=0,_a=this.actions;_i<_a.length;_i++){var action;_a[_i].returnToPool()}this.type=1,this.inheritAnimation=!1,this.actions.length=0,this.armature=null},ArmatureDisplayData.prototype.addAction=function(value){this.actions.push(value)},ArmatureDisplayData}(DisplayData);dragonBones.ArmatureDisplayData=ArmatureDisplayData;var MeshDisplayData=function(_super){function MeshDisplayData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.geometry=new GeometryData,_this}return __extends(MeshDisplayData,_super),MeshDisplayData.toString=function(){return"[class dragonBones.MeshDisplayData]"},MeshDisplayData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.type=2,this.geometry.clear(),this.texture=null},MeshDisplayData}(DisplayData);dragonBones.MeshDisplayData=MeshDisplayData;var BoundingBoxDisplayData=function(_super){function BoundingBoxDisplayData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.boundingBox=null,_this}return __extends(BoundingBoxDisplayData,_super),BoundingBoxDisplayData.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"},BoundingBoxDisplayData.prototype._onClear=function(){_super.prototype._onClear.call(this),null!==this.boundingBox&&this.boundingBox.returnToPool(),this.type=3,this.boundingBox=null},BoundingBoxDisplayData}(DisplayData);dragonBones.BoundingBoxDisplayData=BoundingBoxDisplayData;var PathDisplayData=function(_super){function PathDisplayData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.geometry=new GeometryData,_this.curveLengths=[],_this}return __extends(PathDisplayData,_super),PathDisplayData.toString=function(){return"[class dragonBones.PathDisplayData]"},PathDisplayData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.type=4,this.closed=!1,this.constantSpeed=!1,this.geometry.clear(),this.curveLengths.length=0},PathDisplayData}(DisplayData);dragonBones.PathDisplayData=PathDisplayData;var WeightData=function(_super){function WeightData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.bones=[],_this}return __extends(WeightData,_super),WeightData.toString=function(){return"[class dragonBones.WeightData]"},WeightData.prototype._onClear=function(){this.count=0,this.offset=0,this.bones.length=0},WeightData.prototype.addBone=function(value){this.bones.push(value)},WeightData}(dragonBones.BaseObject);dragonBones.WeightData=WeightData}(dragonBones||(dragonBones={})),function(dragonBones){var BoundingBoxData=function(_super){function BoundingBoxData(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(BoundingBoxData,_super),BoundingBoxData.prototype._onClear=function(){this.color=0,this.width=0,this.height=0},BoundingBoxData}(dragonBones.BaseObject);dragonBones.BoundingBoxData=BoundingBoxData;var RectangleBoundingBoxData=function(_super){function RectangleBoundingBoxData(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(RectangleBoundingBoxData,_super),RectangleBoundingBoxData.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"},RectangleBoundingBoxData._computeOutCode=function(x,y,xMin,yMin,xMax,yMax){var code=0;return x<xMin?code|=1:x>xMax&&(code|=2),y<yMin?code|=4:y>yMax&&(code|=8),code},RectangleBoundingBoxData.rectangleIntersectsSegment=function(xA,yA,xB,yB,xMin,yMin,xMax,yMax,intersectionPointA,intersectionPointB,normalRadians){void 0===intersectionPointA&&(intersectionPointA=null),void 0===intersectionPointB&&(intersectionPointB=null),void 0===normalRadians&&(normalRadians=null);var inSideA=xA>xMin&&xA<xMax&&yA>yMin&&yA<yMax,inSideB=xB>xMin&&xB<xMax&&yB>yMin&&yB<yMax;if(inSideA&&inSideB)return-1;for(var intersectionCount=0,outcode0=RectangleBoundingBoxData._computeOutCode(xA,yA,xMin,yMin,xMax,yMax),outcode1=RectangleBoundingBoxData._computeOutCode(xB,yB,xMin,yMin,xMax,yMax);;){if(0==(outcode0|outcode1)){intersectionCount=2;break}if(0!=(outcode0&outcode1))break;var x=0,y=0,normalRadian=0,outcodeOut=0!==outcode0?outcode0:outcode1;0!=(4&outcodeOut)?(x=xA+(xB-xA)*(yMin-yA)/(yB-yA),y=yMin,null!==normalRadians&&(normalRadian=.5*-Math.PI)):0!=(8&outcodeOut)?(x=xA+(xB-xA)*(yMax-yA)/(yB-yA),y=yMax,null!==normalRadians&&(normalRadian=.5*Math.PI)):0!=(2&outcodeOut)?(y=yA+(yB-yA)*(xMax-xA)/(xB-xA),x=xMax,null!==normalRadians&&(normalRadian=0)):0!=(1&outcodeOut)&&(y=yA+(yB-yA)*(xMin-xA)/(xB-xA),x=xMin,null!==normalRadians&&(normalRadian=Math.PI)),outcodeOut===outcode0?(xA=x,yA=y,outcode0=RectangleBoundingBoxData._computeOutCode(xA,yA,xMin,yMin,xMax,yMax),null!==normalRadians&&(normalRadians.x=normalRadian)):(xB=x,yB=y,outcode1=RectangleBoundingBoxData._computeOutCode(xB,yB,xMin,yMin,xMax,yMax),null!==normalRadians&&(normalRadians.y=normalRadian))}return intersectionCount&&(inSideA?(intersectionCount=2,null!==intersectionPointA&&(intersectionPointA.x=xB,intersectionPointA.y=yB),null!==intersectionPointB&&(intersectionPointB.x=xB,intersectionPointB.y=xB),null!==normalRadians&&(normalRadians.x=normalRadians.y+Math.PI)):inSideB?(intersectionCount=1,null!==intersectionPointA&&(intersectionPointA.x=xA,intersectionPointA.y=yA),null!==intersectionPointB&&(intersectionPointB.x=xA,intersectionPointB.y=yA),null!==normalRadians&&(normalRadians.y=normalRadians.x+Math.PI)):(intersectionCount=3,null!==intersectionPointA&&(intersectionPointA.x=xA,intersectionPointA.y=yA),null!==intersectionPointB&&(intersectionPointB.x=xB,intersectionPointB.y=yB))),intersectionCount},RectangleBoundingBoxData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.type=0},RectangleBoundingBoxData.prototype.containsPoint=function(pX,pY){var widthH=.5*this.width;if(pX>=-widthH&&pX<=widthH){var heightH=.5*this.height;if(pY>=-heightH&&pY<=heightH)return!0}return!1},RectangleBoundingBoxData.prototype.intersectsSegment=function(xA,yA,xB,yB,intersectionPointA,intersectionPointB,normalRadians){void 0===intersectionPointA&&(intersectionPointA=null),void 0===intersectionPointB&&(intersectionPointB=null),void 0===normalRadians&&(normalRadians=null);var widthH=.5*this.width,heightH=.5*this.height,intersectionCount;return RectangleBoundingBoxData.rectangleIntersectsSegment(xA,yA,xB,yB,-widthH,-heightH,widthH,heightH,intersectionPointA,intersectionPointB,normalRadians)},RectangleBoundingBoxData}(BoundingBoxData);dragonBones.RectangleBoundingBoxData=RectangleBoundingBoxData;var EllipseBoundingBoxData=function(_super){function EllipseBoundingBoxData(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(EllipseBoundingBoxData,_super),EllipseBoundingBoxData.toString=function(){return"[class dragonBones.EllipseData]"},EllipseBoundingBoxData.ellipseIntersectsSegment=function(xA,yA,xB,yB,xC,yC,widthH,heightH,intersectionPointA,intersectionPointB,normalRadians){void 0===intersectionPointA&&(intersectionPointA=null),void 0===intersectionPointB&&(intersectionPointB=null),void 0===normalRadians&&(normalRadians=null);var d=widthH/heightH,dd=d*d,dX=xB-xA,dY=(yB*=d)-(yA*=d),lAB=Math.sqrt(dX*dX+dY*dY),xD=dX/lAB,yD=dY/lAB,a=(xC-xA)*xD+(yC-yA)*yD,aa,ee,rr=widthH*widthH,dR=rr-(xA*xA+yA*yA)+a*a,intersectionCount=0;if(dR>=0){var dT=Math.sqrt(dR),sA=a-dT,sB=a+dT,inSideA=sA<0?-1:sA<=lAB?0:1,inSideB=sB<0?-1:sB<=lAB?0:1,sideAB=inSideA*inSideB;if(sideAB<0)return-1;0===sideAB&&(-1===inSideA?(intersectionCount=2,xB=xA+sB*xD,yB=(yA+sB*yD)/d,null!==intersectionPointA&&(intersectionPointA.x=xB,intersectionPointA.y=yB),null!==intersectionPointB&&(intersectionPointB.x=xB,intersectionPointB.y=yB),null!==normalRadians&&(normalRadians.x=Math.atan2(yB/rr*dd,xB/rr),normalRadians.y=normalRadians.x+Math.PI)):1===inSideB?(intersectionCount=1,xA+=sA*xD,yA=(yA+sA*yD)/d,null!==intersectionPointA&&(intersectionPointA.x=xA,intersectionPointA.y=yA),null!==intersectionPointB&&(intersectionPointB.x=xA,intersectionPointB.y=yA),null!==normalRadians&&(normalRadians.x=Math.atan2(yA/rr*dd,xA/rr),normalRadians.y=normalRadians.x+Math.PI)):(intersectionCount=3,null!==intersectionPointA&&(intersectionPointA.x=xA+sA*xD,intersectionPointA.y=(yA+sA*yD)/d,null!==normalRadians&&(normalRadians.x=Math.atan2(intersectionPointA.y/rr*dd,intersectionPointA.x/rr))),null!==intersectionPointB&&(intersectionPointB.x=xA+sB*xD,intersectionPointB.y=(yA+sB*yD)/d,null!==normalRadians&&(normalRadians.y=Math.atan2(intersectionPointB.y/rr*dd,intersectionPointB.x/rr)))))}return intersectionCount},EllipseBoundingBoxData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.type=1},EllipseBoundingBoxData.prototype.containsPoint=function(pX,pY){var widthH=.5*this.width;if(pX>=-widthH&&pX<=widthH){var heightH=.5*this.height;if(pY>=-heightH&&pY<=heightH)return pY*=widthH/heightH,Math.sqrt(pX*pX+pY*pY)<=widthH}return!1},EllipseBoundingBoxData.prototype.intersectsSegment=function(xA,yA,xB,yB,intersectionPointA,intersectionPointB,normalRadians){var intersectionCount;return void 0===intersectionPointA&&(intersectionPointA=null),void 0===intersectionPointB&&(intersectionPointB=null),void 0===normalRadians&&(normalRadians=null),EllipseBoundingBoxData.ellipseIntersectsSegment(xA,yA,xB,yB,0,0,.5*this.width,.5*this.height,intersectionPointA,intersectionPointB,normalRadians)},EllipseBoundingBoxData}(BoundingBoxData);dragonBones.EllipseBoundingBoxData=EllipseBoundingBoxData;var PolygonBoundingBoxData=function(_super){function PolygonBoundingBoxData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.vertices=[],_this}return __extends(PolygonBoundingBoxData,_super),PolygonBoundingBoxData.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"},PolygonBoundingBoxData.polygonIntersectsSegment=function(xA,yA,xB,yB,vertices,intersectionPointA,intersectionPointB,normalRadians){void 0===intersectionPointA&&(intersectionPointA=null),void 0===intersectionPointB&&(intersectionPointB=null),void 0===normalRadians&&(normalRadians=null),xA===xB&&(xA=xB+1e-6),yA===yB&&(yA=yB+1e-6);for(var count=vertices.length,dXAB=xA-xB,dYAB=yA-yB,llAB=xA*yB-yA*xB,intersectionCount=0,xC=vertices[count-2],yC=vertices[count-1],dMin=0,dMax=0,xMin=0,yMin=0,xMax=0,yMax=0,i=0;i<count;i+=2){var xD=vertices[i],yD=vertices[i+1];xC===xD&&(xC=xD+1e-4),yC===yD&&(yC=yD+1e-4);var dXCD=xC-xD,dYCD=yC-yD,llCD=xC*yD-yC*xD,ll=dXAB*dYCD-dYAB*dXCD,x=(llAB*dXCD-dXAB*llCD)/ll;if((x>=xC&&x<=xD||x>=xD&&x<=xC)&&(0===dXAB||x>=xA&&x<=xB||x>=xB&&x<=xA)){var y=(llAB*dYCD-dYAB*llCD)/ll;if((y>=yC&&y<=yD||y>=yD&&y<=yC)&&(0===dYAB||y>=yA&&y<=yB||y>=yB&&y<=yA)){if(null===intersectionPointB){xMin=x,yMin=y,xMax=x,yMax=y,intersectionCount++,null!==normalRadians&&(normalRadians.x=Math.atan2(yD-yC,xD-xC)-.5*Math.PI,normalRadians.y=normalRadians.x);break}var d=x-xA;d<0&&(d=-d),0===intersectionCount?(dMin=d,dMax=d,xMin=x,yMin=y,xMax=x,yMax=y,null!==normalRadians&&(normalRadians.x=Math.atan2(yD-yC,xD-xC)-.5*Math.PI,normalRadians.y=normalRadians.x)):(d<dMin&&(dMin=d,xMin=x,yMin=y,null!==normalRadians&&(normalRadians.x=Math.atan2(yD-yC,xD-xC)-.5*Math.PI)),d>dMax&&(dMax=d,xMax=x,yMax=y,null!==normalRadians&&(normalRadians.y=Math.atan2(yD-yC,xD-xC)-.5*Math.PI))),intersectionCount++}}xC=xD,yC=yD}return 1===intersectionCount?(null!==intersectionPointA&&(intersectionPointA.x=xMin,intersectionPointA.y=yMin),null!==intersectionPointB&&(intersectionPointB.x=xMin,intersectionPointB.y=yMin),null!==normalRadians&&(normalRadians.y=normalRadians.x+Math.PI)):intersectionCount>1&&(intersectionCount++,null!==intersectionPointA&&(intersectionPointA.x=xMin,intersectionPointA.y=yMin),null!==intersectionPointB&&(intersectionPointB.x=xMax,intersectionPointB.y=yMax)),intersectionCount},PolygonBoundingBoxData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.type=2,this.x=0,this.y=0,this.vertices.length=0},PolygonBoundingBoxData.prototype.containsPoint=function(pX,pY){var isInSide=!1;if(pX>=this.x&&pX<=this.width&&pY>=this.y&&pY<=this.height)for(var i=0,l=this.vertices.length,iP=l-2;i<l;i+=2){var yA=this.vertices[iP+1],yB=this.vertices[i+1];if(yB<pY&&yA>=pY||yA<pY&&yB>=pY){var xA=this.vertices[iP],xB=this.vertices[i];(pY-yB)*(xA-xB)/(yA-yB)+xB<pX&&(isInSide=!isInSide)}iP=i}return isInSide},PolygonBoundingBoxData.prototype.intersectsSegment=function(xA,yA,xB,yB,intersectionPointA,intersectionPointB,normalRadians){void 0===intersectionPointA&&(intersectionPointA=null),void 0===intersectionPointB&&(intersectionPointB=null),void 0===normalRadians&&(normalRadians=null);var intersectionCount=0;return 0!==RectangleBoundingBoxData.rectangleIntersectsSegment(xA,yA,xB,yB,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)&&(intersectionCount=PolygonBoundingBoxData.polygonIntersectsSegment(xA,yA,xB,yB,this.vertices,intersectionPointA,intersectionPointB,normalRadians)),intersectionCount},PolygonBoundingBoxData}(BoundingBoxData);dragonBones.PolygonBoundingBoxData=PolygonBoundingBoxData}(dragonBones||(dragonBones={})),function(dragonBones){var AnimationData=function(_super){function AnimationData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.cachedFrames=[],_this.boneTimelines={},_this.slotTimelines={},_this.constraintTimelines={},_this.animationTimelines={},_this.boneCachedFrameIndices={},_this.slotCachedFrameIndices={},_this.actionTimeline=null,_this.zOrderTimeline=null,_this}return __extends(AnimationData,_super),AnimationData.toString=function(){return"[class dragonBones.AnimationData]"},AnimationData.prototype._onClear=function(){for(var k in this.boneTimelines){for(var _i=0,_a=this.boneTimelines[k];_i<_a.length;_i++){var timeline;(timeline=_a[_i]).returnToPool()}delete this.boneTimelines[k]}for(var k in this.slotTimelines){for(var _b=0,_c=this.slotTimelines[k];_b<_c.length;_b++){var timeline;(timeline=_c[_b]).returnToPool()}delete this.slotTimelines[k]}for(var k in this.constraintTimelines){for(var _d=0,_e=this.constraintTimelines[k];_d<_e.length;_d++){var timeline;(timeline=_e[_d]).returnToPool()}delete this.constraintTimelines[k]}for(var k in this.animationTimelines){for(var _f=0,_g=this.animationTimelines[k];_f<_g.length;_f++){var timeline;(timeline=_g[_f]).returnToPool()}delete this.animationTimelines[k]}for(var k in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[k];for(var k in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[k];null!==this.actionTimeline&&this.actionTimeline.returnToPool(),null!==this.zOrderTimeline&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.blendType=0,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null},AnimationData.prototype.cacheFrames=function(frameRate){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=Math.max(Math.ceil(frameRate*this.scale),1);var cacheFrameCount=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=cacheFrameCount;for(var i=0,l=this.cacheFrames.length;i<l;++i)this.cachedFrames[i]=!1;for(var _i=0,_a=this.parent.sortedBones;_i<_a.length;_i++){for(var bone=_a[_i],indices,i=0,l=(indices=new Array(cacheFrameCount)).length;i<l;++i)indices[i]=-1;this.boneCachedFrameIndices[bone.name]=indices}for(var _b=0,_c=this.parent.sortedSlots;_b<_c.length;_b++){for(var slot=_c[_b],indices,i=0,l=(indices=new Array(cacheFrameCount)).length;i<l;++i)indices[i]=-1;this.slotCachedFrameIndices[slot.name]=indices}}},AnimationData.prototype.addBoneTimeline=function(timelineName,timeline){var timelines=timelineName in this.boneTimelines?this.boneTimelines[timelineName]:this.boneTimelines[timelineName]=[];timelines.indexOf(timeline)<0&&timelines.push(timeline)},AnimationData.prototype.addSlotTimeline=function(timelineName,timeline){var timelines=timelineName in this.slotTimelines?this.slotTimelines[timelineName]:this.slotTimelines[timelineName]=[];timelines.indexOf(timeline)<0&&timelines.push(timeline)},AnimationData.prototype.addConstraintTimeline=function(timelineName,timeline){var timelines=timelineName in this.constraintTimelines?this.constraintTimelines[timelineName]:this.constraintTimelines[timelineName]=[];timelines.indexOf(timeline)<0&&timelines.push(timeline)},AnimationData.prototype.addAnimationTimeline=function(timelineName,timeline){var timelines=timelineName in this.animationTimelines?this.animationTimelines[timelineName]:this.animationTimelines[timelineName]=[];timelines.indexOf(timeline)<0&&timelines.push(timeline)},AnimationData.prototype.getBoneTimelines=function(timelineName){return timelineName in this.boneTimelines?this.boneTimelines[timelineName]:null},AnimationData.prototype.getSlotTimelines=function(timelineName){return timelineName in this.slotTimelines?this.slotTimelines[timelineName]:null},AnimationData.prototype.getConstraintTimelines=function(timelineName){return timelineName in this.constraintTimelines?this.constraintTimelines[timelineName]:null},AnimationData.prototype.getAnimationTimelines=function(timelineName){return timelineName in this.animationTimelines?this.animationTimelines[timelineName]:null},AnimationData.prototype.getBoneCachedFrameIndices=function(boneName){return boneName in this.boneCachedFrameIndices?this.boneCachedFrameIndices[boneName]:null},AnimationData.prototype.getSlotCachedFrameIndices=function(slotName){return slotName in this.slotCachedFrameIndices?this.slotCachedFrameIndices[slotName]:null},AnimationData}(dragonBones.BaseObject);dragonBones.AnimationData=AnimationData;var TimelineData=function(_super){function TimelineData(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TimelineData,_super),TimelineData.toString=function(){return"[class dragonBones.TimelineData]"},TimelineData.prototype._onClear=function(){this.type=10,this.offset=0,this.frameIndicesOffset=-1},TimelineData}(dragonBones.BaseObject);dragonBones.TimelineData=TimelineData;var AnimationTimelineData=function(_super){function AnimationTimelineData(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AnimationTimelineData,_super),AnimationTimelineData.toString=function(){return"[class dragonBones.AnimationTimelineData]"},AnimationTimelineData.prototype._onClear=function(){_super.prototype._onClear.call(this),this.x=0,this.y=0},AnimationTimelineData}(TimelineData);dragonBones.AnimationTimelineData=AnimationTimelineData}(dragonBones||(dragonBones={})),function(dragonBones){var AnimationConfig=function(_super){function AnimationConfig(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.boneMask=[],_this}return __extends(AnimationConfig,_super),AnimationConfig.toString=function(){return"[class dragonBones.AnimationConfig]"},AnimationConfig.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTweenType=1,this.fadeOutTime=-1,this.actionEnabled=!0,this.additive=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=1,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0},AnimationConfig.prototype.clear=function(){this._onClear()},AnimationConfig.prototype.copyFrom=function(value){this.pauseFadeOut=value.pauseFadeOut,this.fadeOutMode=value.fadeOutMode,this.autoFadeOutTime=value.autoFadeOutTime,this.fadeOutTweenType=value.fadeOutTweenType,this.actionEnabled=value.actionEnabled,this.additive=value.additive,this.displayControl=value.displayControl,this.pauseFadeIn=value.pauseFadeIn,this.resetToPose=value.resetToPose,this.playTimes=value.playTimes,this.layer=value.layer,this.position=value.position,this.duration=value.duration,this.timeScale=value.timeScale,this.fadeInTime=value.fadeInTime,this.fadeOutTime=value.fadeOutTime,this.fadeInTweenType=value.fadeInTweenType,this.weight=value.weight,this.name=value.name,this.animation=value.animation,this.group=value.group,this.boneMask.length=value.boneMask.length;for(var i=0,l=this.boneMask.length;i<l;++i)this.boneMask[i]=value.boneMask[i]},AnimationConfig}(dragonBones.BaseObject);dragonBones.AnimationConfig=AnimationConfig}(dragonBones||(dragonBones={})),function(dragonBones){var TextureAtlasData=function(_super){function TextureAtlasData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.textures={},_this}return __extends(TextureAtlasData,_super),TextureAtlasData.prototype._onClear=function(){for(var k in this.textures)this.textures[k].returnToPool(),delete this.textures[k];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""},TextureAtlasData.prototype.copyFrom=function(value){for(var k in this.autoSearch=value.autoSearch,this.scale=value.scale,this.width=value.width,this.height=value.height,this.name=value.name,this.imagePath=value.imagePath,this.textures)this.textures[k].returnToPool(),delete this.textures[k];for(var k in value.textures){var texture=this.createTexture();texture.copyFrom(value.textures[k]),this.textures[k]=texture}},TextureAtlasData.prototype.addTexture=function(value){value.name in this.textures?console.warn("Same texture: "+value.name):(value.parent=this,this.textures[value.name]=value)},TextureAtlasData.prototype.getTexture=function(textureName){return textureName in this.textures?this.textures[textureName]:null},TextureAtlasData}(dragonBones.BaseObject);dragonBones.TextureAtlasData=TextureAtlasData;var TextureData=function(_super){function TextureData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.region=new dragonBones.Rectangle,_this.frame=null,_this}return __extends(TextureData,_super),TextureData.createRectangle=function(){return new dragonBones.Rectangle},TextureData.prototype._onClear=function(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null},TextureData.prototype.copyFrom=function(value){this.rotated=value.rotated,this.name=value.name,this.region.copyFrom(value.region),this.parent=value.parent,null===this.frame&&null!==value.frame?this.frame=TextureData.createRectangle():null!==this.frame&&null===value.frame&&(this.frame=null),null!==this.frame&&null!==value.frame&&this.frame.copyFrom(value.frame)},TextureData}(dragonBones.BaseObject);dragonBones.TextureData=TextureData}(dragonBones||(dragonBones={})),function(dragonBones_1){var Armature=function(_super){function Armature(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._bones=[],_this._slots=[],_this._constraints=[],_this._actions=[],_this._animation=null,_this._proxy=null,_this._replaceTextureAtlasData=null,_this._clock=null,_this}return __extends(Armature,_super),Armature.toString=function(){return"[class dragonBones.Armature]"},Armature._onSortSlots=function(a,b){return 1e3*a._zIndex+a._zOrder>1e3*b._zIndex+b._zOrder?1:-1},Armature.prototype._onClear=function(){null!==this._clock&&this._clock.remove(this);for(var _i=0,_a=this._bones;_i<_a.length;_i++){var bone;_a[_i].returnToPool()}for(var _b=0,_c=this._slots;_b<_c.length;_b++){var slot;_c[_b].returnToPool()}for(var _d=0,_e=this._constraints;_d<_e.length;_d++){var constraint;_e[_d].returnToPool()}for(var _f=0,_g=this._actions;_f<_g.length;_f++){var action;_g[_f].returnToPool()}null!==this._animation&&this._animation.returnToPool(),null!==this._proxy&&this._proxy.dbClear(),null!==this._replaceTextureAtlasData&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._slotsDirty=!0,this._zOrderDirty=!1,this._zIndexDirty=!1,this._alphaDirty=!0,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._alpha=1,this._globalAlpha=1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null},Armature.prototype._sortZOrder=function(slotIndices,offset){var slotDatas=this._armatureData.sortedSlots,isOriginal=null===slotIndices;if(this._zOrderDirty||!isOriginal){for(var i=0,l=slotDatas.length;i<l;++i){var slotIndex=isOriginal?i:slotIndices[offset+i];if(!(slotIndex<0||slotIndex>=l)){var slotData=slotDatas[slotIndex],slot=this.getSlot(slotData.name);null!==slot&&slot._setZOrder(i)}}this._slotsDirty=!0,this._zOrderDirty=!isOriginal}},Armature.prototype._addBone=function(value){this._bones.indexOf(value)<0&&this._bones.push(value)},Armature.prototype._addSlot=function(value){this._slots.indexOf(value)<0&&this._slots.push(value)},Armature.prototype._addConstraint=function(value){this._constraints.indexOf(value)<0&&this._constraints.push(value)},Armature.prototype._bufferAction=function(action,append){this._actions.indexOf(action)<0&&(append?this._actions.push(action):this._actions.unshift(action))},Armature.prototype.dispose=function(){null!==this._armatureData&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))},Armature.prototype.init=function(armatureData,proxy,display,dragonBones){null===this._armatureData&&(this._armatureData=armatureData,this._animation=dragonBones_1.BaseObject.borrowObject(dragonBones_1.Animation),this._proxy=proxy,this._display=display,this._dragonBones=dragonBones,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)},Armature.prototype.advanceTime=function(passedTime){if(!this._lockUpdate)if(this._lockUpdate=!0,null!==this._armatureData)if(null!==this._armatureData.parent){var prevCacheFrameIndex=this._cacheFrameIndex;if(this._animation.advanceTime(passedTime),this._slotsDirty||this._zIndexDirty){if(this._slots.sort(Armature._onSortSlots),this._zIndexDirty)for(var i=0,l=this._slots.length;i<l;++i)this._slots[i]._setZOrder(i);this._slotsDirty=!1,this._zIndexDirty=!1}if(this._alphaDirty){this._alphaDirty=!1,this._globalAlpha=this._alpha*(null!==this._parent?this._parent._globalAlpha:1);for(var _i=0,_a=this._bones;_i<_a.length;_i++){var bone;_a[_i]._updateAlpha()}for(var _b=0,_c=this._slots;_b<_c.length;_b++){var slot;(slot=_c[_b])._updateAlpha()}}if(this._cacheFrameIndex<0||this._cacheFrameIndex!==prevCacheFrameIndex){var i=0,l=0;for(i=0,l=this._bones.length;i<l;++i)this._bones[i].update(this._cacheFrameIndex);for(i=0,l=this._slots.length;i<l;++i)this._slots[i].update(this._cacheFrameIndex)}if(this._actions.length>0){for(var _d=0,_e=this._actions;_d<_e.length;_d++){var action=_e[_d],actionData=action.actionData,childArmature;if(null!==actionData)if(0===actionData.type)if(null!==action.slot)null!==(childArmature=action.slot.childArmature)&&childArmature.animation.fadeIn(actionData.name);else if(null!==action.bone)for(var _f=0,_g=this.getSlots();_f<_g.length;_f++){var slot,childArmature;if((slot=_g[_f]).parent===action.bone)null!==(childArmature=slot.childArmature)&&childArmature.animation.fadeIn(actionData.name)}else this._animation.fadeIn(actionData.name);action.returnToPool()}this._actions.length=0}this._lockUpdate=!1,this._proxy.dbUpdate()}else console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");else console.warn("The armature has been disposed.")},Armature.prototype.invalidUpdate=function(boneName,updateSlot){if(void 0===boneName&&(boneName=null),void 0===updateSlot&&(updateSlot=!1),null!==boneName&&boneName.length>0){var bone;if(null!==(bone=this.getBone(boneName))&&(bone.invalidUpdate(),updateSlot))for(var _i=0,_a=this._slots;_i<_a.length;_i++){var slot;(slot=_a[_i]).parent===bone&&slot.invalidUpdate()}}else{for(var _b=0,_c=this._bones;_b<_c.length;_b++){var bone;(bone=_c[_b]).invalidUpdate()}if(updateSlot)for(var _d=0,_e=this._slots;_d<_e.length;_d++){var slot;(slot=_e[_d]).invalidUpdate()}}},Armature.prototype.containsPoint=function(x,y){for(var _i=0,_a=this._slots;_i<_a.length;_i++){var slot=_a[_i];if(slot.containsPoint(x,y))return slot}return null},Armature.prototype.intersectsSegment=function(xA,yA,xB,yB,intersectionPointA,intersectionPointB,normalRadians){void 0===intersectionPointA&&(intersectionPointA=null),void 0===intersectionPointB&&(intersectionPointB=null),void 0===normalRadians&&(normalRadians=null);for(var isV=xA===xB,dMin=0,dMax=0,intXA=0,intYA=0,intXB=0,intYB=0,intAN=0,intBN=0,intSlotA=null,intSlotB=null,_i=0,_a=this._slots;_i<_a.length;_i++){var slot=_a[_i],intersectionCount;if(slot.intersectsSegment(xA,yA,xB,yB,intersectionPointA,intersectionPointB,normalRadians)>0){if(null===intersectionPointA&&null===intersectionPointB){intSlotA=slot;break}var d,d;null!==intersectionPointA&&((d=isV?intersectionPointA.y-yA:intersectionPointA.x-xA)<0&&(d=-d),(null===intSlotA||d<dMin)&&(dMin=d,intXA=intersectionPointA.x,intYA=intersectionPointA.y,intSlotA=slot,normalRadians&&(intAN=normalRadians.x))),null!==intersectionPointB&&((d=intersectionPointB.x-xA)<0&&(d=-d),(null===intSlotB||d>dMax)&&(dMax=d,intXB=intersectionPointB.x,intYB=intersectionPointB.y,intSlotB=slot,null!==normalRadians&&(intBN=normalRadians.y)))}}return null!==intSlotA&&null!==intersectionPointA&&(intersectionPointA.x=intXA,intersectionPointA.y=intYA,null!==normalRadians&&(normalRadians.x=intAN)),null!==intSlotB&&null!==intersectionPointB&&(intersectionPointB.x=intXB,intersectionPointB.y=intYB,null!==normalRadians&&(normalRadians.y=intBN)),intSlotA},Armature.prototype.getBone=function(name){for(var _i=0,_a=this._bones;_i<_a.length;_i++){var bone=_a[_i];if(bone.name===name)return bone}return null},Armature.prototype.getBoneByDisplay=function(display){var slot=this.getSlotByDisplay(display);return null!==slot?slot.parent:null},Armature.prototype.getSlot=function(name){for(var _i=0,_a=this._slots;_i<_a.length;_i++){var slot=_a[_i];if(slot.name===name)return slot}return null},Armature.prototype.getSlotByDisplay=function(display){if(null!==display)for(var _i=0,_a=this._slots;_i<_a.length;_i++){var slot=_a[_i];if(slot.display===display)return slot}return null},Armature.prototype.getBones=function(){return this._bones},Armature.prototype.getSlots=function(){return this._slots},Object.defineProperty(Armature.prototype,"flipX",{get:function(){return this._flipX},set:function(value){this._flipX!==value&&(this._flipX=value,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"flipY",{get:function(){return this._flipY},set:function(value){this._flipY!==value&&(this._flipY=value,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(value){if(this._armatureData.cacheFrameRate!==value){this._armatureData.cacheFrames(value);for(var _i=0,_a=this._slots;_i<_a.length;_i++){var slot,childArmature=_a[_i].childArmature;null!==childArmature&&(childArmature.cacheFrameRate=value)}}},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"name",{get:function(){return this._armatureData.name},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(value){if(this._replacedTexture!==value){null!==this._replaceTextureAtlasData&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=value;for(var _i=0,_a=this._slots;_i<_a.length;_i++){var slot=_a[_i];slot.invalidUpdate(),slot.update(-1)}}},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"clock",{get:function(){return this._clock},set:function(value){if(this._clock!==value){null!==this._clock&&this._clock.remove(this),this._clock=value,this._clock&&this._clock.add(this);for(var _i=0,_a=this._slots;_i<_a.length;_i++){var slot,childArmature=_a[_i].childArmature;null!==childArmature&&(childArmature.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Armature.prototype.getDisplay=function(){return this._display},Armature}(dragonBones_1.BaseObject);dragonBones_1.Armature=Armature}(dragonBones||(dragonBones={})),function(dragonBones){var TransformObject=function(_super){function TransformObject(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.globalTransformMatrix=new dragonBones.Matrix,_this.global=new dragonBones.Transform,_this.offset=new dragonBones.Transform,_this}return __extends(TransformObject,_super),TransformObject.prototype._onClear=function(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._alpha=1,this._globalAlpha=1,this._armature=null},TransformObject.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(TransformObject.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),TransformObject._helpMatrix=new dragonBones.Matrix,TransformObject._helpTransform=new dragonBones.Transform,TransformObject._helpPoint=new dragonBones.Point,TransformObject}(dragonBones.BaseObject);dragonBones.TransformObject=TransformObject}(dragonBones||(dragonBones={})),function(dragonBones){var Bone=function(_super){function Bone(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.animationPose=new dragonBones.Transform,_this}return __extends(Bone,_super),Bone.toString=function(){return"[class dragonBones.Bone]"},Bone.prototype._onClear=function(){_super.prototype._onClear.call(this),this.offsetMode=1,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._boneData=null,this._parent=null,this._cachedFrameIndices=null},Bone.prototype._updateGlobalTransformMatrix=function(isCache){var boneData=this._boneData,global=this.global,globalTransformMatrix=this.globalTransformMatrix,origin=this.origin,offset=this.offset,animationPose=this.animationPose,parent=this._parent,flipX=this._armature.flipX,flipY=this._armature.flipY===dragonBones.DragonBones.yDown,inherit=null!==parent,rotation=0;if(1===this.offsetMode?null!==origin?(global.x=origin.x+offset.x+animationPose.x,global.scaleX=origin.scaleX*offset.scaleX*animationPose.scaleX,global.scaleY=origin.scaleY*offset.scaleY*animationPose.scaleY,dragonBones.DragonBones.yDown?(global.y=origin.y+offset.y+animationPose.y,global.skew=origin.skew+offset.skew+animationPose.skew,global.rotation=origin.rotation+offset.rotation+animationPose.rotation):(global.y=origin.y-offset.y+animationPose.y,global.skew=origin.skew-offset.skew+animationPose.skew,global.rotation=origin.rotation-offset.rotation+animationPose.rotation)):(global.copyFrom(offset),dragonBones.DragonBones.yDown||(global.y=-global.y,global.skew=-global.skew,global.rotation=-global.rotation),global.add(animationPose)):0===this.offsetMode?null!==origin?global.copyFrom(origin).add(animationPose):global.copyFrom(animationPose):(inherit=!1,global.copyFrom(offset),dragonBones.DragonBones.yDown||(global.y=-global.y,global.skew=-global.skew,global.rotation=-global.rotation)),inherit){var isSurface=1===parent._boneData.type,surfaceBone=isSurface?parent._bone:null,parentMatrix=isSurface?parent._getGlobalTransformMatrix(global.x,global.y):parent.globalTransformMatrix;if(!boneData.inheritScale||isSurface&&null===surfaceBone){if(boneData.inheritTranslation){var x=global.x,y=global.y;global.x=parentMatrix.a*x+parentMatrix.c*y+parentMatrix.tx,global.y=parentMatrix.b*x+parentMatrix.d*y+parentMatrix.ty}else flipX&&(global.x=-global.x),flipY&&(global.y=-global.y);boneData.inheritRotation?(parent.updateGlobalTransform(),rotation=parent.global.scaleX<0?global.rotation+parent.global.rotation+Math.PI:global.rotation+parent.global.rotation,parentMatrix.a*parentMatrix.d-parentMatrix.b*parentMatrix.c<0&&(rotation-=2*global.rotation,(flipX!==flipY||boneData.inheritReflection)&&(global.skew+=Math.PI),dragonBones.DragonBones.yDown||(global.skew=-global.skew)),global.rotation=rotation):(flipX||flipY)&&(flipX&&flipY?rotation=global.rotation+Math.PI:(rotation=flipX?Math.PI-global.rotation:-global.rotation,global.skew+=Math.PI),global.rotation=rotation),global.toMatrix(globalTransformMatrix)}else isSurface?(boneData.inheritRotation&&(global.rotation+=parent.global.rotation),surfaceBone.updateGlobalTransform(),global.scaleX*=surfaceBone.global.scaleX,global.scaleY*=surfaceBone.global.scaleY,parentMatrix.transformPoint(global.x,global.y,global),global.toMatrix(globalTransformMatrix),boneData.inheritTranslation?(global.x=globalTransformMatrix.tx,global.y=globalTransformMatrix.ty):(globalTransformMatrix.tx=global.x,globalTransformMatrix.ty=global.y)):(boneData.inheritRotation||(parent.updateGlobalTransform(),rotation=flipX&&flipY?global.rotation-(parent.global.rotation+Math.PI):flipX?global.rotation+parent.global.rotation+Math.PI:flipY?global.rotation+parent.global.rotation:global.rotation-parent.global.rotation,global.rotation=rotation),global.toMatrix(globalTransformMatrix),globalTransformMatrix.concat(parentMatrix),boneData.inheritTranslation?(global.x=globalTransformMatrix.tx,global.y=globalTransformMatrix.ty):(globalTransformMatrix.tx=global.x,globalTransformMatrix.ty=global.y),isCache?global.fromMatrix(globalTransformMatrix):this._globalDirty=!0)}else(flipX||flipY)&&(flipX&&(global.x=-global.x),flipY&&(global.y=-global.y),flipX&&flipY?rotation=global.rotation+Math.PI:(rotation=flipX?Math.PI-global.rotation:-global.rotation,global.skew+=Math.PI),global.rotation=rotation),global.toMatrix(globalTransformMatrix)},Bone.prototype._updateAlpha=function(){null!==this._parent?this._globalAlpha=this._alpha*this._parent._globalAlpha:this._globalAlpha=this._alpha*this._armature._globalAlpha},Bone.prototype.init=function(boneData,armatureValue){null===this._boneData&&(this._boneData=boneData,this._armature=armatureValue,this._alpha=this._boneData.alpha,null!==this._boneData.parent&&(this._parent=this._armature.getBone(this._boneData.parent.name)),this._armature._addBone(this),this.origin=this._boneData.transform)},Bone.prototype.update=function(cacheFrameIndex){if(cacheFrameIndex>=0&&null!==this._cachedFrameIndices){var cachedFrameIndex=this._cachedFrameIndices[cacheFrameIndex];if(cachedFrameIndex>=0&&this._cachedFrameIndex===cachedFrameIndex)this._transformDirty=!1;else if(cachedFrameIndex>=0)this._transformDirty=!0,this._cachedFrameIndex=cachedFrameIndex;else{if(this._hasConstraint)for(var _i=0,_a=this._armature._constraints;_i<_a.length;_i++){var constraint;(constraint=_a[_i])._root===this&&constraint.update()}this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[cacheFrameIndex]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var _b=0,_c=this._armature._constraints;_b<_c.length;_b++){var constraint;(constraint=_c[_b])._root===this&&constraint.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(cacheFrameIndex=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){var isCache=cacheFrameIndex>=0;this._localDirty&&this._updateGlobalTransformMatrix(isCache),isCache&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[cacheFrameIndex]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},Bone.prototype.updateByConstraint=function(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)},Bone.prototype.invalidUpdate=function(){this._transformDirty=!0},Bone.prototype.contains=function(value){if(value===this)return!1;for(var ancestor=value;ancestor!==this&&null!==ancestor;)ancestor=ancestor.parent;return ancestor===this},Object.defineProperty(Bone.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(Bone.prototype,"visible",{get:function(){return this._visible},set:function(value){if(this._visible!==value){this._visible=value;for(var _i=0,_a=this._armature.getSlots();_i<_a.length;_i++){var slot=_a[_i];slot.parent===this&&slot._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(Bone.prototype,"name",{get:function(){return this._boneData.name},enumerable:!0,configurable:!0}),Object.defineProperty(Bone.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Bone}(dragonBones.TransformObject);dragonBones.Bone=Bone}(dragonBones||(dragonBones={})),function(dragonBones){var Surface=function(_super){function Surface(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._vertices=[],_this._deformVertices=[],_this._hullCache=[],_this._matrixCahce=[],_this}return __extends(Surface,_super),Surface.toString=function(){return"[class dragonBones.Surface]"},Surface.prototype._onClear=function(){_super.prototype._onClear.call(this),this._dX=0,this._dY=0,this._k=0,this._kX=0,this._kY=0,this._vertices.length=0,this._deformVertices.length=0,this._matrixCahce.length=0,this._hullCache.length=0,this._bone=null},Surface.prototype._getAffineTransform=function(x,y,lX,lY,aX,aY,bX,bY,cX,cY,transform,matrix,isDown){var dabX=bX-aX,dabY=bY-aY,dacX=cX-aX,dacY=cY-aY;transform.rotation=Math.atan2(dabY,dabX),transform.skew=Math.atan2(dacY,dacX)-.5*Math.PI-transform.rotation,isDown&&(transform.rotation+=Math.PI),transform.scaleX=Math.sqrt(dabX*dabX+dabY*dabY)/lX,transform.scaleY=Math.sqrt(dacX*dacX+dacY*dacY)/lY,transform.toMatrix(matrix),transform.x=matrix.tx=aX-(matrix.a*x+matrix.c*y),transform.y=matrix.ty=aY-(matrix.b*x+matrix.d*y)},Surface.prototype._updateVertices=function(){var data=this._armature.armatureData.parent,geometry=this._boneData.geometry,intArray=data.intArray,floatArray=data.floatArray,vertexCount=intArray[geometry.offset+0],verticesOffset=intArray[geometry.offset+2],vertices=this._vertices,animationVertices=this._deformVertices;if(null!==this._parent)if(1===this._parent._boneData.type)for(var i=0,l=vertexCount;i<l;++i){var iD,x=floatArray[verticesOffset+(iD=2*i)]+animationVertices[iD],y=floatArray[verticesOffset+iD+1]+animationVertices[iD+1],matrix=this._parent._getGlobalTransformMatrix(x,y);vertices[iD]=matrix.a*x+matrix.c*y+matrix.tx,vertices[iD+1]=matrix.b*x+matrix.d*y+matrix.ty}else for(var parentMatrix=this._parent.globalTransformMatrix,i=0,l=vertexCount;i<l;++i){var iD,x=floatArray[verticesOffset+(iD=2*i)]+animationVertices[iD],y=floatArray[verticesOffset+iD+1]+animationVertices[iD+1];vertices[iD]=parentMatrix.a*x+parentMatrix.c*y+parentMatrix.tx,vertices[iD+1]=parentMatrix.b*x+parentMatrix.d*y+parentMatrix.ty}else for(var i=0,l=vertexCount;i<l;++i){var iD;vertices[iD=2*i]=floatArray[verticesOffset+iD]+animationVertices[iD],vertices[iD+1]=floatArray[verticesOffset+iD+1]+animationVertices[iD+1]}},Surface.prototype._updateGlobalTransformMatrix=function(isCache){var segmentXD=2*this._boneData.segmentX,lastIndex=this._vertices.length-2,lA=200,raX=this._vertices[0],raY=this._vertices[1],rbX=this._vertices[segmentXD],rbY=this._vertices[segmentXD+1],rcX=this._vertices[lastIndex],rcY=this._vertices[lastIndex+1],rdX=this._vertices[lastIndex-segmentXD],rdY=this._vertices[lastIndex-segmentXD+1],dacX=raX+.5*(rcX-raX),dacY=raY+.5*(rcY-raY),dbdX,dbdY,aX=dacX+.5*(rbX+.5*(rdX-rbX)-dacX),aY=dacY+.5*(rbY+.5*(rdY-rbY)-dacY),bX=rbX+.5*(rcX-rbX),bY=rbY+.5*(rcY-rbY),cX=rdX+.5*(rcX-rdX),cY=rdY+.5*(rcY-rdY);this._getAffineTransform(0,0,lA,lA,aX,aY,bX,bY,cX,cY,this.global,this.globalTransformMatrix,!1),this._globalDirty=!1},Surface.prototype._getGlobalTransformMatrix=function(x,y){var lA=200,lB=1e3;if(x<-lB||lB<x||y<-lB||lB<y)return this.globalTransformMatrix;var isDown=!1,surfaceData=this._boneData,segmentX=surfaceData.segmentX,segmentY=surfaceData.segmentY,segmentXD=2*surfaceData.segmentX,dX=this._dX,dY=this._dY,indexX=Math.floor((x+lA)/dX),indexY=Math.floor((y+lA)/dY),matrixIndex=0,pX=indexX*dX-lA,pY=indexY*dY-lA,matrices=this._matrixCahce,helpMatrix=Surface._helpMatrix;if(x<-lA){if(y<-lA||y>=lA)return this.globalTransformMatrix;if(matrices[matrixIndex=7*(2*(segmentX*segmentY+segmentX+segmentY+segmentY+indexY)+((isDown=y>this._kX*(x+lA)+pY)?1:0))]>0)helpMatrix.copyFromArray(matrices,matrixIndex+1);else{var vertexIndex=indexY*(segmentXD+2),ddX=this._hullCache[4],ddY=this._hullCache[5],sX=this._hullCache[2]-(segmentY-indexY)*ddX,sY=this._hullCache[3]-(segmentY-indexY)*ddY,vertices=this._vertices;isDown?this._getAffineTransform(-lA,pY+dY,800,dY,vertices[vertexIndex+segmentXD+2],vertices[vertexIndex+segmentXD+3],sX+ddX,sY+ddY,vertices[vertexIndex],vertices[vertexIndex+1],Surface._helpTransform,helpMatrix,!0):this._getAffineTransform(-lB,pY,800,dY,sX,sY,vertices[vertexIndex],vertices[vertexIndex+1],sX+ddX,sY+ddY,Surface._helpTransform,helpMatrix,!1),matrices[matrixIndex]=1,matrices[matrixIndex+1]=helpMatrix.a,matrices[matrixIndex+2]=helpMatrix.b,matrices[matrixIndex+3]=helpMatrix.c,matrices[matrixIndex+4]=helpMatrix.d,matrices[matrixIndex+5]=helpMatrix.tx,matrices[matrixIndex+6]=helpMatrix.ty}}else if(x>=lA){if(y<-lA||y>=lA)return this.globalTransformMatrix;if(matrices[matrixIndex=7*(2*(segmentX*segmentY+segmentX+indexY)+((isDown=y>this._kX*(x-lB)+pY)?1:0))]>0)helpMatrix.copyFromArray(matrices,matrixIndex+1);else{var vertexIndex=(indexY+1)*(segmentXD+2)-2,ddX=this._hullCache[4],ddY=this._hullCache[5],sX=this._hullCache[0]+indexY*ddX,sY=this._hullCache[1]+indexY*ddY,vertices=this._vertices;isDown?this._getAffineTransform(lB,pY+dY,800,dY,sX+ddX,sY+ddY,vertices[vertexIndex+segmentXD+2],vertices[vertexIndex+segmentXD+3],sX,sY,Surface._helpTransform,helpMatrix,!0):this._getAffineTransform(lA,pY,800,dY,vertices[vertexIndex],vertices[vertexIndex+1],sX,sY,vertices[vertexIndex+segmentXD+2],vertices[vertexIndex+segmentXD+3],Surface._helpTransform,helpMatrix,!1),matrices[matrixIndex]=1,matrices[matrixIndex+1]=helpMatrix.a,matrices[matrixIndex+2]=helpMatrix.b,matrices[matrixIndex+3]=helpMatrix.c,matrices[matrixIndex+4]=helpMatrix.d,matrices[matrixIndex+5]=helpMatrix.tx,matrices[matrixIndex+6]=helpMatrix.ty}}else if(y<-lA){if(x<-lA||x>=lA)return this.globalTransformMatrix;if(matrices[matrixIndex=7*(2*(segmentX*segmentY+indexX)+((isDown=y>this._kY*(x-pX-dX)-lB)?1:0))]>0)helpMatrix.copyFromArray(matrices,matrixIndex+1);else{var vertexIndex=2*indexX,ddX=this._hullCache[10],ddY=this._hullCache[11],sX=this._hullCache[8]+indexX*ddX,sY=this._hullCache[9]+indexX*ddY,vertices=this._vertices;isDown?this._getAffineTransform(pX+dX,-lA,dX,800,vertices[vertexIndex+2],vertices[vertexIndex+3],vertices[vertexIndex],vertices[vertexIndex+1],sX+ddX,sY+ddY,Surface._helpTransform,helpMatrix,!0):this._getAffineTransform(pX,-lB,dX,800,sX,sY,sX+ddX,sY+ddY,vertices[vertexIndex],vertices[vertexIndex+1],Surface._helpTransform,helpMatrix,!1),matrices[matrixIndex]=1,matrices[matrixIndex+1]=helpMatrix.a,matrices[matrixIndex+2]=helpMatrix.b,matrices[matrixIndex+3]=helpMatrix.c,matrices[matrixIndex+4]=helpMatrix.d,matrices[matrixIndex+5]=helpMatrix.tx,matrices[matrixIndex+6]=helpMatrix.ty}}else if(y>=lA){if(x<-lA||x>=lA)return this.globalTransformMatrix;if(matrices[matrixIndex=7*(2*(segmentX*segmentY+segmentX+segmentY+indexX)+((isDown=y>this._kY*(x-pX-dX)+lA)?1:0))]>0)helpMatrix.copyFromArray(matrices,matrixIndex+1);else{var vertexIndex=segmentY*(segmentXD+2)+2*indexX,ddX=this._hullCache[10],ddY=this._hullCache[11],sX=this._hullCache[6]-(segmentX-indexX)*ddX,sY=this._hullCache[7]-(segmentX-indexX)*ddY,vertices=this._vertices;isDown?this._getAffineTransform(pX+dX,lB,dX,800,sX+ddX,sY+ddY,sX,sY,vertices[vertexIndex+2],vertices[vertexIndex+3],Surface._helpTransform,helpMatrix,!0):this._getAffineTransform(pX,lA,dX,800,vertices[vertexIndex],vertices[vertexIndex+1],vertices[vertexIndex+2],vertices[vertexIndex+3],sX,sY,Surface._helpTransform,helpMatrix,!1),matrices[matrixIndex]=1,matrices[matrixIndex+1]=helpMatrix.a,matrices[matrixIndex+2]=helpMatrix.b,matrices[matrixIndex+3]=helpMatrix.c,matrices[matrixIndex+4]=helpMatrix.d,matrices[matrixIndex+5]=helpMatrix.tx,matrices[matrixIndex+6]=helpMatrix.ty}}else if(matrices[matrixIndex=7*(2*(segmentX*indexY+indexX)+((isDown=y>this._k*(x-pX-dX)+pY)?1:0))]>0)helpMatrix.copyFromArray(matrices,matrixIndex+1);else{var vertexIndex=2*indexX+indexY*(segmentXD+2),vertices=this._vertices;isDown?this._getAffineTransform(pX+dX,pY+dY,dX,dY,vertices[vertexIndex+segmentXD+4],vertices[vertexIndex+segmentXD+5],vertices[vertexIndex+segmentXD+2],vertices[vertexIndex+segmentXD+3],vertices[vertexIndex+2],vertices[vertexIndex+3],Surface._helpTransform,helpMatrix,!0):this._getAffineTransform(pX,pY,dX,dY,vertices[vertexIndex],vertices[vertexIndex+1],vertices[vertexIndex+2],vertices[vertexIndex+3],vertices[vertexIndex+segmentXD+2],vertices[vertexIndex+segmentXD+3],Surface._helpTransform,helpMatrix,!1),matrices[matrixIndex]=1,matrices[matrixIndex+1]=helpMatrix.a,matrices[matrixIndex+2]=helpMatrix.b,matrices[matrixIndex+3]=helpMatrix.c,matrices[matrixIndex+4]=helpMatrix.d,matrices[matrixIndex+5]=helpMatrix.tx,matrices[matrixIndex+6]=helpMatrix.ty}return helpMatrix},Surface.prototype.init=function(surfaceData,armatureValue){if(null===this._boneData){_super.prototype.init.call(this,surfaceData,armatureValue);var segmentX=surfaceData.segmentX,segmentY=surfaceData.segmentY,vertexCount=this._armature.armatureData.parent.intArray[surfaceData.geometry.offset+0],lB=1e3,lA=200;this._dX=400/segmentX,this._dY=400/segmentY,this._k=-this._dY/this._dX,this._kX=-this._dY/800,this._kY=-800/this._dX,this._vertices.length=2*vertexCount,this._deformVertices.length=2*vertexCount,this._matrixCahce.length=2*(segmentX*segmentY+2*segmentX+2*segmentY)*7,this._hullCache.length=10;for(var i=0;i<2*vertexCount;++i)this._deformVertices[i]=0;null!==this._parent&&(0===this._parent.boneData.type?this._bone=this._parent:this._bone=this._parent._bone)}},Surface.prototype.update=function(cacheFrameIndex){if(cacheFrameIndex>=0&&null!==this._cachedFrameIndices){var cachedFrameIndex=this._cachedFrameIndices[cacheFrameIndex];if(cachedFrameIndex>=0&&this._cachedFrameIndex===cachedFrameIndex)this._transformDirty=!1;else if(cachedFrameIndex>=0)this._transformDirty=!0,this._cachedFrameIndex=cachedFrameIndex;else{if(this._hasConstraint)for(var _i=0,_a=this._armature._constraints;_i<_a.length;_i++){var constraint;(constraint=_a[_i])._root===this&&constraint.update()}this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[cacheFrameIndex]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var _b=0,_c=this._armature._constraints;_b<_c.length;_b++){var constraint;(constraint=_c[_b])._root===this&&constraint.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(cacheFrameIndex=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){this._transformDirty=!1,this._childrenTransformDirty=!0;for(var i=0,l=this._matrixCahce.length;i<l;i+=7)this._matrixCahce[i]=-1;if(this._updateVertices(),this._cachedFrameIndex<0){var isCache=cacheFrameIndex>=0;this._localDirty&&this._updateGlobalTransformMatrix(isCache),isCache&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[cacheFrameIndex]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);var lB=1e3,lA=200,ddX=2*this.global.x,ddY=2*this.global.y,helpPoint=Surface._helpPoint;this.globalTransformMatrix.transformPoint(lB,-lA,helpPoint),this._hullCache[0]=helpPoint.x,this._hullCache[1]=helpPoint.y,this._hullCache[2]=ddX-helpPoint.x,this._hullCache[3]=ddY-helpPoint.y,this.globalTransformMatrix.transformPoint(0,this._dY,helpPoint,!0),this._hullCache[4]=helpPoint.x,this._hullCache[5]=helpPoint.y,this.globalTransformMatrix.transformPoint(lA,lB,helpPoint),this._hullCache[6]=helpPoint.x,this._hullCache[7]=helpPoint.y,this._hullCache[8]=ddX-helpPoint.x,this._hullCache[9]=ddY-helpPoint.y,this.globalTransformMatrix.transformPoint(this._dX,0,helpPoint,!0),this._hullCache[10]=helpPoint.x,this._hullCache[11]=helpPoint.y}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},Surface}(dragonBones.Bone);dragonBones.Surface=Surface}(dragonBones||(dragonBones={})),function(dragonBones){var DisplayFrame=function(_super){function DisplayFrame(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.deformVertices=[],_this}return __extends(DisplayFrame,_super),DisplayFrame.toString=function(){return"[class dragonBones.DisplayFrame]"},DisplayFrame.prototype._onClear=function(){this.rawDisplayData=null,this.displayData=null,this.textureData=null,this.display=null,this.deformVertices.length=0},DisplayFrame.prototype.updateDeformVertices=function(){if(null!==this.rawDisplayData&&0===this.deformVertices.length){var rawGeometryData;if(2===this.rawDisplayData.type)rawGeometryData=this.rawDisplayData.geometry;else{if(4!==this.rawDisplayData.type)return;rawGeometryData=this.rawDisplayData.geometry}var vertexCount=0;vertexCount=null!==rawGeometryData.weight?2*rawGeometryData.weight.count:2*rawGeometryData.data.intArray[rawGeometryData.offset+0],this.deformVertices.length=vertexCount;for(var i=0,l=this.deformVertices.length;i<l;++i)this.deformVertices[i]=0}},DisplayFrame.prototype.getGeometryData=function(){if(null!==this.displayData){if(2===this.displayData.type)return this.displayData.geometry;if(4===this.displayData.type)return this.displayData.geometry}if(null!==this.rawDisplayData){if(2===this.rawDisplayData.type)return this.rawDisplayData.geometry;if(4===this.rawDisplayData.type)return this.rawDisplayData.geometry}return null},DisplayFrame.prototype.getBoundingBox=function(){return null!==this.displayData&&3===this.displayData.type?this.displayData.boundingBox:null!==this.rawDisplayData&&3===this.rawDisplayData.type?this.rawDisplayData.boundingBox:null},DisplayFrame.prototype.getTextureData=function(){if(null!==this.displayData){if(0===this.displayData.type)return this.displayData.texture;if(2===this.displayData.type)return this.displayData.texture}if(null!==this.textureData)return this.textureData;if(null!==this.rawDisplayData){if(0===this.rawDisplayData.type)return this.rawDisplayData.texture;if(2===this.rawDisplayData.type)return this.rawDisplayData.texture}return null},DisplayFrame}(dragonBones.BaseObject);dragonBones.DisplayFrame=DisplayFrame;var Slot=function(_super){function Slot(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._localMatrix=new dragonBones.Matrix,_this._colorTransform=new dragonBones.ColorTransform,_this._displayFrames=[],_this._geometryBones=[],_this._rawDisplay=null,_this._meshDisplay=null,_this._display=null,_this}return __extends(Slot,_super),Slot.prototype._onClear=function(){_super.prototype._onClear.call(this);for(var disposeDisplayList=[],_i=0,_a=this._displayFrames;_i<_a.length;_i++){var dispayFrame=_a[_i],display=dispayFrame.display;display!==this._rawDisplay&&display!==this._meshDisplay&&disposeDisplayList.indexOf(display)<0&&disposeDisplayList.push(display),dispayFrame.returnToPool()}for(var _b=0,disposeDisplayList_1=disposeDisplayList;_b<disposeDisplayList_1.length;_b++){var eachDisplay=disposeDisplayList_1[_b];eachDisplay instanceof dragonBones.Armature?eachDisplay.dispose():this._disposeDisplay(eachDisplay,!0)}null!==this._meshDisplay&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay,!1),null!==this._rawDisplay&&this._disposeDisplay(this._rawDisplay,!1),this.displayController=null,this._displayDataDirty=!1,this._displayDirty=!1,this._geometryDirty=!1,this._textureDirty=!1,this._visibleDirty=!1,this._blendModeDirty=!1,this._zOrderDirty=!1,this._colorDirty=!1,this._verticesDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=0,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._zIndex=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._displayFrames.length=0,this._geometryBones.length=0,this._slotData=null,this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._parent=null,this._cachedFrameIndices=null},Slot.prototype._hasDisplay=function(display){for(var _i=0,_a=this._displayFrames;_i<_a.length;_i++){var displayFrame;if(_a[_i].display===display)return!0}return!1},Slot.prototype._isBonesUpdate=function(){for(var _i=0,_a=this._geometryBones;_i<_a.length;_i++){var bone=_a[_i];if(null!==bone&&bone._childrenTransformDirty)return!0}return!1},Slot.prototype._updateAlpha=function(){var globalAlpha=this._alpha*this._parent._globalAlpha;this._globalAlpha!==globalAlpha&&(this._globalAlpha=globalAlpha,this._colorDirty=!0)},Slot.prototype._updateDisplayData=function(){var prevDisplayFrame=this._displayFrame,prevGeometryData=this._geometryData,prevTextureData=this._textureData,rawDisplayData=null,displayData=null;if(this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._displayIndex>=0&&this._displayIndex<this._displayFrames.length&&(this._displayFrame=this._displayFrames[this._displayIndex],rawDisplayData=this._displayFrame.rawDisplayData,displayData=this._displayFrame.displayData,this._geometryData=this._displayFrame.getGeometryData(),this._boundingBoxData=this._displayFrame.getBoundingBox(),this._textureData=this._displayFrame.getTextureData()),this._displayFrame!==prevDisplayFrame||this._geometryData!==prevGeometryData||this._textureData!==prevTextureData){if(null===this._geometryData&&null!==this._textureData){var imageDisplayData=null!==displayData&&0===displayData.type?displayData:rawDisplayData,scale=this._textureData.parent.scale*this._armature._armatureData.scale,frame=this._textureData.frame;this._pivotX=imageDisplayData.pivot.x,this._pivotY=imageDisplayData.pivot.y;var rect=null!==frame?frame:this._textureData.region,width=rect.width,height=rect.height;this._textureData.rotated&&null===frame&&(width=rect.height,height=rect.width),this._pivotX*=width*scale,this._pivotY*=height*scale,null!==frame&&(this._pivotX+=frame.x*scale,this._pivotY+=frame.y*scale),null!==rawDisplayData&&imageDisplayData!==rawDisplayData&&(rawDisplayData.transform.toMatrix(Slot._helpMatrix),Slot._helpMatrix.invert(),Slot._helpMatrix.transformPoint(0,0,Slot._helpPoint),this._pivotX-=Slot._helpPoint.x,this._pivotY-=Slot._helpPoint.y,imageDisplayData.transform.toMatrix(Slot._helpMatrix),Slot._helpMatrix.invert(),Slot._helpMatrix.transformPoint(0,0,Slot._helpPoint),this._pivotX+=Slot._helpPoint.x,this._pivotY+=Slot._helpPoint.y),dragonBones.DragonBones.yDown||(this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*scale-this._pivotY)}else this._pivotX=0,this._pivotY=0;if(this.origin=null!==rawDisplayData?rawDisplayData.transform:null!==displayData?displayData.transform:null,null!==this.origin?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix),this._geometryData!==prevGeometryData)if(this._geometryDirty=!0,this._verticesDirty=!0,null!==this._geometryData){if(this._geometryBones.length=0,null!==this._geometryData.weight)for(var i=0,l=this._geometryData.weight.bones.length;i<l;++i){var bone=this._armature.getBone(this._geometryData.weight.bones[i].name);this._geometryBones.push(bone)}}else this._geometryBones.length=0,this._geometryData=null;this._textureDirty=this._textureData!==prevTextureData,this._transformDirty=!0}},Slot.prototype._updateDisplay=function(){var prevDisplay=null!==this._display?this._display:this._rawDisplay,prevChildArmature=this._childArmature,currentDisplay;if(null!==this._displayFrame?(this._display=this._displayFrame.display,null!==this._display&&this._display instanceof dragonBones.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null),(null!==this._display?this._display:this._rawDisplay)!==prevDisplay&&(this._textureDirty=!0,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._transformDirty=!0,this._onUpdateDisplay(),this._replaceDisplay(prevDisplay)),this._childArmature!==prevChildArmature&&(null!==prevChildArmature&&(prevChildArmature._parent=null,prevChildArmature.clock=null,prevChildArmature.inheritAnimation&&prevChildArmature.animation.reset()),null!==this._childArmature&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(0===this._childArmature.cacheFrameRate){var cacheFrameRate=this._armature.cacheFrameRate;0!==cacheFrameRate&&(this._childArmature.cacheFrameRate=cacheFrameRate)}if(null!==this._displayFrame){var actions=null,displayData=null!==this._displayFrame.displayData?this._displayFrame.displayData:this._displayFrame.rawDisplayData;if(null!==displayData&&1===displayData.type&&(actions=displayData.actions),null!==actions&&actions.length>0)for(var _i=0,actions_1=actions;_i<actions_1.length;_i++){var action=actions_1[_i],eventObject=dragonBones.BaseObject.borrowObject(dragonBones.EventObject);dragonBones.EventObject.actionDataToInstance(action,eventObject,this._armature),eventObject.slot=this,this._armature._bufferAction(eventObject,!1)}else this._childArmature.animation.play()}}},Slot.prototype._updateGlobalTransformMatrix=function(isCache){var parentMatrix=0===this._parent._boneData.type?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(parentMatrix),isCache?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},Slot.prototype._setDisplayIndex=function(value,isAnimation){if(void 0===isAnimation&&(isAnimation=!1),isAnimation){if(this._animationDisplayIndex===value)return;this._animationDisplayIndex=value}this._displayIndex!==value&&(this._displayIndex=value<this._displayFrames.length?value:this._displayFrames.length-1,this._displayDataDirty=!0,this._displayDirty=this._displayIndex<0||this._display!==this._displayFrames[this._displayIndex].display)},Slot.prototype._setZOrder=function(value){return this._zOrder,this._zOrder=value,this._zOrderDirty=!0,this._zOrderDirty},Slot.prototype._setColor=function(value){return this._colorTransform.copyFrom(value),this._colorDirty=!0},Slot.prototype.init=function(slotData,armatureValue,rawDisplay,meshDisplay){if(null===this._slotData){this._slotData=slotData,this._colorDirty=!0,this._blendModeDirty=!0,this._blendMode=this._slotData.blendMode,this._zOrder=this._slotData.zOrder,this._zIndex=this._slotData.zIndex,this._alpha=this._slotData.alpha,this._colorTransform.copyFrom(this._slotData.color),this._rawDisplay=rawDisplay,this._meshDisplay=meshDisplay,this._armature=armatureValue;var slotParent=this._armature.getBone(this._slotData.parent.name);null!==slotParent&&(this._parent=slotParent),this._armature._addSlot(this),this._initDisplay(this._rawDisplay,!1),this._rawDisplay!==this._meshDisplay&&this._initDisplay(this._meshDisplay,!1),this._onUpdateDisplay(),this._addDisplay()}},Slot.prototype.update=function(cacheFrameIndex){if(this._displayDataDirty&&(this._updateDisplayData(),this._displayDataDirty=!1),this._displayDirty&&(this._updateDisplay(),this._displayDirty=!1),(this._geometryDirty||this._textureDirty)&&(null!==this._display&&this._display!==this._rawDisplay&&this._display!==this._meshDisplay||this._updateFrame(),this._geometryDirty=!1,this._textureDirty=!1),null!==this._display){if(this._visibleDirty&&(this._updateVisible(),this._visibleDirty=!1),this._blendModeDirty&&(this._updateBlendMode(),this._blendModeDirty=!1),this._colorDirty&&(this._updateColor(),this._colorDirty=!1),this._zOrderDirty&&(this._updateZOrder(),this._zOrderDirty=!1),null!==this._geometryData&&this._display===this._meshDisplay){var isSkinned=null!==this._geometryData.weight,isSurface=0!==this._parent._boneData.type;if((this._verticesDirty||isSkinned&&this._isBonesUpdate()||isSurface&&this._parent._childrenTransformDirty)&&(this._verticesDirty=!1,this._updateMesh()),isSkinned||isSurface)return}if(cacheFrameIndex>=0&&null!==this._cachedFrameIndices){var cachedFrameIndex=this._cachedFrameIndices[cacheFrameIndex];cachedFrameIndex>=0&&this._cachedFrameIndex===cachedFrameIndex?this._transformDirty=!1:cachedFrameIndex>=0?(this._transformDirty=!0,this._cachedFrameIndex=cachedFrameIndex):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[cacheFrameIndex]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(cacheFrameIndex=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._transformDirty){if(this._cachedFrameIndex<0){var isCache=cacheFrameIndex>=0;this._updateGlobalTransformMatrix(isCache),isCache&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[cacheFrameIndex]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform(),this._transformDirty=!1}}},Slot.prototype.invalidUpdate=function(){this._displayDataDirty=!0,this._displayDirty=!0,this._transformDirty=!0},Slot.prototype.updateTransformAndMatrix=function(){this._transformDirty&&(this._updateGlobalTransformMatrix(!1),this._transformDirty=!1)},Slot.prototype.replaceRawDisplayData=function(displayData,index){if(void 0===index&&(index=-1),index<0)index=this._displayIndex<0?0:this._displayIndex;else if(index>=this._displayFrames.length)return;var displayFrame=this._displayFrames[index];if(displayFrame.rawDisplayData!==displayData){if(displayFrame.deformVertices.length=0,displayFrame.rawDisplayData=displayData,null===displayFrame.rawDisplayData){var defaultSkin=this._armature._armatureData.defaultSkin;if(null!==defaultSkin){var defaultRawDisplayDatas=defaultSkin.getDisplays(this._slotData.name);null!==defaultRawDisplayDatas&&index<defaultRawDisplayDatas.length&&(displayFrame.rawDisplayData=defaultRawDisplayDatas[index])}}index===this._displayIndex&&(this._displayDataDirty=!0)}},Slot.prototype.replaceDisplayData=function(displayData,index){if(void 0===index&&(index=-1),index<0)index=this._displayIndex<0?0:this._displayIndex;else if(index>=this._displayFrames.length)return;var displayFrame=this._displayFrames[index];displayFrame.displayData!==displayData&&displayFrame.rawDisplayData!==displayData&&(displayFrame.displayData=displayData,index===this._displayIndex&&(this._displayDataDirty=!0))},Slot.prototype.replaceTextureData=function(textureData,index){if(void 0===index&&(index=-1),index<0)index=this._displayIndex<0?0:this._displayIndex;else if(index>=this._displayFrames.length)return;var displayFrame=this._displayFrames[index];displayFrame.textureData!==textureData&&(displayFrame.textureData=textureData,index===this._displayIndex&&(this._displayDataDirty=!0))},Slot.prototype.replaceDisplay=function(value,index){if(void 0===index&&(index=-1),index<0)index=this._displayIndex<0?0:this._displayIndex;else if(index>=this._displayFrames.length)return;var displayFrame=this._displayFrames[index];if(displayFrame.display!==value){var prevDisplay=displayFrame.display;displayFrame.display=value,null===prevDisplay||prevDisplay===this._rawDisplay||prevDisplay===this._meshDisplay||this._hasDisplay(prevDisplay)||prevDisplay instanceof dragonBones.Armature||this._disposeDisplay(prevDisplay,!0),null===value||value===this._rawDisplay||value===this._meshDisplay||this._hasDisplay(prevDisplay)||value instanceof dragonBones.Armature||this._initDisplay(value,!0),index===this._displayIndex&&(this._displayDirty=!0)}},Slot.prototype.containsPoint=function(x,y){return null!==this._boundingBoxData&&(this.updateTransformAndMatrix(),Slot._helpMatrix.copyFrom(this.globalTransformMatrix),Slot._helpMatrix.invert(),Slot._helpMatrix.transformPoint(x,y,Slot._helpPoint),this._boundingBoxData.containsPoint(Slot._helpPoint.x,Slot._helpPoint.y))},Slot.prototype.intersectsSegment=function(xA,yA,xB,yB,intersectionPointA,intersectionPointB,normalRadians){if(void 0===intersectionPointA&&(intersectionPointA=null),void 0===intersectionPointB&&(intersectionPointB=null),void 0===normalRadians&&(normalRadians=null),null===this._boundingBoxData)return 0;this.updateTransformAndMatrix(),Slot._helpMatrix.copyFrom(this.globalTransformMatrix),Slot._helpMatrix.invert(),Slot._helpMatrix.transformPoint(xA,yA,Slot._helpPoint),xA=Slot._helpPoint.x,yA=Slot._helpPoint.y,Slot._helpMatrix.transformPoint(xB,yB,Slot._helpPoint),xB=Slot._helpPoint.x,yB=Slot._helpPoint.y;var intersectionCount=this._boundingBoxData.intersectsSegment(xA,yA,xB,yB,intersectionPointA,intersectionPointB,normalRadians);return intersectionCount>0&&(1===intersectionCount||2===intersectionCount?null!==intersectionPointA?(this.globalTransformMatrix.transformPoint(intersectionPointA.x,intersectionPointA.y,intersectionPointA),null!==intersectionPointB&&(intersectionPointB.x=intersectionPointA.x,intersectionPointB.y=intersectionPointA.y)):null!==intersectionPointB&&this.globalTransformMatrix.transformPoint(intersectionPointB.x,intersectionPointB.y,intersectionPointB):(null!==intersectionPointA&&this.globalTransformMatrix.transformPoint(intersectionPointA.x,intersectionPointA.y,intersectionPointA),null!==intersectionPointB&&this.globalTransformMatrix.transformPoint(intersectionPointB.x,intersectionPointB.y,intersectionPointB)),null!==normalRadians&&(this.globalTransformMatrix.transformPoint(Math.cos(normalRadians.x),Math.sin(normalRadians.x),Slot._helpPoint,!0),normalRadians.x=Math.atan2(Slot._helpPoint.y,Slot._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(normalRadians.y),Math.sin(normalRadians.y),Slot._helpPoint,!0),normalRadians.y=Math.atan2(Slot._helpPoint.y,Slot._helpPoint.x))),intersectionCount},Slot.prototype.getDisplayFrameAt=function(index){return this._displayFrames[index]},Object.defineProperty(Slot.prototype,"visible",{get:function(){return this._visible},set:function(value){this._visible!==value&&(this._visible=value,this._updateVisible())},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"displayFrameCount",{get:function(){return this._displayFrames.length},set:function(value){var prevCount=this._displayFrames.length;if(prevCount<value){this._displayFrames.length=value;for(var i=prevCount;i<value;++i)this._displayFrames[i]=dragonBones.BaseObject.borrowObject(DisplayFrame)}else if(prevCount>value){for(var i=prevCount-1;i<value;--i)this.replaceDisplay(null,i),this._displayFrames[i].returnToPool();this._displayFrames.length=value}},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(value){this._setDisplayIndex(value),this.update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"name",{get:function(){return this._slotData.name},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"displayList",{get:function(){for(var displays=new Array,_i=0,_a=this._displayFrames;_i<_a.length;_i++){var displayFrame=_a[_i];displays.push(displayFrame.display)}return displays},set:function(value){this.displayFrameCount=value.length;for(var index=0,_i=0,value_1=value;_i<value_1.length;_i++){var eachDisplay=value_1[_i];this.replaceDisplay(eachDisplay,index++)}},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"slotData",{get:function(){return this._slotData},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"display",{get:function(){return this._display},set:function(value){this._display!==value&&(0===this._displayFrames.length&&(this.displayFrameCount=1,this._displayIndex=0),this.replaceDisplay(value,this._displayIndex))},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"childArmature",{get:function(){return this._childArmature},set:function(value){this._childArmature!==value&&(this.display=value)},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Slot.prototype.getDisplay=function(){return this._display},Slot.prototype.setDisplay=function(value){this.display=value},Slot}(dragonBones.TransformObject);dragonBones.Slot=Slot}(dragonBones||(dragonBones={})),function(dragonBones){var Constraint=function(_super){function Constraint(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Constraint,_super),Constraint.prototype._onClear=function(){this._armature=null,this._target=null,this._root=null,this._bone=null},Object.defineProperty(Constraint.prototype,"name",{get:function(){return this._constraintData.name},enumerable:!0,configurable:!0}),Constraint._helpMatrix=new dragonBones.Matrix,Constraint._helpTransform=new dragonBones.Transform,Constraint._helpPoint=new dragonBones.Point,Constraint}(dragonBones.BaseObject);dragonBones.Constraint=Constraint;var IKConstraint=function(_super){function IKConstraint(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(IKConstraint,_super),IKConstraint.toString=function(){return"[class dragonBones.IKConstraint]"},IKConstraint.prototype._onClear=function(){_super.prototype._onClear.call(this),this._bendPositive=!1,this._weight=1,this._constraintData=null},IKConstraint.prototype._computeA=function(){var ikGlobal=this._target.global,global=this._root.global,globalTransformMatrix=this._root.globalTransformMatrix,radian=Math.atan2(ikGlobal.y-global.y,ikGlobal.x-global.x);global.scaleX<0&&(radian+=Math.PI),global.rotation+=dragonBones.Transform.normalizeRadian(radian-global.rotation)*this._weight,global.toMatrix(globalTransformMatrix)},IKConstraint.prototype._computeB=function(){var boneLength=this._bone._boneData.length,parent=this._root,ikGlobal=this._target.global,parentGlobal=parent.global,global=this._bone.global,globalTransformMatrix=this._bone.globalTransformMatrix,x=globalTransformMatrix.a*boneLength,y=globalTransformMatrix.b*boneLength,lLL=x*x+y*y,lL=Math.sqrt(lLL),dX=global.x-parentGlobal.x,dY=global.y-parentGlobal.y,lPP=dX*dX+dY*dY,lP=Math.sqrt(lPP),rawRadian=global.rotation,rawParentRadian=parentGlobal.rotation,rawRadianA=Math.atan2(dY,dX),lTT=(dX=ikGlobal.x-parentGlobal.x)*dX+(dY=ikGlobal.y-parentGlobal.y)*dY,lT=Math.sqrt(lTT),radianA=0;if(lL+lP<=lT||lT+lL<=lP||lT+lP<=lL)radianA=Math.atan2(ikGlobal.y-parentGlobal.y,ikGlobal.x-parentGlobal.x),lL+lP<=lT||lP<lL&&(radianA+=Math.PI);else{var h=(lPP-lLL+lTT)/(2*lTT),r=Math.sqrt(lPP-h*h*lTT)/lT,hX=parentGlobal.x+dX*h,hY=parentGlobal.y+dY*h,rX=-dY*r,rY=dX*r,isPPR=!1,parentParent=parent.parent;if(null!==parentParent){var parentParentMatrix=parentParent.globalTransformMatrix;isPPR=parentParentMatrix.a*parentParentMatrix.d-parentParentMatrix.b*parentParentMatrix.c<0}isPPR!==this._bendPositive?(global.x=hX-rX,global.y=hY-rY):(global.x=hX+rX,global.y=hY+rY),radianA=Math.atan2(global.y-parentGlobal.y,global.x-parentGlobal.x)}var dR=dragonBones.Transform.normalizeRadian(radianA-rawRadianA);parentGlobal.rotation=rawParentRadian+dR*this._weight,parentGlobal.toMatrix(parent.globalTransformMatrix);var currentRadianA=rawRadianA+dR*this._weight;global.x=parentGlobal.x+Math.cos(currentRadianA)*lP,global.y=parentGlobal.y+Math.sin(currentRadianA)*lP;var radianB=Math.atan2(ikGlobal.y-global.y,ikGlobal.x-global.x);global.scaleX<0&&(radianB+=Math.PI),global.rotation=parentGlobal.rotation+rawRadian-rawParentRadian+dragonBones.Transform.normalizeRadian(radianB-dR-rawRadian)*this._weight,global.toMatrix(globalTransformMatrix)},IKConstraint.prototype.init=function(constraintData,armature){if(null===this._constraintData){this._constraintData=constraintData,this._armature=armature,this._target=this._armature.getBone(this._constraintData.target.name),this._root=this._armature.getBone(this._constraintData.root.name),this._bone=null!==this._constraintData.bone?this._armature.getBone(this._constraintData.bone.name):null;var ikConstraintData=this._constraintData;this._bendPositive=ikConstraintData.bendPositive,this._weight=ikConstraintData.weight,this._root._hasConstraint=!0}},IKConstraint.prototype.update=function(){this._root.updateByConstraint(),null!==this._bone?(this._bone.updateByConstraint(),this._computeB()):this._computeA()},IKConstraint.prototype.invalidUpdate=function(){this._root.invalidUpdate(),null!==this._bone&&this._bone.invalidUpdate()},IKConstraint}(Constraint);dragonBones.IKConstraint=IKConstraint;var PathConstraint=function(_super){function PathConstraint(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._bones=[],_this._spaces=[],_this._positions=[],_this._curves=[],_this._boneLengths=[],_this._pathGlobalVertices=[],_this._segments=[10],_this}return __extends(PathConstraint,_super),PathConstraint.toString=function(){return"[class dragonBones.PathConstraint]"},PathConstraint.prototype._onClear=function(){_super.prototype._onClear.call(this),this.dirty=!1,this.pathOffset=0,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=1,this.translateMix=1,this._pathSlot=null,this._bones.length=0,this._spaces.length=0,this._positions.length=0,this._curves.length=0,this._boneLengths.length=0,this._pathGlobalVertices.length=0},PathConstraint.prototype._updatePathVertices=function(verticesData){var armature=this._armature,dragonBonesData=armature.armatureData.parent,scale=armature.armatureData.scale,intArray=dragonBonesData.intArray,floatArray=dragonBonesData.floatArray,pathOffset=verticesData.offset,pathVertexCount=intArray[pathOffset+0],pathVertexOffset=intArray[pathOffset+2];this._pathGlobalVertices.length=2*pathVertexCount;var weightData=verticesData.weight;if(null!==weightData)for(var bones=this._pathSlot._geometryBones,weightBoneCount=weightData.bones.length,weightOffset=weightData.offset,floatOffset,iV=intArray[weightOffset+1],iB=weightOffset+2+weightBoneCount,i=0,iW=0;i<pathVertexCount;i++){for(var vertexBoneCount,xG=0,yG=0,ii=0,ll=intArray[iB++];ii<ll;ii++){var boneIndex,bone=bones[intArray[iB++]];if(null!==bone){bone.updateByConstraint();var matrix=bone.globalTransformMatrix,weight=floatArray[iV++],vx=floatArray[iV++]*scale,vy=floatArray[iV++]*scale;xG+=(matrix.a*vx+matrix.c*vy+matrix.tx)*weight,yG+=(matrix.b*vx+matrix.d*vy+matrix.ty)*weight}}this._pathGlobalVertices[iW++]=xG,this._pathGlobalVertices[iW++]=yG}else{var parentBone=this._pathSlot.parent;parentBone.updateByConstraint();for(var matrix=parentBone.globalTransformMatrix,i=0,iV_1=pathVertexOffset;i<pathVertexCount;i+=2){var vx=floatArray[iV_1++]*scale,vy=floatArray[iV_1++]*scale,x=matrix.a*vx+matrix.c*vy+matrix.tx,y=matrix.b*vx+matrix.d*vy+matrix.ty;this._pathGlobalVertices[i]=x,this._pathGlobalVertices[i+1]=y}}},PathConstraint.prototype._computeVertices=function(start,count,offset,out){for(var i=offset,iW=start;i<count;i+=2)out[i]=this._pathGlobalVertices[iW++],out[i+1]=this._pathGlobalVertices[iW++]},PathConstraint.prototype._computeBezierCurve=function(pathDisplayDta,spaceCount,tangents,percentPosition,percentSpacing){var armature,intArray,vertexCount=this._armature.armatureData.parent.intArray[pathDisplayDta.geometry.offset+0],positions=this._positions,spaces=this._spaces,isClosed=pathDisplayDta.closed,curveVertices=Array(),verticesLength=2*vertexCount,curveCount=verticesLength/6,preCurve=-1,position=this.position;positions.length=3*spaceCount+2;var pathLength=0;if(pathDisplayDta.constantSpeed){isClosed?(verticesLength+=2,curveVertices.length=vertexCount,this._computeVertices(2,verticesLength-4,0,curveVertices),this._computeVertices(0,2,verticesLength-4,curveVertices),curveVertices[verticesLength-2]=curveVertices[0],curveVertices[verticesLength-1]=curveVertices[1]):(curveCount--,verticesLength-=4,curveVertices.length=verticesLength,this._computeVertices(2,verticesLength,0,curveVertices));var curves=new Array(curveCount);pathLength=0;for(var x1=curveVertices[0],y1=curveVertices[1],cx1=0,cy1=0,cx2=0,cy2=0,x2=0,y2=0,tmpx,tmpy,dddfx,dddfy,ddfx,ddfy,dfx,dfy,i=0,w=2;i<curveCount;i++,w+=6)cx1=curveVertices[w],cy1=curveVertices[w+1],cx2=curveVertices[w+2],cy2=curveVertices[w+3],ddfx=2*(tmpx=.1875*(x1-2*cx1+cx2))+(dddfx=.09375*(3*(cx1-cx2)-x1+(x2=curveVertices[w+4]))),ddfy=2*(tmpy=.1875*(y1-2*cy1+cy2))+(dddfy=.09375*(3*(cy1-cy2)-y1+(y2=curveVertices[w+5]))),dfx=.75*(cx1-x1)+tmpx+.16666667*dddfx,dfy=.75*(cy1-y1)+tmpy+.16666667*dddfy,pathLength+=Math.sqrt(dfx*dfx+dfy*dfy),dfx+=ddfx,dfy+=ddfy,ddfx+=dddfx,ddfy+=dddfy,pathLength+=Math.sqrt(dfx*dfx+dfy*dfy),dfx+=ddfx,dfy+=ddfy,pathLength+=Math.sqrt(dfx*dfx+dfy*dfy),dfx+=ddfx+dddfx,dfy+=ddfy+dddfy,pathLength+=Math.sqrt(dfx*dfx+dfy*dfy),curves[i]=pathLength,x1=x2,y1=y2;if(percentPosition&&(position*=pathLength),percentSpacing)for(var i=0;i<spaceCount;i++)spaces[i]*=pathLength;for(var segments=this._segments,curveLength=0,i=0,o=0,curve=0,segment=0;i<spaceCount;i++,o+=3){var space,p=position+=space=spaces[i];if(isClosed)(p%=pathLength)<0&&(p+=pathLength),curve=0;else{if(p<0)continue;if(p>pathLength)continue}for(;;curve++){var length_1=curves[curve];if(!(p>length_1)){var prev;if(0===curve)p/=length_1;else p=(p-(prev=curves[curve-1]))/(length_1-prev);break}}if(curve!==preCurve){preCurve=curve;var ii=6*curve;for(x1=curveVertices[ii],y1=curveVertices[ii+1],cx1=curveVertices[ii+2],cy1=curveVertices[ii+3],cx2=curveVertices[ii+4],cy2=curveVertices[ii+5],ddfx=2*(tmpx=.03*(x1-2*cx1+cx2))+(dddfx=.006*(3*(cx1-cx2)-x1+(x2=curveVertices[ii+6]))),ddfy=2*(tmpy=.03*(y1-2*cy1+cy2))+(dddfy=.006*(3*(cy1-cy2)-y1+(y2=curveVertices[ii+7]))),dfx=.3*(cx1-x1)+tmpx+.16666667*dddfx,dfy=.3*(cy1-y1)+tmpy+.16666667*dddfy,curveLength=Math.sqrt(dfx*dfx+dfy*dfy),segments[0]=curveLength,ii=1;ii<8;ii++)dfx+=ddfx,dfy+=ddfy,ddfx+=dddfx,ddfy+=dddfy,curveLength+=Math.sqrt(dfx*dfx+dfy*dfy),segments[ii]=curveLength;dfx+=ddfx,dfy+=ddfy,curveLength+=Math.sqrt(dfx*dfx+dfy*dfy),segments[8]=curveLength,dfx+=ddfx+dddfx,dfy+=ddfy+dddfy,curveLength+=Math.sqrt(dfx*dfx+dfy*dfy),segments[9]=curveLength,segment=0}for(p*=curveLength;;segment++){var length_2=segments[segment];if(!(p>length_2)){var prev;if(0===segment)p/=length_2;else p=segment+(p-(prev=segments[segment-1]))/(length_2-prev);break}}this.addCurvePosition(.1*p,x1,y1,cx1,cy1,cx2,cy2,x2,y2,positions,o,tangents)}}else{var lenghts=pathDisplayDta.curveLengths;if(pathLength=lenghts[curveCount-=isClosed?1:2],percentPosition&&(position*=pathLength),percentSpacing)for(var i=0;i<spaceCount;i++)spaces[i]*=pathLength;curveVertices.length=8;for(var i=0,o=0,curve=0;i<spaceCount;i++,o+=3){var space;if(position+=space=spaces[i],isClosed)(position%=pathLength)<0&&(position+=pathLength),curve=0;else{if(position<0)continue;if(position>pathLength)continue}for(var percent=0;;curve++){var len=lenghts[curve];if(!(position>len)){if(0===curve)percent=position/len;else{var preLen=lenghts[curve-1];percent=(position-preLen)/(len-preLen)}break}}curve!==preCurve&&(preCurve=curve,isClosed&&curve===curveCount?(this._computeVertices(verticesLength-4,4,0,curveVertices),this._computeVertices(0,4,4,curveVertices)):this._computeVertices(6*curve+2,8,0,curveVertices)),this.addCurvePosition(percent,curveVertices[0],curveVertices[1],curveVertices[2],curveVertices[3],curveVertices[4],curveVertices[5],curveVertices[6],curveVertices[7],positions,o,tangents)}}},PathConstraint.prototype.addCurvePosition=function(t,x1,y1,cx1,cy1,cx2,cy2,x2,y2,out,offset,tangents){if(0===t)return out[offset]=x1,out[offset+1]=y1,void(out[offset+2]=0);if(1===t)return out[offset]=x2,out[offset+1]=y2,void(out[offset+2]=0);var mt=1-t,mt2=mt*mt,t2=t*t,a=mt2*mt,b=mt2*t*3,c=mt*t2*3,d=t*t2,x=a*x1+b*cx1+c*cx2+d*x2,y=a*y1+b*cy1+c*cy2+d*y2;out[offset]=x,out[offset+1]=y,out[offset+2]=tangents?Math.atan2(y-(a*y1+b*cy1+c*cy2),x-(a*x1+b*cx1+c*cx2)):0},PathConstraint.prototype.init=function(constraintData,armature){this._constraintData=constraintData,this._armature=armature;var data=constraintData;this.pathOffset=data.pathDisplayData.geometry.offset,this.position=data.position,this.spacing=data.spacing,this.rotateOffset=data.rotateOffset,this.rotateMix=data.rotateMix,this.translateMix=data.translateMix,this._root=this._armature.getBone(data.root.name),this._target=this._armature.getBone(data.target.name),this._pathSlot=this._armature.getSlot(data.pathSlot.name);for(var i=0,l=data.bones.length;i<l;i++){var bone=this._armature.getBone(data.bones[i].name);null!==bone&&this._bones.push(bone)}2===data.rotateMode&&(this._boneLengths.length=this._bones.length),this._root._hasConstraint=!0},PathConstraint.prototype.update=function(){var pathSlot=this._pathSlot;if(null!==pathSlot._geometryData&&pathSlot._geometryData.offset===this.pathOffset){var constraintData=this._constraintData,isPathVerticeDirty=!1;if(this._root._childrenTransformDirty?(this._updatePathVertices(pathSlot._geometryData),isPathVerticeDirty=!0):(pathSlot._verticesDirty||pathSlot._isBonesUpdate())&&(this._updatePathVertices(pathSlot._geometryData),pathSlot._verticesDirty=!1,isPathVerticeDirty=!0),isPathVerticeDirty||this.dirty){var positionMode=constraintData.positionMode,spacingMode=constraintData.spacingMode,rotateMode=constraintData.rotateMode,bones=this._bones,isLengthMode=0===spacingMode,isChainScaleMode=2===rotateMode,isTangentMode=0===rotateMode,boneCount=bones.length,spacesCount=isTangentMode?boneCount:boneCount+1,spacing=this.spacing,spaces=this._spaces;if(spaces.length=spacesCount,isChainScaleMode||isLengthMode){spaces[0]=0;for(var i=0,l=spacesCount-1;i<l;i++){var bone;(bone=bones[i]).updateByConstraint();var boneLength=bone._boneData.length,matrix,x=boneLength*(matrix=bone.globalTransformMatrix).a,y=boneLength*matrix.b,len=Math.sqrt(x*x+y*y);isChainScaleMode&&(this._boneLengths[i]=len),spaces[i+1]=(boneLength+spacing)*len/boneLength}}else for(var i=0;i<spacesCount;i++)spaces[i]=spacing;this._computeBezierCurve(pathSlot._displayFrame.rawDisplayData,spacesCount,isTangentMode,1===positionMode,2===spacingMode);var positions=this._positions,rotateOffset=this.rotateOffset,boneX=positions[0],boneY=positions[1],tip,bone,matrix;if(0===rotateOffset)tip=1===rotateMode;else if(tip=!1,null!==(bone=pathSlot.parent))rotateOffset*=(matrix=bone.globalTransformMatrix).a*matrix.d-matrix.b*matrix.c>0?dragonBones.Transform.DEG_RAD:-dragonBones.Transform.DEG_RAD;for(var rotateMix=this.rotateMix,translateMix=this.translateMix,i=0,p=3;i<boneCount;i++,p+=3){var bone,matrix;(bone=bones[i]).updateByConstraint(),(matrix=bone.globalTransformMatrix).tx+=(boneX-matrix.tx)*translateMix,matrix.ty+=(boneY-matrix.ty)*translateMix;var x,y,dx=(x=positions[p])-boneX,dy=(y=positions[p+1])-boneY;if(isChainScaleMode){var lenght=this._boneLengths[i],s=(Math.sqrt(dx*dx+dy*dy)/lenght-1)*rotateMix+1;matrix.a*=s,matrix.b*=s}if(boneX=x,boneY=y,rotateMix>0){var a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d,r=void 0,cos=void 0,sin=void 0;if(r=isTangentMode?positions[p-1]:Math.atan2(dy,dx),r-=Math.atan2(b,a),tip){cos=Math.cos(r),sin=Math.sin(r);var length_3=bone._boneData.length;boneX+=(length_3*(cos*a-sin*b)-dx)*rotateMix,boneY+=(length_3*(sin*a+cos*b)-dy)*rotateMix}else r+=rotateOffset;r>dragonBones.Transform.PI?r-=dragonBones.Transform.PI_D:r<-dragonBones.Transform.PI&&(r+=dragonBones.Transform.PI_D),r*=rotateMix,cos=Math.cos(r),sin=Math.sin(r),matrix.a=cos*a-sin*b,matrix.b=sin*a+cos*b,matrix.c=cos*c-sin*d,matrix.d=sin*c+cos*d}bone.global.fromMatrix(matrix)}this.dirty=!1}}},PathConstraint.prototype.invalidUpdate=function(){},PathConstraint}(Constraint);dragonBones.PathConstraint=PathConstraint}(dragonBones||(dragonBones={})),function(dragonBones){var WorldClock=function(){function WorldClock(time){void 0===time&&(time=0),this.time=0,this.timeScale=1,this._systemTime=0,this._animatebles=[],this._clock=null,this.time=time,this._systemTime=.001*(new Date).getTime()}return WorldClock.prototype.advanceTime=function(passedTime){passedTime!=passedTime&&(passedTime=0);var currentTime=.001*Date.now();if(passedTime<0&&(passedTime=currentTime-this._systemTime),this._systemTime=currentTime,1!==this.timeScale&&(passedTime*=this.timeScale),0!==passedTime){passedTime<0?this.time-=passedTime:this.time+=passedTime;for(var i=0,r=0,l=this._animatebles.length;i<l;++i){var animatable=this._animatebles[i];null!==animatable?(r>0&&(this._animatebles[i-r]=animatable,this._animatebles[i]=null),animatable.advanceTime(passedTime)):r++}if(r>0){for(l=this._animatebles.length;i<l;++i){var animateble=this._animatebles[i];null!==animateble?this._animatebles[i-r]=animateble:r++}this._animatebles.length-=r}}},WorldClock.prototype.contains=function(value){if(value===this)return!1;for(var ancestor=value;ancestor!==this&&null!==ancestor;)ancestor=ancestor.clock;return ancestor===this},WorldClock.prototype.add=function(value){this._animatebles.indexOf(value)<0&&(this._animatebles.push(value),value.clock=this)},WorldClock.prototype.remove=function(value){var index=this._animatebles.indexOf(value);index>=0&&(this._animatebles[index]=null,value.clock=null)},WorldClock.prototype.clear=function(){for(var _i=0,_a=this._animatebles;_i<_a.length;_i++){var animatable=_a[_i];null!==animatable&&(animatable.clock=null)}},Object.defineProperty(WorldClock.prototype,"clock",{get:function(){return this._clock},set:function(value){this._clock!==value&&(null!==this._clock&&this._clock.remove(this),this._clock=value,null!==this._clock&&this._clock.add(this))},enumerable:!0,configurable:!0}),WorldClock}();dragonBones.WorldClock=WorldClock}(dragonBones||(dragonBones={})),function(dragonBones){var Animation=function(_super){function Animation(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._animationNames=[],_this._animationStates=[],_this._animations={},_this._blendStates={},_this._animationConfig=null,_this}return __extends(Animation,_super),Animation.toString=function(){return"[class dragonBones.Animation]"},Animation.prototype._onClear=function(){for(var _i=0,_a=this._animationStates;_i<_a.length;_i++){var animationState;_a[_i].returnToPool()}for(var k in this._animations)delete this._animations[k];for(var k in this._blendStates){var blendStates=this._blendStates[k];for(var kB in blendStates)blendStates[kB].returnToPool();delete this._blendStates[k]}null!==this._animationConfig&&this._animationConfig.returnToPool(),this.timeScale=1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null},Animation.prototype._fadeOut=function(animationConfig){switch(animationConfig.fadeOutMode){case 1:for(var _i=0,_a=this._animationStates;_i<_a.length;_i++){var animationState;null===(animationState=_a[_i])._parent&&(animationState.layer===animationConfig.layer&&animationState.fadeOut(animationConfig.fadeOutTime,animationConfig.pauseFadeOut))}break;case 2:for(var _b=0,_c=this._animationStates;_b<_c.length;_b++){var animationState;null===(animationState=_c[_b])._parent&&(animationState.group===animationConfig.group&&animationState.fadeOut(animationConfig.fadeOutTime,animationConfig.pauseFadeOut))}break;case 3:for(var _d=0,_e=this._animationStates;_d<_e.length;_d++){var animationState;null===(animationState=_e[_d])._parent&&(animationState.layer===animationConfig.layer&&animationState.group===animationConfig.group&&animationState.fadeOut(animationConfig.fadeOutTime,animationConfig.pauseFadeOut))}break;case 4:for(var _f=0,_g=this._animationStates;_f<_g.length;_f++){var animationState;null===(animationState=_g[_f])._parent&&animationState.fadeOut(animationConfig.fadeOutTime,animationConfig.pauseFadeOut)}}},Animation.prototype.init=function(armature){null===this._armature&&(this._armature=armature,this._animationConfig=dragonBones.BaseObject.borrowObject(dragonBones.AnimationConfig))},Animation.prototype.advanceTime=function(passedTime){for(var k in passedTime<0&&(passedTime=-passedTime),this._armature.inheritAnimation&&null!==this._armature._parent?this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale:this._inheritTimeScale=this.timeScale,1!==this._inheritTimeScale&&(passedTime*=this._inheritTimeScale),this._blendStates){var blendStates=this._blendStates[k];for(var kB in blendStates)blendStates[kB].reset()}var animationStateCount=this._animationStates.length,animationState;if(1===animationStateCount)if((animationState=this._animationStates[0])._fadeState>0&&animationState._subFadeState>0)this._armature._dragonBones.bufferObject(animationState),this._animationStates.length=0,this._lastAnimationState=null;else{var animationData=animationState.animationData,cacheFrameRate=animationData.cacheFrameRate;if(this._animationDirty&&cacheFrameRate>0){this._animationDirty=!1;for(var _i=0,_a=this._armature.getBones();_i<_a.length;_i++){var bone=_a[_i];bone._cachedFrameIndices=animationData.getBoneCachedFrameIndices(bone.name)}for(var _b=0,_c=this._armature.getSlots();_b<_c.length;_b++){var slot=_c[_b];if(slot.displayFrameCount>0){var rawDisplayData=slot.getDisplayFrameAt(0).rawDisplayData;if(null!==rawDisplayData&&rawDisplayData.parent===this._armature.armatureData.defaultSkin){slot._cachedFrameIndices=animationData.getSlotCachedFrameIndices(slot.name);continue}}slot._cachedFrameIndices=null}}animationState.advanceTime(passedTime,cacheFrameRate)}else if(animationStateCount>1){for(var i=0,r=0;i<animationStateCount;++i){var animationState;(animationState=this._animationStates[i])._fadeState>0&&animationState._subFadeState>0?(r++,this._armature._dragonBones.bufferObject(animationState),this._animationDirty=!0,this._lastAnimationState===animationState&&(this._lastAnimationState=null)):(r>0&&(this._animationStates[i-r]=animationState),animationState.advanceTime(passedTime,0)),i===animationStateCount-1&&r>0&&(this._animationStates.length-=r,null===this._lastAnimationState&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1},Animation.prototype.reset=function(){for(var _i=0,_a=this._animationStates;_i<_a.length;_i++){var animationState;_a[_i].returnToPool()}this._animationDirty=!1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},Animation.prototype.stop=function(animationName){var animationState;if(void 0===animationName&&(animationName=null),null!==animationName)null!==(animationState=this.getState(animationName))&&animationState.stop();else for(var _i=0,_a=this._animationStates;_i<_a.length;_i++){var animationState;(animationState=_a[_i]).stop()}},Animation.prototype.playConfig=function(animationConfig){var animationName=animationConfig.animation;if(!(animationName in this._animations))return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+animationName),null;var animationData=this._animations[animationName];if(5===animationConfig.fadeOutMode)for(var _i=0,_a=this._animationStates;_i<_a.length;_i++){var animationState_1=_a[_i];if(animationState_1._fadeState<1&&animationState_1.layer===animationConfig.layer&&animationState_1.animationData===animationData)return animationState_1}0===this._animationStates.length?animationConfig.fadeInTime=0:animationConfig.fadeInTime<0&&(animationConfig.fadeInTime=animationData.fadeInTime),animationConfig.fadeOutTime<0&&(animationConfig.fadeOutTime=animationConfig.fadeInTime),animationConfig.timeScale<=-100&&(animationConfig.timeScale=1/animationData.scale),animationData.frameCount>0?(animationConfig.position<0?(animationConfig.position%=animationData.duration,animationConfig.position=animationData.duration-animationConfig.position):animationConfig.position===animationData.duration?animationConfig.position-=1e-6:animationConfig.position>animationData.duration&&(animationConfig.position%=animationData.duration),animationConfig.duration>0&&animationConfig.position+animationConfig.duration>animationData.duration&&(animationConfig.duration=animationData.duration-animationConfig.position),animationConfig.playTimes<0&&(animationConfig.playTimes=animationData.playTimes)):(animationConfig.playTimes=1,animationConfig.position=0,animationConfig.duration>0&&(animationConfig.duration=0)),0===animationConfig.duration&&(animationConfig.duration=-1),this._fadeOut(animationConfig);var animationState=dragonBones.BaseObject.borrowObject(dragonBones.AnimationState);if(animationState.init(this._armature,animationData,animationConfig),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,this._animationStates.length>0){for(var added=!1,i=0,l=this._animationStates.length;i<l;++i){if(animationState.layer>this._animationStates[i].layer){added=!0,this._animationStates.splice(i,0,animationState);break}if(i!==l-1&&animationState.layer>this._animationStates[i+1].layer){added=!0,this._animationStates.splice(i+1,0,animationState);break}}added||this._animationStates.push(animationState)}else this._animationStates.push(animationState);for(var _b=0,_c=this._armature.getSlots();_b<_c.length;_b++){var slot,childArmature=_c[_b].childArmature;null!==childArmature&&childArmature.inheritAnimation&&childArmature.animation.hasAnimation(animationName)&&null===childArmature.animation.getState(animationName)&&childArmature.animation.fadeIn(animationName)}for(var k in animationData.animationTimelines){var childAnimationState=this.fadeIn(k,0,1,animationState.layer,"",5);if(null!==childAnimationState){var timelines=animationData.animationTimelines[k];childAnimationState.actionEnabled=!1,childAnimationState.resetToPose=!1,childAnimationState.stop(),animationState.addState(childAnimationState,timelines);var index=this._animationStates.indexOf(animationState),childIndex=this._animationStates.indexOf(childAnimationState);childIndex<index&&(this._animationStates.splice(index,1),this._animationStates.splice(childIndex,0,animationState))}}return this._lastAnimationState=animationState,animationState},Animation.prototype.play=function(animationName,playTimes){if(void 0===animationName&&(animationName=null),void 0===playTimes&&(playTimes=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=playTimes,this._animationConfig.fadeInTime=0,this._animationConfig.animation=null!==animationName?animationName:"",null!==animationName&&animationName.length>0)this.playConfig(this._animationConfig);else if(null===this._lastAnimationState){var defaultAnimation=this._armature.armatureData.defaultAnimation;null!==defaultAnimation&&(this._animationConfig.animation=defaultAnimation.name,this.playConfig(this._animationConfig))}else this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted?(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig)):this._lastAnimationState.play();return this._lastAnimationState},Animation.prototype.fadeIn=function(animationName,fadeInTime,playTimes,layer,group,fadeOutMode){return void 0===fadeInTime&&(fadeInTime=-1),void 0===playTimes&&(playTimes=-1),void 0===layer&&(layer=0),void 0===group&&(group=null),void 0===fadeOutMode&&(fadeOutMode=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=fadeOutMode,this._animationConfig.playTimes=playTimes,this._animationConfig.layer=layer,this._animationConfig.fadeInTime=fadeInTime,this._animationConfig.animation=animationName,this._animationConfig.group=null!==group?group:"",this.playConfig(this._animationConfig)},Animation.prototype.gotoAndPlayByTime=function(animationName,time,playTimes){return void 0===time&&(time=0),void 0===playTimes&&(playTimes=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=playTimes,this._animationConfig.position=time,this._animationConfig.fadeInTime=0,this._animationConfig.animation=animationName,this.playConfig(this._animationConfig)},Animation.prototype.gotoAndPlayByFrame=function(animationName,frame,playTimes){void 0===frame&&(frame=0),void 0===playTimes&&(playTimes=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=playTimes,this._animationConfig.fadeInTime=0,this._animationConfig.animation=animationName;var animationData=animationName in this._animations?this._animations[animationName]:null;return null!==animationData&&(this._animationConfig.position=animationData.frameCount>0?animationData.duration*frame/animationData.frameCount:0),this.playConfig(this._animationConfig)},Animation.prototype.gotoAndPlayByProgress=function(animationName,progress,playTimes){void 0===progress&&(progress=0),void 0===playTimes&&(playTimes=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=playTimes,this._animationConfig.fadeInTime=0,this._animationConfig.animation=animationName;var animationData=animationName in this._animations?this._animations[animationName]:null;return null!==animationData&&(this._animationConfig.position=animationData.duration*(progress>0?progress:0)),this.playConfig(this._animationConfig)},Animation.prototype.gotoAndStopByTime=function(animationName,time){void 0===time&&(time=0);var animationState=this.gotoAndPlayByTime(animationName,time,1);return null!==animationState&&animationState.stop(),animationState},Animation.prototype.gotoAndStopByFrame=function(animationName,frame){void 0===frame&&(frame=0);var animationState=this.gotoAndPlayByFrame(animationName,frame,1);return null!==animationState&&animationState.stop(),animationState},Animation.prototype.gotoAndStopByProgress=function(animationName,progress){void 0===progress&&(progress=0);var animationState=this.gotoAndPlayByProgress(animationName,progress,1);return null!==animationState&&animationState.stop(),animationState},Animation.prototype.getBlendState=function(type,name,target){type in this._blendStates||(this._blendStates[type]={});var blendStates=this._blendStates[type],blendState;name in blendStates||((blendStates[name]=dragonBones.BaseObject.borrowObject(dragonBones.BlendState)).target=target);return blendStates[name]},Animation.prototype.getState=function(animationName,layer){void 0===layer&&(layer=-1);for(var i=this._animationStates.length;i--;){var animationState=this._animationStates[i];if(animationState.name===animationName&&(layer<0||animationState.layer===layer))return animationState}return null},Animation.prototype.hasAnimation=function(animationName){return animationName in this._animations},Animation.prototype.getStates=function(){return this._animationStates},Object.defineProperty(Animation.prototype,"isPlaying",{get:function(){for(var _i=0,_a=this._animationStates;_i<_a.length;_i++){var animationState;if(_a[_i].isPlaying)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"isCompleted",{get:function(){for(var _i=0,_a=this._animationStates;_i<_a.length;_i++){var animationState;if(!_a[_i].isCompleted)return!1}return this._animationStates.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"lastAnimationName",{get:function(){return null!==this._lastAnimationState?this._lastAnimationState.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"animations",{get:function(){return this._animations},set:function(value){if(this._animations!==value){for(var k in this._animationNames.length=0,this._animations)delete this._animations[k];for(var k in value)this._animationNames.push(k),this._animations[k]=value[k]}},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),Animation}(dragonBones.BaseObject);dragonBones.Animation=Animation}(dragonBones||(dragonBones={})),function(dragonBones){var AnimationState=function(_super){function AnimationState(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._boneMask=[],_this._boneTimelines=[],_this._boneBlendTimelines=[],_this._slotTimelines=[],_this._slotBlendTimelines=[],_this._constraintTimelines=[],_this._animationTimelines=[],_this._poseTimelines=[],_this._actionTimeline=null,_this._zOrderTimeline=null,_this}return __extends(AnimationState,_super),AnimationState.toString=function(){return"[class dragonBones.AnimationState]"},AnimationState.prototype._onClear=function(){for(var _i=0,_a=this._boneTimelines;_i<_a.length;_i++){var timeline;(timeline=_a[_i]).returnToPool()}for(var _b=0,_c=this._boneBlendTimelines;_b<_c.length;_b++){var timeline;(timeline=_c[_b]).returnToPool()}for(var _d=0,_e=this._slotTimelines;_d<_e.length;_d++){var timeline;(timeline=_e[_d]).returnToPool()}for(var _f=0,_g=this._slotBlendTimelines;_f<_g.length;_f++){var timeline;(timeline=_g[_f]).returnToPool()}for(var _h=0,_j=this._constraintTimelines;_h<_j.length;_h++){var timeline;(timeline=_j[_h]).returnToPool()}for(var _k=0,_l=this._animationTimelines;_k<_l.length;_k++){var timeline,animationState=(timeline=_l[_k]).target;animationState._parent===this&&(animationState._fadeState=1,animationState._subFadeState=1,animationState._parent=null),timeline.returnToPool()}null!==this._actionTimeline&&this._actionTimeline.returnToPool(),null!==this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additive=!1,this.displayControl=!1,this.resetToPose=!1,this.blendType=0,this.playTimes=1,this.layer=0,this.timeScale=1,this._weight=1,this.parameterX=0,this.parameterY=0,this.positionX=0,this.positionY=0,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=2,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._boneMask.length=0,this._boneTimelines.length=0,this._boneBlendTimelines.length=0,this._slotTimelines.length=0,this._slotBlendTimelines.length=0,this._constraintTimelines.length=0,this._animationTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null,this._activeChildA=null,this._activeChildB=null,this._parent=null},AnimationState.prototype._updateTimelines=function(){for(var _i=0,_a=this._armature._constraints;_i<_a.length;_i++){var constraint=_a[_i],timelineDatas=this._animationData.getConstraintTimelines(constraint.name);if(null!==timelineDatas)for(var _b=0,timelineDatas_1=timelineDatas;_b<timelineDatas_1.length;_b++){var timelineData=timelineDatas_1[_b];switch(timelineData.type){case 30:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.IKConstraintTimelineState)).target=constraint,timeline.init(this._armature,this,timelineData),this._constraintTimelines.push(timeline)}}else if(this.resetToPose){var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.IKConstraintTimelineState)).target=constraint,timeline.init(this._armature,this,null),this._constraintTimelines.push(timeline),this._poseTimelines.push(timeline)}}},AnimationState.prototype._updateBoneAndSlotTimelines=function(){for(var boneTimelines={},_i=0,_a=this._boneTimelines;_i<_a.length;_i++){var timeline,timelineName;(timelineName=(timeline=_a[_i]).target.target.name)in boneTimelines||(boneTimelines[timelineName]=[]),boneTimelines[timelineName].push(timeline)}for(var _b=0,_c=this._boneBlendTimelines;_b<_c.length;_b++){var timeline,timelineName;(timelineName=(timeline=_c[_b]).target.target.name)in boneTimelines||(boneTimelines[timelineName]=[]),boneTimelines[timelineName].push(timeline)}for(var _d=0,_e=this._armature.getBones();_d<_e.length;_d++){var bone=_e[_d],timelineName=bone.name;if(this.containsBoneMask(timelineName))if(timelineName in boneTimelines)delete boneTimelines[timelineName];else{var timelineDatas=this._animationData.getBoneTimelines(timelineName),blendState=this._armature.animation.getBlendState(BlendState.BONE_TRANSFORM,bone.name,bone);if(null!==timelineDatas)for(var _f=0,timelineDatas_2=timelineDatas;_f<timelineDatas_2.length;_f++){var timelineData;switch((timelineData=timelineDatas_2[_f]).type){case 10:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.BoneAllTimelineState)).target=blendState,timeline.init(this._armature,this,timelineData),this._boneTimelines.push(timeline);break;case 11:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.BoneTranslateTimelineState)).target=blendState,timeline.init(this._armature,this,timelineData),this._boneTimelines.push(timeline);break;case 12:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.BoneRotateTimelineState)).target=blendState,timeline.init(this._armature,this,timelineData),this._boneTimelines.push(timeline);break;case 13:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.BoneScaleTimelineState)).target=blendState,timeline.init(this._armature,this,timelineData),this._boneTimelines.push(timeline);break;case 60:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.AlphaTimelineState)).target=this._armature.animation.getBlendState(BlendState.BONE_ALPHA,bone.name,bone),timeline.init(this._armature,this,timelineData),this._boneBlendTimelines.push(timeline);break;case 50:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.SurfaceTimelineState)).target=this._armature.animation.getBlendState(BlendState.SURFACE,bone.name,bone),timeline.init(this._armature,this,timelineData),this._boneBlendTimelines.push(timeline)}}else if(this.resetToPose){var timeline,timeline;if(0===bone._boneData.type)(timeline=dragonBones.BaseObject.borrowObject(dragonBones.BoneAllTimelineState)).target=blendState,timeline.init(this._armature,this,null),this._boneTimelines.push(timeline),this._poseTimelines.push(timeline);else(timeline=dragonBones.BaseObject.borrowObject(dragonBones.SurfaceTimelineState)).target=this._armature.animation.getBlendState(BlendState.SURFACE,bone.name,bone),timeline.init(this._armature,this,null),this._boneBlendTimelines.push(timeline),this._poseTimelines.push(timeline)}}}for(var k in boneTimelines)for(var _g=0,_h=boneTimelines[k];_g<_h.length;_g++){var timeline=_h[_g],index;(index=this._boneTimelines.indexOf(timeline))>=0&&(this._boneTimelines.splice(index,1),timeline.returnToPool()),(index=this._boneBlendTimelines.indexOf(timeline))>=0&&(this._boneBlendTimelines.splice(index,1),timeline.returnToPool())}for(var slotTimelines={},ffdFlags=[],_j=0,_k=this._slotTimelines;_j<_k.length;_j++){var timeline,timelineName;(timelineName=(timeline=_k[_j]).target.name)in slotTimelines||(slotTimelines[timelineName]=[]),slotTimelines[timelineName].push(timeline)}for(var _l=0,_m=this._slotBlendTimelines;_l<_m.length;_l++){var timeline,timelineName;(timelineName=(timeline=_m[_l]).target.target.name)in slotTimelines||(slotTimelines[timelineName]=[]),slotTimelines[timelineName].push(timeline)}for(var _o=0,_p=this._armature.getSlots();_o<_p.length;_o++){var slot=_p[_o],boneName=slot.parent.name,timelineName;if(this.containsBoneMask(boneName))if((timelineName=slot.name)in slotTimelines)delete slotTimelines[timelineName];else{var displayIndexFlag=!1,colorFlag=!1,timelineDatas;if(ffdFlags.length=0,null!==(timelineDatas=this._animationData.getSlotTimelines(timelineName)))for(var _q=0,timelineDatas_3=timelineDatas;_q<timelineDatas_3.length;_q++){var timelineData;switch((timelineData=timelineDatas_3[_q]).type){case 20:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.SlotDisplayTimelineState)).target=slot,timeline.init(this._armature,this,timelineData),this._slotTimelines.push(timeline),displayIndexFlag=!0;break;case 23:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.SlotZIndexTimelineState)).target=this._armature.animation.getBlendState(BlendState.SLOT_Z_INDEX,slot.name,slot),timeline.init(this._armature,this,timelineData),this._slotBlendTimelines.push(timeline);break;case 21:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.SlotColorTimelineState)).target=slot,timeline.init(this._armature,this,timelineData),this._slotTimelines.push(timeline),colorFlag=!0;break;case 22:var dragonBonesData=this._animationData.parent.parent,timelineArray=dragonBonesData.timelineArray,frameIntOffset=this._animationData.frameIntOffset+timelineArray[timelineData.offset+3],frameIntArray,geometryOffset=dragonBonesData.frameIntArray[frameIntOffset+0];geometryOffset<0&&(geometryOffset+=65536);for(var i=0,l=slot.displayFrameCount;i<l;++i){var displayFrame,geometryData;if(null!==(geometryData=(displayFrame=slot.getDisplayFrameAt(i)).getGeometryData())&&geometryData.offset===geometryOffset){var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.DeformTimelineState)).target=this._armature.animation.getBlendState(BlendState.SLOT_DEFORM,displayFrame.rawDisplayData.name,slot),timeline.displayFrame=displayFrame,timeline.init(this._armature,this,timelineData),this._slotBlendTimelines.push(timeline),displayFrame.updateDeformVertices(),ffdFlags.push(geometryOffset);break}}break;case 24:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.AlphaTimelineState)).target=this._armature.animation.getBlendState(BlendState.SLOT_ALPHA,slot.name,slot),timeline.init(this._armature,this,timelineData),this._slotBlendTimelines.push(timeline)}}if(this.resetToPose){var timeline,timeline;if(!displayIndexFlag)(timeline=dragonBones.BaseObject.borrowObject(dragonBones.SlotDisplayTimelineState)).target=slot,timeline.init(this._armature,this,null),this._slotTimelines.push(timeline),this._poseTimelines.push(timeline);if(!colorFlag)(timeline=dragonBones.BaseObject.borrowObject(dragonBones.SlotColorTimelineState)).target=slot,timeline.init(this._armature,this,null),this._slotTimelines.push(timeline),this._poseTimelines.push(timeline);for(var i=0,l=slot.displayFrameCount;i<l;++i){var displayFrame,geometryData,timeline;if(0!==(displayFrame=slot.getDisplayFrameAt(i)).deformVertices.length)if(null!==(geometryData=displayFrame.getGeometryData())&&ffdFlags.indexOf(geometryData.offset)<0)(timeline=dragonBones.BaseObject.borrowObject(dragonBones.DeformTimelineState)).displayFrame=displayFrame,timeline.target=this._armature.animation.getBlendState(BlendState.SLOT_DEFORM,slot.name,slot),timeline.init(this._armature,this,null),this._slotBlendTimelines.push(timeline),this._poseTimelines.push(timeline)}}}}for(var k in slotTimelines)for(var _r=0,_s=slotTimelines[k];_r<_s.length;_r++){var timeline=_s[_r],index;(index=this._slotTimelines.indexOf(timeline))>=0&&(this._slotTimelines.splice(index,1),timeline.returnToPool()),(index=this._slotBlendTimelines.indexOf(timeline))>=0&&(this._slotBlendTimelines.splice(index,1),timeline.returnToPool())}},AnimationState.prototype._advanceFadeTime=function(passedTime){var isFadeOut=this._fadeState>0,eventActive,eventActive;if(this._subFadeState<0&&(this._subFadeState=0,eventActive=null===this._parent&&this.actionEnabled)){var eventType=isFadeOut?dragonBones.EventObject.FADE_OUT:dragonBones.EventObject.FADE_IN,eventObject;if(this._armature.eventDispatcher.hasDBEventListener(eventType))(eventObject=dragonBones.BaseObject.borrowObject(dragonBones.EventObject)).type=eventType,eventObject.armature=this._armature,eventObject.animationState=this,this._armature._dragonBones.bufferEvent(eventObject)}if((passedTime<0&&(passedTime=-passedTime),this._fadeTime+=passedTime,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=isFadeOut?0:1):this._fadeTime>0?this._fadeProgress=isFadeOut?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=isFadeOut?1:0,this._subFadeState>0)&&(isFadeOut||(this._playheadState|=1,this._fadeState=0),eventActive=null===this._parent&&this.actionEnabled)){var eventType=isFadeOut?dragonBones.EventObject.FADE_OUT_COMPLETE:dragonBones.EventObject.FADE_IN_COMPLETE,eventObject;if(this._armature.eventDispatcher.hasDBEventListener(eventType))(eventObject=dragonBones.BaseObject.borrowObject(dragonBones.EventObject)).type=eventType,eventObject.armature=this._armature,eventObject.animationState=this,this._armature._dragonBones.bufferEvent(eventObject)}},AnimationState.prototype.init=function(armature,animationData,animationConfig){if(null===this._armature){if(this._armature=armature,this._animationData=animationData,this.resetToPose=animationConfig.resetToPose,this.additive=animationConfig.additive,this.displayControl=animationConfig.displayControl,this.actionEnabled=animationConfig.actionEnabled,this.blendType=animationData.blendType,this.layer=animationConfig.layer,this.playTimes=animationConfig.playTimes,this.timeScale=animationConfig.timeScale,this.fadeTotalTime=animationConfig.fadeInTime,this.autoFadeOutTime=animationConfig.autoFadeOutTime,this.name=animationConfig.name.length>0?animationConfig.name:animationConfig.animation,this.group=animationConfig.group,this._weight=animationConfig.weight,animationConfig.pauseFadeIn?this._playheadState=2:this._playheadState=3,animationConfig.duration<0?(this._position=0,this._duration=this._animationData.duration,0!==animationConfig.position?this.timeScale>=0?this._time=animationConfig.position:this._time=animationConfig.position-this._duration:this._time=0):(this._position=animationConfig.position,this._duration=animationConfig.duration,this._time=0),this.timeScale<0&&0===this._time&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),animationConfig.boneMask.length>0){this._boneMask.length=animationConfig.boneMask.length;for(var i=0,l=this._boneMask.length;i<l;++i)this._boneMask[i]=animationConfig.boneMask[i]}this._actionTimeline=dragonBones.BaseObject.borrowObject(dragonBones.ActionTimelineState),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),null!==this._animationData.zOrderTimeline&&(this._zOrderTimeline=dragonBones.BaseObject.borrowObject(dragonBones.ZOrderTimelineState),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}},AnimationState.prototype.advanceTime=function(passedTime,cacheFrameRate){0===this._fadeState&&0===this._subFadeState||this._advanceFadeTime(passedTime),3===this._playheadState&&(1!==this.timeScale&&(passedTime*=this.timeScale),this._time+=passedTime),0!==this._timelineDirty&&(2===this._timelineDirty&&this._updateTimelines(),this._timelineDirty=0,this._updateBoneAndSlotTimelines());var isBlendDirty=0!==this._fadeState||0===this._subFadeState,isCacheEnabled=0===this._fadeState&&cacheFrameRate>0,isUpdateTimeline=!0,isUpdateBoneTimeline=!0,time=this._time;if(this._weightResult=this._weight*this._fadeProgress,null!==this._parent&&(this._weightResult*=this._parent._weightResult),this._actionTimeline.playState<=0&&this._actionTimeline.update(time),0!==this._weight){if(isCacheEnabled){var internval=2*cacheFrameRate;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*internval)/internval}if(null!==this._zOrderTimeline&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(time),isCacheEnabled){var cacheFrameIndex=Math.floor(this._actionTimeline.currentTime*cacheFrameRate);this._armature._cacheFrameIndex===cacheFrameIndex?(isUpdateTimeline=!1,isUpdateBoneTimeline=!1):(this._armature._cacheFrameIndex=cacheFrameIndex,this._animationData.cachedFrames[cacheFrameIndex]?isUpdateBoneTimeline=!1:this._animationData.cachedFrames[cacheFrameIndex]=!0)}if(isUpdateTimeline){var isBlend=!1,prevTarget=null;if(isUpdateBoneTimeline)for(var i=0,l=this._boneTimelines.length;i<l;++i){var timeline,blendState;if((timeline=this._boneTimelines[i]).playState<=0&&timeline.update(time),timeline.target!==prevTarget)if(isBlend=(blendState=timeline.target).update(this),prevTarget=blendState,1===blendState.dirty){var pose=blendState.target.animationPose;pose.x=0,pose.y=0,pose.rotation=0,pose.skew=0,pose.scaleX=1,pose.scaleY=1}isBlend&&timeline.blend(isBlendDirty)}for(var i=0,l=this._boneBlendTimelines.length;i<l;++i){var timeline;(timeline=this._boneBlendTimelines[i]).playState<=0&&timeline.update(time),timeline.target.update(this)&&timeline.blend(isBlendDirty)}if(this.displayControl)for(var i=0,l=this._slotTimelines.length;i<l;++i){var timeline;if((timeline=this._slotTimelines[i]).playState<=0){var slot,displayController=timeline.target.displayController;null!==displayController&&displayController!==this.name&&displayController!==this.group||timeline.update(time)}}for(var i=0,l=this._slotBlendTimelines.length;i<l;++i){var timeline;if((timeline=this._slotBlendTimelines[i]).playState<=0){var blendState=timeline.target;timeline.update(time),blendState.update(this)&&timeline.blend(isBlendDirty)}}for(var i=0,l=this._constraintTimelines.length;i<l;++i){var timeline;(timeline=this._constraintTimelines[i]).playState<=0&&timeline.update(time)}if(this._animationTimelines.length>0){for(var dL=100,dR=100,leftState=null,rightState=null,i=0,l=this._animationTimelines.length;i<l;++i){var timeline;if((timeline=this._animationTimelines[i]).playState<=0&&timeline.update(time),1===this.blendType){var animationState=timeline.target,d=this.parameterX-animationState.positionX;d>=0?d<dL&&(dL=d,leftState=animationState):-d<dR&&(dR=-d,rightState=animationState)}}null!==leftState&&(this._activeChildA!==leftState&&(null!==this._activeChildA&&(this._activeChildA.weight=0),this._activeChildA=leftState,this._activeChildA.activeTimeline()),this._activeChildB!==rightState&&(null!==this._activeChildB&&(this._activeChildB.weight=0),this._activeChildB=rightState),leftState.weight=dR/(dL+dR),rightState&&(rightState.weight=1-leftState.weight))}}if(0===this._fadeState){if(this._subFadeState>0&&(this._subFadeState=0,this._poseTimelines.length>0)){for(var _i=0,_a=this._poseTimelines;_i<_a.length;_i++){var timeline=_a[_i],index=this._boneTimelines.indexOf(timeline);index>=0?(this._boneTimelines.splice(index,1),timeline.returnToPool()):(index=this._boneBlendTimelines.indexOf(timeline))>=0?(this._boneBlendTimelines.splice(index,1),timeline.returnToPool()):(index=this._slotTimelines.indexOf(timeline))>=0?(this._slotTimelines.splice(index,1),timeline.returnToPool()):(index=this._slotBlendTimelines.indexOf(timeline))>=0?(this._slotBlendTimelines.splice(index,1),timeline.returnToPool()):(index=this._constraintTimelines.indexOf(timeline))>=0&&(this._constraintTimelines.splice(index,1),timeline.returnToPool())}this._poseTimelines.length=0}this._actionTimeline.playState>0&&this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime)}}},AnimationState.prototype.play=function(){this._playheadState=3},AnimationState.prototype.stop=function(){this._playheadState&=1},AnimationState.prototype.fadeOut=function(fadeOutTime,pausePlayhead){if(void 0===pausePlayhead&&(pausePlayhead=!0),fadeOutTime<0&&(fadeOutTime=0),pausePlayhead&&(this._playheadState&=2),this._fadeState>0){if(fadeOutTime>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(fadeOutTime<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var _i=0,_a=this._boneTimelines;_i<_a.length;_i++){var timeline;(timeline=_a[_i]).fadeOut()}for(var _b=0,_c=this._boneBlendTimelines;_b<_c.length;_b++){var timeline;(timeline=_c[_b]).fadeOut()}for(var _d=0,_e=this._slotTimelines;_d<_e.length;_d++){var timeline;(timeline=_e[_d]).fadeOut()}for(var _f=0,_g=this._slotBlendTimelines;_f<_g.length;_f++){var timeline;(timeline=_g[_f]).fadeOut()}for(var _h=0,_j=this._constraintTimelines;_h<_j.length;_h++){var timeline;(timeline=_j[_h]).fadeOut()}for(var _k=0,_l=this._animationTimelines;_k<_l.length;_k++){var timeline,animaitonState;(timeline=_l[_k]).fadeOut(),timeline.target.fadeOut(999999,!0)}}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?fadeOutTime/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},AnimationState.prototype.containsBoneMask=function(boneName){return 0===this._boneMask.length||this._boneMask.indexOf(boneName)>=0},AnimationState.prototype.addBoneMask=function(boneName,recursive){void 0===recursive&&(recursive=!0);var currentBone=this._armature.getBone(boneName);if(null!==currentBone){if(this._boneMask.indexOf(boneName)<0&&this._boneMask.push(boneName),recursive)for(var _i=0,_a=this._armature.getBones();_i<_a.length;_i++){var bone=_a[_i];this._boneMask.indexOf(bone.name)<0&&currentBone.contains(bone)&&this._boneMask.push(bone.name)}this._timelineDirty=1}},AnimationState.prototype.removeBoneMask=function(boneName,recursive){void 0===recursive&&(recursive=!0);var index=this._boneMask.indexOf(boneName);if(index>=0&&this._boneMask.splice(index,1),recursive){var currentBone=this._armature.getBone(boneName);if(null!==currentBone){var bones=this._armature.getBones();if(this._boneMask.length>0)for(var _i=0,bones_1=bones;_i<bones_1.length;_i++){var bone=bones_1[_i],index_1=this._boneMask.indexOf(bone.name);index_1>=0&&currentBone.contains(bone)&&this._boneMask.splice(index_1,1)}else for(var _a=0,bones_2=bones;_a<bones_2.length;_a++){var bone;(bone=bones_2[_a])!==currentBone&&(currentBone.contains(bone)||this._boneMask.push(bone.name))}}}this._timelineDirty=1},AnimationState.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._timelineDirty=1},AnimationState.prototype.addState=function(animationState,timelineDatas){if(void 0===timelineDatas&&(timelineDatas=null),null!==timelineDatas)for(var _i=0,timelineDatas_4=timelineDatas;_i<timelineDatas_4.length;_i++){var timelineData=timelineDatas_4[_i];switch(timelineData.type){case 40:var timeline;if((timeline=dragonBones.BaseObject.borrowObject(dragonBones.AnimationProgressTimelineState)).target=animationState,timeline.init(this._armature,this,timelineData),this._animationTimelines.push(timeline),0!==this.blendType){var animaitonTimelineData=timelineData;animationState.positionX=animaitonTimelineData.x,animationState.positionY=animaitonTimelineData.y,animationState.weight=0}animationState._parent=this,this.resetToPose=!1;break;case 41:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.AnimationWeightTimelineState)).target=animationState,timeline.init(this._armature,this,timelineData),this._animationTimelines.push(timeline);break;case 42:var timeline;(timeline=dragonBones.BaseObject.borrowObject(dragonBones.AnimationParametersTimelineState)).target=animationState,timeline.init(this._armature,this,timelineData),this._animationTimelines.push(timeline)}}null===animationState._parent&&(animationState._parent=this)},AnimationState.prototype.activeTimeline=function(){for(var _i=0,_a=this._slotTimelines;_i<_a.length;_i++){var timeline=_a[_i];timeline.dirty=!0,timeline.currentTime=-1}},Object.defineProperty(AnimationState.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"isFadeOut",{get:function(){return this._fadeState>0},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"isFadeComplete",{get:function(){return 0===this._fadeState},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"isPlaying",{get:function(){return 0!=(2&this._playheadState)&&this._actionTimeline.playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"isCompleted",{get:function(){return this._actionTimeline.playState>0},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(value){var currentPlayTimes=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if((value<0||this._duration<value)&&(value=value%this._duration+currentPlayTimes*this._duration)<0&&(value+=this._duration),this.playTimes>0&&currentPlayTimes===this.playTimes-1&&value===this._duration&&null===this._parent&&(value=this._duration-1e-6),this._time!==value){this._time=value,this._actionTimeline.setCurrentTime(this._time),null!==this._zOrderTimeline&&(this._zOrderTimeline.playState=-1);for(var _i=0,_a=this._boneTimelines;_i<_a.length;_i++){var timeline;(timeline=_a[_i]).playState=-1}for(var _b=0,_c=this._slotTimelines;_b<_c.length;_b++){var timeline;(timeline=_c[_b]).playState=-1}}},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"weight",{get:function(){return this._weight},set:function(value){if(this._weight!==value){this._weight=value;for(var _i=0,_a=this._boneTimelines;_i<_a.length;_i++){var timeline;(timeline=_a[_i]).dirty=!0}for(var _b=0,_c=this._boneBlendTimelines;_b<_c.length;_b++){var timeline;(timeline=_c[_b]).dirty=!0}for(var _d=0,_e=this._slotBlendTimelines;_d<_e.length;_d++){var timeline;(timeline=_e[_d]).dirty=!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),AnimationState}(dragonBones.BaseObject);dragonBones.AnimationState=AnimationState;var BlendState=function(_super){function BlendState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(BlendState,_super),BlendState.toString=function(){return"[class dragonBones.BlendState]"},BlendState.prototype._onClear=function(){this.reset(),this.target=null},BlendState.prototype.update=function(animationState){var animationLayer=animationState.layer,animationWeight=animationState._weightResult;if(this.dirty>0){if(this.leftWeight>0){if(this.layer!==animationLayer){if(this.layerWeight>=this.leftWeight)return this.dirty++,this.layer=animationLayer,this.leftWeight=0,this.blendWeight=0,!1;this.layer=animationLayer,this.leftWeight-=this.layerWeight,this.layerWeight=0}return animationWeight*=this.leftWeight,this.dirty++,this.blendWeight=animationWeight,this.layerWeight+=this.blendWeight,!0}return!1}return this.dirty++,this.layer=animationLayer,this.leftWeight=1,this.blendWeight=animationWeight,this.layerWeight=animationWeight,!0},BlendState.prototype.reset=function(){this.dirty=0,this.layer=0,this.leftWeight=0,this.layerWeight=0,this.blendWeight=0},BlendState.BONE_TRANSFORM="boneTransform",BlendState.BONE_ALPHA="boneAlpha",BlendState.SURFACE="surface",BlendState.SLOT_DEFORM="slotDeform",BlendState.SLOT_ALPHA="slotAlpha",BlendState.SLOT_Z_INDEX="slotZIndex",BlendState}(dragonBones.BaseObject);dragonBones.BlendState=BlendState}(dragonBones||(dragonBones={})),function(dragonBones){var TimelineState=function(_super){function TimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TimelineState,_super),TimelineState.prototype._onClear=function(){this.dirty=!1,this.playState=-1,this.currentPlayTimes=0,this.currentTime=-1,this.target=null,this._isTween=!1,this._valueOffset=0,this._frameValueOffset=0,this._frameOffset=0,this._frameRate=0,this._frameCount=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._valueArray=null,this._timelineArray=null,this._frameIndices=null},TimelineState.prototype._setCurrentTime=function(passedTime){var prevState=this.playState,prevPlayTimes=this.currentPlayTimes,prevTime=this.currentTime;if(null!==this._actionTimeline&&this._frameCount<=1)this.playState=this._actionTimeline.playState>=0?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime;else if(null===this._actionTimeline||1!==this._timeScale||0!==this._timeOffset){var playTimes=this._animationState.playTimes,totalTime=playTimes*this._duration;passedTime*=this._timeScale,0!==this._timeOffset&&(passedTime+=this._timeOffset*this._animationData.duration),playTimes>0&&(passedTime>=totalTime||passedTime<=-totalTime)?(this.playState<=0&&3===this._animationState._playheadState&&(this.playState=1),this.currentPlayTimes=playTimes,this.currentTime=passedTime<0?0:1===this.playState?this._duration+1e-6:this._duration):(0!==this.playState&&3===this._animationState._playheadState&&(this.playState=0),passedTime<0?(passedTime=-passedTime,this.currentPlayTimes=Math.floor(passedTime/this._duration),this.currentTime=this._duration-passedTime%this._duration):(this.currentPlayTimes=Math.floor(passedTime/this._duration),this.currentTime=passedTime%this._duration)),this.currentTime+=this._position}else this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime;return(this.currentPlayTimes!==prevPlayTimes||this.currentTime!==prevTime)&&((prevState<0&&this.playState!==prevState||this.playState<=0&&this.currentPlayTimes!==prevPlayTimes)&&(this._frameIndex=-1),!0)},TimelineState.prototype.init=function(armature,animationState,timelineData){if(this._armature=armature,this._animationState=animationState,this._timelineData=timelineData,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState.animationData,this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,null!==this._timelineData){var dragonBonesData=this._animationData.parent.parent;this._frameArray=dragonBonesData.frameArray,this._timelineArray=dragonBonesData.timelineArray,this._frameIndices=dragonBonesData.frameIndices,this._frameCount=this._timelineArray[this._timelineData.offset+2],this._frameValueOffset=this._timelineArray[this._timelineData.offset+4],this._timeScale=100/this._timelineArray[this._timelineData.offset+0],this._timeOffset=.01*this._timelineArray[this._timelineData.offset+1]}},TimelineState.prototype.fadeOut=function(){this.dirty=!1},TimelineState.prototype.update=function(passedTime){if(this._setCurrentTime(passedTime)){if(this._frameCount>1){var timelineFrameIndex=Math.floor(this.currentTime*this._frameRate),frameIndex=this._frameIndices[this._timelineData.frameIndicesOffset+timelineFrameIndex];this._frameIndex!==frameIndex&&(this._frameIndex=frameIndex,this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex],this._onArriveAtFrame())}else this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]),this._onArriveAtFrame());(this._isTween||this.dirty)&&this._onUpdateFrame()}},TimelineState.prototype.blend=function(_isDirty){},TimelineState}(dragonBones.BaseObject);dragonBones.TimelineState=TimelineState;var TweenTimelineState=function(_super){function TweenTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TweenTimelineState,_super),TweenTimelineState._getEasingValue=function(tweenType,progress,easing){var value=progress;switch(tweenType){case 3:value=Math.pow(progress,2);break;case 4:value=1-Math.pow(1-progress,2);break;case 5:value=.5*(1-Math.cos(progress*Math.PI))}return(value-progress)*easing+progress},TweenTimelineState._getEasingCurveValue=function(progress,samples,count,offset){if(progress<=0)return 0;if(progress>=1)return 1;var isOmited=count>0,segmentCount=count+1,valueIndex=Math.floor(progress*segmentCount),fromValue=0,toValue=0;return isOmited?(fromValue=0===valueIndex?0:samples[offset+valueIndex-1],toValue=valueIndex===segmentCount-1?1e4:samples[offset+valueIndex]):(fromValue=samples[offset+valueIndex-1],toValue=samples[offset+valueIndex]),1e-4*(fromValue+(toValue-fromValue)*(progress*segmentCount-valueIndex))},TweenTimelineState.prototype._onClear=function(){_super.prototype._onClear.call(this),this._tweenType=0,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenEasing=0,this._tweenProgress=0,this._valueScale=1},TweenTimelineState.prototype._onArriveAtFrame=function(){if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||0===this._animationState.playTimes||this._animationState.currentPlayTimes<this._animationState.playTimes-1))if(this._tweenType=this._frameArray[this._frameOffset+1],this._isTween=0!==this._tweenType,this._isTween?2===this._tweenType?this._curveCount=this._frameArray[this._frameOffset+2]:0!==this._tweenType&&1!==this._tweenType&&(this._tweenEasing=.01*this._frameArray[this._frameOffset+2]):this.dirty=!0,this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._frameIndex===this._frameCount-1)this._frameDurationR=1/(this._animationData.duration-this._framePosition);else{var nextFrameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1],frameDuration=this._frameArray[nextFrameOffset]*this._frameRateR-this._framePosition;this._frameDurationR=frameDuration>0?1/frameDuration:0}else this.dirty=!0,this._isTween=!1},TweenTimelineState.prototype._onUpdateFrame=function(){this._isTween&&(this.dirty=!0,this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,2===this._tweenType?this._tweenProgress=TweenTimelineState._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3):1!==this._tweenType&&(this._tweenProgress=TweenTimelineState._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing)))},TweenTimelineState}(TimelineState);dragonBones.TweenTimelineState=TweenTimelineState;var SingleValueTimelineState=function(_super){function SingleValueTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SingleValueTimelineState,_super),SingleValueTimelineState.prototype._onClear=function(){_super.prototype._onClear.call(this),this._current=0,this._difference=0,this._result=0},SingleValueTimelineState.prototype._onArriveAtFrame=function(){if(_super.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var valueScale=this._valueScale,valueArray=this._valueArray,valueOffset=this._valueOffset+this._frameValueOffset+this._frameIndex;if(this._isTween){var nextValueOffset=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:valueOffset+1;1===valueScale?(this._current=valueArray[valueOffset],this._difference=valueArray[nextValueOffset]-this._current):(this._current=valueArray[valueOffset]*valueScale,this._difference=valueArray[nextValueOffset]*valueScale-this._current)}else this._result=valueArray[valueOffset]*valueScale}else this._result=0},SingleValueTimelineState.prototype._onUpdateFrame=function(){_super.prototype._onUpdateFrame.call(this),this._isTween&&(this._result=this._current+this._difference*this._tweenProgress)},SingleValueTimelineState}(TweenTimelineState);dragonBones.SingleValueTimelineState=SingleValueTimelineState;var DoubleValueTimelineState=function(_super){function DoubleValueTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DoubleValueTimelineState,_super),DoubleValueTimelineState.prototype._onClear=function(){_super.prototype._onClear.call(this),this._currentA=0,this._currentB=0,this._differenceA=0,this._differenceB=0,this._resultA=0,this._resultB=0},DoubleValueTimelineState.prototype._onArriveAtFrame=function(){if(_super.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var valueScale=this._valueScale,valueArray=this._valueArray,valueOffset=this._valueOffset+this._frameValueOffset+2*this._frameIndex;if(this._isTween){var nextValueOffset=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:valueOffset+2;1===valueScale?(this._currentA=valueArray[valueOffset],this._currentB=valueArray[valueOffset+1],this._differenceA=valueArray[nextValueOffset]-this._currentA,this._differenceB=valueArray[nextValueOffset+1]-this._currentB):(this._currentA=valueArray[valueOffset]*valueScale,this._currentB=valueArray[valueOffset+1]*valueScale,this._differenceA=valueArray[nextValueOffset]*valueScale-this._currentA,this._differenceB=valueArray[nextValueOffset+1]*valueScale-this._currentB)}else this._resultA=valueArray[valueOffset]*valueScale,this._resultB=valueArray[valueOffset+1]*valueScale}else this._resultA=0,this._resultB=0},DoubleValueTimelineState.prototype._onUpdateFrame=function(){_super.prototype._onUpdateFrame.call(this),this._isTween&&(this._resultA=this._currentA+this._differenceA*this._tweenProgress,this._resultB=this._currentB+this._differenceB*this._tweenProgress)},DoubleValueTimelineState}(TweenTimelineState);dragonBones.DoubleValueTimelineState=DoubleValueTimelineState;var MutilpleValueTimelineState=function(_super){function MutilpleValueTimelineState(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._rd=[],_this}return __extends(MutilpleValueTimelineState,_super),MutilpleValueTimelineState.prototype._onClear=function(){_super.prototype._onClear.call(this),this._valueCount=0,this._rd.length=0},MutilpleValueTimelineState.prototype._onArriveAtFrame=function(){_super.prototype._onArriveAtFrame.call(this);var valueCount=this._valueCount,rd=this._rd;if(null!==this._timelineData){var valueScale=this._valueScale,valueArray=this._valueArray,valueOffset=this._valueOffset+this._frameValueOffset+this._frameIndex*valueCount;if(this._isTween){var nextValueOffset=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:valueOffset+valueCount;if(1===valueScale)for(var i=0;i<valueCount;++i)rd[valueCount+i]=valueArray[nextValueOffset+i]-valueArray[valueOffset+i];else for(var i=0;i<valueCount;++i)rd[valueCount+i]=(valueArray[nextValueOffset+i]-valueArray[valueOffset+i])*valueScale}else if(1===valueScale)for(var i=0;i<valueCount;++i)rd[i]=valueArray[valueOffset+i];else for(var i=0;i<valueCount;++i)rd[i]=valueArray[valueOffset+i]*valueScale}else for(var i=0;i<valueCount;++i)rd[i]=0},MutilpleValueTimelineState.prototype._onUpdateFrame=function(){if(_super.prototype._onUpdateFrame.call(this),this._isTween){var valueCount=this._valueCount,valueScale=this._valueScale,tweenProgress=this._tweenProgress,valueArray=this._valueArray,rd=this._rd,valueOffset=this._valueOffset+this._frameValueOffset+this._frameIndex*valueCount;if(1===valueScale)for(var i=0;i<valueCount;++i)rd[i]=valueArray[valueOffset+i]+rd[valueCount+i]*tweenProgress;else for(var i=0;i<valueCount;++i)rd[i]=valueArray[valueOffset+i]*valueScale+rd[valueCount+i]*tweenProgress}},MutilpleValueTimelineState}(TweenTimelineState);dragonBones.MutilpleValueTimelineState=MutilpleValueTimelineState}(dragonBones||(dragonBones={})),function(dragonBones){var ActionTimelineState=function(_super){function ActionTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ActionTimelineState,_super),ActionTimelineState.toString=function(){return"[class dragonBones.ActionTimelineState]"},ActionTimelineState.prototype._onCrossFrame=function(frameIndex){var eventDispatcher=this._armature.eventDispatcher;if(this._animationState.actionEnabled)for(var frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+frameIndex],actionCount=this._frameArray[frameOffset+1],actions=this._animationData.parent.actions,i=0;i<actionCount;++i){var actionIndex,action=actions[this._frameArray[frameOffset+2+i]];if(0===action.type){var eventObject;(eventObject=dragonBones.BaseObject.borrowObject(dragonBones.EventObject)).time=this._frameArray[frameOffset]/this._frameRate,eventObject.animationState=this._animationState,dragonBones.EventObject.actionDataToInstance(action,eventObject,this._armature),this._armature._bufferAction(eventObject,!0)}else{var eventType=10===action.type?dragonBones.EventObject.FRAME_EVENT:dragonBones.EventObject.SOUND_EVENT,eventObject;if(11===action.type||eventDispatcher.hasDBEventListener(eventType))(eventObject=dragonBones.BaseObject.borrowObject(dragonBones.EventObject)).time=this._frameArray[frameOffset]/this._frameRate,eventObject.animationState=this._animationState,dragonBones.EventObject.actionDataToInstance(action,eventObject,this._armature),this._armature._dragonBones.bufferEvent(eventObject)}}},ActionTimelineState.prototype._onArriveAtFrame=function(){},ActionTimelineState.prototype._onUpdateFrame=function(){},ActionTimelineState.prototype.update=function(passedTime){var prevState=this.playState,prevPlayTimes=this.currentPlayTimes,prevTime=this.currentTime;if(this._setCurrentTime(passedTime)){var eventActive=null===this._animationState._parent&&this._animationState.actionEnabled,eventDispatcher=this._armature.eventDispatcher;if(prevState<0){if(this.playState===prevState)return;if(this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),eventActive&&eventDispatcher.hasDBEventListener(dragonBones.EventObject.START)){var eventObject=dragonBones.BaseObject.borrowObject(dragonBones.EventObject);eventObject.type=dragonBones.EventObject.START,eventObject.armature=this._armature,eventObject.animationState=this._animationState,this._armature._dragonBones.bufferEvent(eventObject)}}var isReverse=this._animationState.timeScale<0,loopCompleteEvent=null,completeEvent=null;if(eventActive&&this.currentPlayTimes!==prevPlayTimes&&(eventDispatcher.hasDBEventListener(dragonBones.EventObject.LOOP_COMPLETE)&&((loopCompleteEvent=dragonBones.BaseObject.borrowObject(dragonBones.EventObject)).type=dragonBones.EventObject.LOOP_COMPLETE,loopCompleteEvent.armature=this._armature,loopCompleteEvent.animationState=this._animationState),this.playState>0&&eventDispatcher.hasDBEventListener(dragonBones.EventObject.COMPLETE)&&((completeEvent=dragonBones.BaseObject.borrowObject(dragonBones.EventObject)).type=dragonBones.EventObject.COMPLETE,completeEvent.armature=this._armature,completeEvent.animationState=this._animationState)),this._frameCount>1){var timelineData=this._timelineData,timelineFrameIndex=Math.floor(this.currentTime*this._frameRate),frameIndex=this._frameIndices[timelineData.frameIndicesOffset+timelineFrameIndex];if(this._frameIndex!==frameIndex){var crossedFrameIndex=this._frameIndex;if(this._frameIndex=frameIndex,null!==this._timelineArray)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[timelineData.offset+5+this._frameIndex],isReverse){if(crossedFrameIndex<0){var prevFrameIndex=Math.floor(prevTime*this._frameRate);crossedFrameIndex=this._frameIndices[timelineData.frameIndicesOffset+prevFrameIndex],this.currentPlayTimes===prevPlayTimes&&crossedFrameIndex===frameIndex&&(crossedFrameIndex=-1)}for(;crossedFrameIndex>=0;){var frameOffset=this._animationData.frameOffset+this._timelineArray[timelineData.offset+5+crossedFrameIndex],framePosition=this._frameArray[frameOffset]/this._frameRate;if(this._position<=framePosition&&framePosition<=this._position+this._duration&&this._onCrossFrame(crossedFrameIndex),null!==loopCompleteEvent&&0===crossedFrameIndex&&(this._armature._dragonBones.bufferEvent(loopCompleteEvent),loopCompleteEvent=null),crossedFrameIndex>0?crossedFrameIndex--:crossedFrameIndex=this._frameCount-1,crossedFrameIndex===frameIndex)break}}else{if(crossedFrameIndex<0){var prevFrameIndex=Math.floor(prevTime*this._frameRate);crossedFrameIndex=this._frameIndices[timelineData.frameIndicesOffset+prevFrameIndex];var frameOffset=this._animationData.frameOffset+this._timelineArray[timelineData.offset+5+crossedFrameIndex],framePosition=this._frameArray[frameOffset]/this._frameRate;this.currentPlayTimes===prevPlayTimes&&(prevTime<=framePosition?crossedFrameIndex>0?crossedFrameIndex--:crossedFrameIndex=this._frameCount-1:crossedFrameIndex===frameIndex&&(crossedFrameIndex=-1))}for(;crossedFrameIndex>=0;){crossedFrameIndex<this._frameCount-1?crossedFrameIndex++:crossedFrameIndex=0;var frameOffset=this._animationData.frameOffset+this._timelineArray[timelineData.offset+5+crossedFrameIndex],framePosition=this._frameArray[frameOffset]/this._frameRate;if(this._position<=framePosition&&framePosition<=this._position+this._duration&&this._onCrossFrame(crossedFrameIndex),null!==loopCompleteEvent&&0===crossedFrameIndex&&(this._armature._dragonBones.bufferEvent(loopCompleteEvent),loopCompleteEvent=null),crossedFrameIndex===frameIndex)break}}}}else if(this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData)){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5];var framePosition=this._frameArray[this._frameOffset]/this._frameRate;this.currentPlayTimes===prevPlayTimes?prevTime<=framePosition&&this._onCrossFrame(this._frameIndex):this._position<=framePosition&&(isReverse||null===loopCompleteEvent||(this._armature._dragonBones.bufferEvent(loopCompleteEvent),loopCompleteEvent=null),this._onCrossFrame(this._frameIndex))}null!==loopCompleteEvent&&this._armature._dragonBones.bufferEvent(loopCompleteEvent),null!==completeEvent&&this._armature._dragonBones.bufferEvent(completeEvent)}},ActionTimelineState.prototype.setCurrentTime=function(value){this._setCurrentTime(value),this._frameIndex=-1},ActionTimelineState}(dragonBones.TimelineState);dragonBones.ActionTimelineState=ActionTimelineState;var ZOrderTimelineState=function(_super){function ZOrderTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ZOrderTimelineState,_super),ZOrderTimelineState.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},ZOrderTimelineState.prototype._onArriveAtFrame=function(){var count;this.playState>=0&&(this._frameArray[this._frameOffset+1]>0?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0))},ZOrderTimelineState.prototype._onUpdateFrame=function(){},ZOrderTimelineState}(dragonBones.TimelineState);dragonBones.ZOrderTimelineState=ZOrderTimelineState;var BoneAllTimelineState=function(_super){function BoneAllTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(BoneAllTimelineState,_super),BoneAllTimelineState.toString=function(){return"[class dragonBones.BoneAllTimelineState]"},BoneAllTimelineState.prototype._onArriveAtFrame=function(){_super.prototype._onArriveAtFrame.call(this),this._isTween&&this._frameIndex===this._frameCount-1&&(this._rd[2]=dragonBones.Transform.normalizeRadian(this._rd[2]),this._rd[3]=dragonBones.Transform.normalizeRadian(this._rd[3])),null===this._timelineData&&(this._rd[4]=1,this._rd[5]=1)},BoneAllTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=6,this._valueArray=this._animationData.parent.parent.frameFloatArray},BoneAllTimelineState.prototype.fadeOut=function(){this.dirty=!1,this._rd[2]=dragonBones.Transform.normalizeRadian(this._rd[2]),this._rd[3]=dragonBones.Transform.normalizeRadian(this._rd[3])},BoneAllTimelineState.prototype.blend=function(isDirty){var valueScale=this._armature.armatureData.scale,rd=this._rd,blendState=this.target,bone=blendState.target,blendWeight=blendState.blendWeight,result=bone.animationPose;blendState.dirty>1?(result.x+=rd[0]*blendWeight*valueScale,result.y+=rd[1]*blendWeight*valueScale,result.rotation+=rd[2]*blendWeight,result.skew+=rd[3]*blendWeight,result.scaleX+=(rd[4]-1)*blendWeight,result.scaleY+=(rd[5]-1)*blendWeight):(result.x=rd[0]*blendWeight*valueScale,result.y=rd[1]*blendWeight*valueScale,result.rotation=rd[2]*blendWeight,result.skew=rd[3]*blendWeight,result.scaleX=(rd[4]-1)*blendWeight+1,result.scaleY=(rd[5]-1)*blendWeight+1),(isDirty||this.dirty)&&(this.dirty=!1,bone._transformDirty=!0)},BoneAllTimelineState}(dragonBones.MutilpleValueTimelineState);dragonBones.BoneAllTimelineState=BoneAllTimelineState;var BoneTranslateTimelineState=function(_super){function BoneTranslateTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(BoneTranslateTimelineState,_super),BoneTranslateTimelineState.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"},BoneTranslateTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=this._animationData.parent.parent.frameFloatArray},BoneTranslateTimelineState.prototype.blend=function(isDirty){var blendState=this.target,bone=blendState.target,blendWeight=blendState.blendWeight,result=bone.animationPose;blendState.dirty>1?(result.x+=this._resultA*blendWeight,result.y+=this._resultB*blendWeight):1!==blendWeight?(result.x=this._resultA*blendWeight,result.y=this._resultB*blendWeight):(result.x=this._resultA,result.y=this._resultB),(isDirty||this.dirty)&&(this.dirty=!1,bone._transformDirty=!0)},BoneTranslateTimelineState}(dragonBones.DoubleValueTimelineState);dragonBones.BoneTranslateTimelineState=BoneTranslateTimelineState;var BoneRotateTimelineState=function(_super){function BoneRotateTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(BoneRotateTimelineState,_super),BoneRotateTimelineState.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"},BoneRotateTimelineState.prototype._onArriveAtFrame=function(){_super.prototype._onArriveAtFrame.call(this),this._isTween&&this._frameIndex===this._frameCount-1&&(this._differenceA=dragonBones.Transform.normalizeRadian(this._differenceA),this._differenceB=dragonBones.Transform.normalizeRadian(this._differenceB))},BoneRotateTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray},BoneRotateTimelineState.prototype.fadeOut=function(){this.dirty=!1,this._resultA=dragonBones.Transform.normalizeRadian(this._resultA),this._resultB=dragonBones.Transform.normalizeRadian(this._resultB)},BoneRotateTimelineState.prototype.blend=function(isDirty){var blendState=this.target,bone=blendState.target,blendWeight=blendState.blendWeight,result=bone.animationPose;blendState.dirty>1?(result.rotation+=this._resultA*blendWeight,result.skew+=this._resultB*blendWeight):1!==blendWeight?(result.rotation=this._resultA*blendWeight,result.skew=this._resultB*blendWeight):(result.rotation=this._resultA,result.skew=this._resultB),(isDirty||this.dirty)&&(this.dirty=!1,bone._transformDirty=!0)},BoneRotateTimelineState}(dragonBones.DoubleValueTimelineState);dragonBones.BoneRotateTimelineState=BoneRotateTimelineState;var BoneScaleTimelineState=function(_super){function BoneScaleTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(BoneScaleTimelineState,_super),BoneScaleTimelineState.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"},BoneScaleTimelineState.prototype._onArriveAtFrame=function(){_super.prototype._onArriveAtFrame.call(this),null===this._timelineData&&(this._resultA=1,this._resultB=1)},BoneScaleTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray},BoneScaleTimelineState.prototype.blend=function(isDirty){var blendState=this.target,bone=blendState.target,blendWeight=blendState.blendWeight,result=bone.animationPose;blendState.dirty>1?(result.scaleX+=(this._resultA-1)*blendWeight,result.scaleY+=(this._resultB-1)*blendWeight):1!==blendWeight?(result.scaleX=(this._resultA-1)*blendWeight+1,result.scaleY=(this._resultB-1)*blendWeight+1):(result.scaleX=this._resultA,result.scaleY=this._resultB),(isDirty||this.dirty)&&(this.dirty=!1,bone._transformDirty=!0)},BoneScaleTimelineState}(dragonBones.DoubleValueTimelineState);dragonBones.BoneScaleTimelineState=BoneScaleTimelineState;var SurfaceTimelineState=function(_super){function SurfaceTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SurfaceTimelineState,_super),SurfaceTimelineState.toString=function(){return"[class dragonBones.SurfaceTimelineState]"},SurfaceTimelineState.prototype._onClear=function(){_super.prototype._onClear.call(this),this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0},SurfaceTimelineState.prototype.init=function(armature,animationState,timelineData){if(_super.prototype.init.call(this,armature,animationState,timelineData),null!==this._timelineData){var dragonBonesData=this._animationData.parent.parent,frameIntArray=dragonBonesData.frameIntArray,frameIntOffset=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=frameIntArray[frameIntOffset+2],this._deformCount=frameIntArray[frameIntOffset+1],this._deformOffset=frameIntArray[frameIntOffset+3],this._sameValueOffset=frameIntArray[frameIntOffset+4]+this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=dragonBonesData.frameFloatArray,this._rd.length=2*this._valueCount}else this._deformCount=this.target.target._deformVertices.length},SurfaceTimelineState.prototype.blend=function(isDirty){var blendState=this.target,surface=blendState.target,blendWeight=blendState.blendWeight,result=surface._deformVertices,valueArray=this._valueArray;if(null!==valueArray)for(var valueCount=this._valueCount,deformOffset=this._deformOffset,sameValueOffset=this._sameValueOffset,rd=this._rd,i=0;i<this._deformCount;++i){var value=0;value=i<deformOffset?valueArray[sameValueOffset+i]:i<deformOffset+valueCount?rd[i-deformOffset]:valueArray[sameValueOffset+i-valueCount],blendState.dirty>1?result[i]+=value*blendWeight:result[i]=value*blendWeight}else if(1===blendState.dirty)for(var i=0;i<this._deformCount;++i)result[i]=0;(isDirty||this.dirty)&&(this.dirty=!1,surface._transformDirty=!0)},SurfaceTimelineState}(dragonBones.MutilpleValueTimelineState);dragonBones.SurfaceTimelineState=SurfaceTimelineState;var AlphaTimelineState=function(_super){function AlphaTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AlphaTimelineState,_super),AlphaTimelineState.toString=function(){return"[class dragonBones.AlphaTimelineState]"},AlphaTimelineState.prototype._onArriveAtFrame=function(){_super.prototype._onArriveAtFrame.call(this),null===this._timelineData&&(this._result=1)},AlphaTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray},AlphaTimelineState.prototype.blend=function(isDirty){var blendState=this.target,alphaTarget=blendState.target,blendWeight=blendState.blendWeight;blendState.dirty>1?(alphaTarget._alpha+=this._result*blendWeight,alphaTarget._alpha>1&&(alphaTarget._alpha=1)):alphaTarget._alpha=this._result*blendWeight,(isDirty||this.dirty)&&(this.dirty=!1,this._armature._alphaDirty=!0)},AlphaTimelineState}(dragonBones.SingleValueTimelineState);dragonBones.AlphaTimelineState=AlphaTimelineState;var SlotDisplayTimelineState=function(_super){function SlotDisplayTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SlotDisplayTimelineState,_super),SlotDisplayTimelineState.toString=function(){return"[class dragonBones.SlotDisplayTimelineState]"},SlotDisplayTimelineState.prototype._onArriveAtFrame=function(){if(this.playState>=0){var slot=this.target,displayIndex=null!==this._timelineData?this._frameArray[this._frameOffset+1]:slot._slotData.displayIndex;slot.displayIndex!==displayIndex&&slot._setDisplayIndex(displayIndex,!0)}},SlotDisplayTimelineState.prototype._onUpdateFrame=function(){},SlotDisplayTimelineState}(dragonBones.TimelineState);dragonBones.SlotDisplayTimelineState=SlotDisplayTimelineState;var SlotColorTimelineState=function(_super){function SlotColorTimelineState(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._current=[0,0,0,0,0,0,0,0],_this._difference=[0,0,0,0,0,0,0,0],_this._result=[0,0,0,0,0,0,0,0],_this}return __extends(SlotColorTimelineState,_super),SlotColorTimelineState.toString=function(){return"[class dragonBones.SlotColorTimelineState]"},SlotColorTimelineState.prototype._onArriveAtFrame=function(){if(_super.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var dragonBonesData=this._animationData.parent.parent,colorArray=dragonBonesData.colorArray,frameIntArray=dragonBonesData.frameIntArray,valueOffset=this._animationData.frameIntOffset+this._frameValueOffset+this._frameIndex,colorOffset=frameIntArray[valueOffset];colorOffset<0&&(colorOffset+=65536),this._isTween?(this._current[0]=colorArray[colorOffset++],this._current[1]=colorArray[colorOffset++],this._current[2]=colorArray[colorOffset++],this._current[3]=colorArray[colorOffset++],this._current[4]=colorArray[colorOffset++],this._current[5]=colorArray[colorOffset++],this._current[6]=colorArray[colorOffset++],this._current[7]=colorArray[colorOffset++],(colorOffset=this._frameIndex===this._frameCount-1?frameIntArray[this._animationData.frameIntOffset+this._frameValueOffset]:frameIntArray[valueOffset+1])<0&&(colorOffset+=65536),this._difference[0]=colorArray[colorOffset++]-this._current[0],this._difference[1]=colorArray[colorOffset++]-this._current[1],this._difference[2]=colorArray[colorOffset++]-this._current[2],this._difference[3]=colorArray[colorOffset++]-this._current[3],this._difference[4]=colorArray[colorOffset++]-this._current[4],this._difference[5]=colorArray[colorOffset++]-this._current[5],this._difference[6]=colorArray[colorOffset++]-this._current[6],this._difference[7]=colorArray[colorOffset++]-this._current[7]):(this._result[0]=.01*colorArray[colorOffset++],this._result[1]=.01*colorArray[colorOffset++],this._result[2]=.01*colorArray[colorOffset++],this._result[3]=.01*colorArray[colorOffset++],this._result[4]=colorArray[colorOffset++],this._result[5]=colorArray[colorOffset++],this._result[6]=colorArray[colorOffset++],this._result[7]=colorArray[colorOffset++])}else{var slot,color=this.target.slotData.color;this._result[0]=color.alphaMultiplier,this._result[1]=color.redMultiplier,this._result[2]=color.greenMultiplier,this._result[3]=color.blueMultiplier,this._result[4]=color.alphaOffset,this._result[5]=color.redOffset,this._result[6]=color.greenOffset,this._result[7]=color.blueOffset}},SlotColorTimelineState.prototype._onUpdateFrame=function(){_super.prototype._onUpdateFrame.call(this),this._isTween&&(this._result[0]=.01*(this._current[0]+this._difference[0]*this._tweenProgress),this._result[1]=.01*(this._current[1]+this._difference[1]*this._tweenProgress),this._result[2]=.01*(this._current[2]+this._difference[2]*this._tweenProgress),this._result[3]=.01*(this._current[3]+this._difference[3]*this._tweenProgress),this._result[4]=this._current[4]+this._difference[4]*this._tweenProgress,this._result[5]=this._current[5]+this._difference[5]*this._tweenProgress,this._result[6]=this._current[6]+this._difference[6]*this._tweenProgress,this._result[7]=this._current[7]+this._difference[7]*this._tweenProgress)},SlotColorTimelineState.prototype.fadeOut=function(){this._isTween=!1},SlotColorTimelineState.prototype.update=function(passedTime){if(_super.prototype.update.call(this,passedTime),this._isTween||this.dirty){var slot=this.target,result=slot._colorTransform;if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){if(result.alphaMultiplier!==this._result[0]||result.redMultiplier!==this._result[1]||result.greenMultiplier!==this._result[2]||result.blueMultiplier!==this._result[3]||result.alphaOffset!==this._result[4]||result.redOffset!==this._result[5]||result.greenOffset!==this._result[6]||result.blueOffset!==this._result[7]){var fadeProgress=Math.pow(this._animationState._fadeProgress,4);result.alphaMultiplier+=(this._result[0]-result.alphaMultiplier)*fadeProgress,result.redMultiplier+=(this._result[1]-result.redMultiplier)*fadeProgress,result.greenMultiplier+=(this._result[2]-result.greenMultiplier)*fadeProgress,result.blueMultiplier+=(this._result[3]-result.blueMultiplier)*fadeProgress,result.alphaOffset+=(this._result[4]-result.alphaOffset)*fadeProgress,result.redOffset+=(this._result[5]-result.redOffset)*fadeProgress,result.greenOffset+=(this._result[6]-result.greenOffset)*fadeProgress,result.blueOffset+=(this._result[7]-result.blueOffset)*fadeProgress,slot._colorDirty=!0}}else this.dirty&&(this.dirty=!1,result.alphaMultiplier===this._result[0]&&result.redMultiplier===this._result[1]&&result.greenMultiplier===this._result[2]&&result.blueMultiplier===this._result[3]&&result.alphaOffset===this._result[4]&&result.redOffset===this._result[5]&&result.greenOffset===this._result[6]&&result.blueOffset===this._result[7]||(result.alphaMultiplier=this._result[0],result.redMultiplier=this._result[1],result.greenMultiplier=this._result[2],result.blueMultiplier=this._result[3],result.alphaOffset=this._result[4],result.redOffset=this._result[5],result.greenOffset=this._result[6],result.blueOffset=this._result[7],slot._colorDirty=!0))}},SlotColorTimelineState}(dragonBones.TweenTimelineState);dragonBones.SlotColorTimelineState=SlotColorTimelineState;var SlotZIndexTimelineState=function(_super){function SlotZIndexTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SlotZIndexTimelineState,_super),SlotZIndexTimelineState.toString=function(){return"[class dragonBones.SlotZIndexTimelineState]"},SlotZIndexTimelineState.prototype._onArriveAtFrame=function(){if(_super.prototype._onArriveAtFrame.call(this),null===this._timelineData){var blendState,slot=this.target.target;this._result=slot.slotData.zIndex}},SlotZIndexTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameIntOffset,this._valueArray=this._animationData.parent.parent.frameIntArray},SlotZIndexTimelineState.prototype.blend=function(isDirty){var blendState=this.target,slot=blendState.target,blendWeight=blendState.blendWeight;blendState.dirty>1?slot._zIndex+=this._result*blendWeight:slot._zIndex=this._result*blendWeight,(isDirty||this.dirty)&&(this.dirty=!1,this._armature._zIndexDirty=!0)},SlotZIndexTimelineState}(dragonBones.SingleValueTimelineState);dragonBones.SlotZIndexTimelineState=SlotZIndexTimelineState;var DeformTimelineState=function(_super){function DeformTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DeformTimelineState,_super),DeformTimelineState.toString=function(){return"[class dragonBones.DeformTimelineState]"},DeformTimelineState.prototype._onClear=function(){_super.prototype._onClear.call(this),this.displayFrame=null,this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0},DeformTimelineState.prototype.init=function(armature,animationState,timelineData){if(_super.prototype.init.call(this,armature,animationState,timelineData),null!==this._timelineData){var frameIntOffset=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3],dragonBonesData=this._animationData.parent.parent,frameIntArray=dragonBonesData.frameIntArray;this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=frameIntArray[frameIntOffset+2],this._deformCount=frameIntArray[frameIntOffset+1],this._deformOffset=frameIntArray[frameIntOffset+3],this._sameValueOffset=frameIntArray[frameIntOffset+4],this._sameValueOffset<0&&(this._sameValueOffset+=65536),this._sameValueOffset+=this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=dragonBonesData.frameFloatArray,this._rd.length=2*this._valueCount}else this._deformCount=this.displayFrame.deformVertices.length},DeformTimelineState.prototype.blend=function(isDirty){var blendState=this.target,slot=blendState.target,blendWeight=blendState.blendWeight,result=this.displayFrame.deformVertices,valueArray=this._valueArray;if(null!==valueArray)for(var valueCount=this._valueCount,deformOffset=this._deformOffset,sameValueOffset=this._sameValueOffset,rd=this._rd,i=0;i<this._deformCount;++i){var value=0;value=i<deformOffset?valueArray[sameValueOffset+i]:i<deformOffset+valueCount?rd[i-deformOffset]:valueArray[sameValueOffset+i-valueCount],blendState.dirty>1?result[i]+=value*blendWeight:result[i]=value*blendWeight}else if(1===blendState.dirty)for(var i=0;i<this._deformCount;++i)result[i]=0;(isDirty||this.dirty)&&(this.dirty=!1,slot._geometryData===this.displayFrame.getGeometryData()&&(slot._verticesDirty=!0))},DeformTimelineState}(dragonBones.MutilpleValueTimelineState);dragonBones.DeformTimelineState=DeformTimelineState;var IKConstraintTimelineState=function(_super){function IKConstraintTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(IKConstraintTimelineState,_super),IKConstraintTimelineState.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"},IKConstraintTimelineState.prototype._onUpdateFrame=function(){_super.prototype._onUpdateFrame.call(this);var ikConstraint=this.target;if(null!==this._timelineData)ikConstraint._bendPositive=this._currentA>0,ikConstraint._weight=this._currentB;else{var ikConstraintData=ikConstraint._constraintData;ikConstraint._bendPositive=ikConstraintData.bendPositive,ikConstraint._weight=ikConstraintData.weight}ikConstraint.invalidUpdate(),this.dirty=!1},IKConstraintTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray},IKConstraintTimelineState}(dragonBones.DoubleValueTimelineState);dragonBones.IKConstraintTimelineState=IKConstraintTimelineState;var AnimationProgressTimelineState=function(_super){function AnimationProgressTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AnimationProgressTimelineState,_super),AnimationProgressTimelineState.toString=function(){return"[class dragonBones.AnimationProgressTimelineState]"},AnimationProgressTimelineState.prototype._onUpdateFrame=function(){_super.prototype._onUpdateFrame.call(this);var animationState=this.target;null!==animationState._parent&&(animationState.currentTime=this._result*animationState.totalTime),this.dirty=!1},AnimationProgressTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},AnimationProgressTimelineState}(dragonBones.SingleValueTimelineState);dragonBones.AnimationProgressTimelineState=AnimationProgressTimelineState;var AnimationWeightTimelineState=function(_super){function AnimationWeightTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AnimationWeightTimelineState,_super),AnimationWeightTimelineState.toString=function(){return"[class dragonBones.AnimationWeightTimelineState]"},AnimationWeightTimelineState.prototype._onUpdateFrame=function(){_super.prototype._onUpdateFrame.call(this);var animationState=this.target;null!==animationState._parent&&(animationState.weight=this._result),this.dirty=!1},AnimationWeightTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},AnimationWeightTimelineState}(dragonBones.SingleValueTimelineState);dragonBones.AnimationWeightTimelineState=AnimationWeightTimelineState;var AnimationParametersTimelineState=function(_super){function AnimationParametersTimelineState(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AnimationParametersTimelineState,_super),AnimationParametersTimelineState.toString=function(){return"[class dragonBones.AnimationParametersTimelineState]"},AnimationParametersTimelineState.prototype._onUpdateFrame=function(){_super.prototype._onUpdateFrame.call(this);var animationState=this.target;null!==animationState._parent&&(animationState.parameterX=this._resultA,animationState.parameterY=this._resultB),this.dirty=!1},AnimationParametersTimelineState.prototype.init=function(armature,animationState,timelineData){_super.prototype.init.call(this,armature,animationState,timelineData),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},AnimationParametersTimelineState}(dragonBones.DoubleValueTimelineState);dragonBones.AnimationParametersTimelineState=AnimationParametersTimelineState}(dragonBones||(dragonBones={})),function(dragonBones){var EventObject=function(_super){function EventObject(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(EventObject,_super),EventObject.actionDataToInstance=function(data,instance,armature){0===data.type?instance.type=EventObject.FRAME_EVENT:instance.type=10===data.type?EventObject.FRAME_EVENT:EventObject.SOUND_EVENT,instance.name=data.name,instance.armature=armature,instance.actionData=data,instance.data=data.data,null!==data.bone&&(instance.bone=armature.getBone(data.bone.name)),null!==data.slot&&(instance.slot=armature.getSlot(data.slot.name))},EventObject.toString=function(){return"[class dragonBones.EventObject]"},EventObject.prototype._onClear=function(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.actionData=null,this.data=null},EventObject.START="start",EventObject.LOOP_COMPLETE="loopComplete",EventObject.COMPLETE="complete",EventObject.FADE_IN="fadeIn",EventObject.FADE_IN_COMPLETE="fadeInComplete",EventObject.FADE_OUT="fadeOut",EventObject.FADE_OUT_COMPLETE="fadeOutComplete",EventObject.FRAME_EVENT="frameEvent",EventObject.SOUND_EVENT="soundEvent",EventObject}(dragonBones.BaseObject);dragonBones.EventObject=EventObject}(dragonBones||(dragonBones={})),function(dragonBones){var DataParser=function(){function DataParser(){}return DataParser._getArmatureType=function(value){switch(value.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}},DataParser._getBoneType=function(value){switch(value.toLowerCase()){case"bone":return 0;case"surface":return 1;default:return 0}},DataParser._getPositionMode=function(value){switch(value.toLocaleLowerCase()){case"percent":return 1;case"fixed":return 0;default:return 1}},DataParser._getSpacingMode=function(value){switch(value.toLocaleLowerCase()){case"length":return 0;case"percent":return 2;case"fixed":return 1;default:return 0}},DataParser._getRotateMode=function(value){switch(value.toLocaleLowerCase()){case"tangent":return 0;case"chain":return 1;case"chainscale":return 2;default:return 0}},DataParser._getDisplayType=function(value){switch(value.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;case"path":return 4;default:return 0}},DataParser._getBoundingBoxType=function(value){switch(value.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}},DataParser._getBlendMode=function(value){switch(value.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},DataParser._getAnimationBlendType=function(value){switch(value.toLowerCase()){case"none":return 0;case"1d":return 1;default:return 0}},DataParser._getActionType=function(value){switch(value.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}},DataParser.DATA_VERSION_2_3="2.3",DataParser.DATA_VERSION_3_0="3.0",DataParser.DATA_VERSION_4_0="4.0",DataParser.DATA_VERSION_4_5="4.5",DataParser.DATA_VERSION_5_0="5.0",DataParser.DATA_VERSION_5_5="5.5",DataParser.DATA_VERSION_5_6="5.6",DataParser.DATA_VERSION=DataParser.DATA_VERSION_5_6,DataParser.DATA_VERSIONS=[DataParser.DATA_VERSION_4_0,DataParser.DATA_VERSION_4_5,DataParser.DATA_VERSION_5_0,DataParser.DATA_VERSION_5_5,DataParser.DATA_VERSION_5_6],DataParser.TEXTURE_ATLAS="textureAtlas",DataParser.SUB_TEXTURE="SubTexture",DataParser.FORMAT="format",DataParser.IMAGE_PATH="imagePath",DataParser.WIDTH="width",DataParser.HEIGHT="height",DataParser.ROTATED="rotated",DataParser.FRAME_X="frameX",DataParser.FRAME_Y="frameY",DataParser.FRAME_WIDTH="frameWidth",DataParser.FRAME_HEIGHT="frameHeight",DataParser.DRADON_BONES="dragonBones",DataParser.USER_DATA="userData",DataParser.ARMATURE="armature",DataParser.CANVAS="canvas",DataParser.BONE="bone",DataParser.SURFACE="surface",DataParser.SLOT="slot",DataParser.CONSTRAINT="constraint",DataParser.SKIN="skin",DataParser.DISPLAY="display",DataParser.FRAME="frame",DataParser.IK="ik",DataParser.PATH_CONSTRAINT="path",DataParser.ANIMATION="animation",DataParser.TIMELINE="timeline",DataParser.FFD="ffd",DataParser.TRANSLATE_FRAME="translateFrame",DataParser.ROTATE_FRAME="rotateFrame",DataParser.SCALE_FRAME="scaleFrame",DataParser.DISPLAY_FRAME="displayFrame",DataParser.COLOR_FRAME="colorFrame",DataParser.DEFAULT_ACTIONS="defaultActions",DataParser.ACTIONS="actions",DataParser.EVENTS="events",DataParser.INTS="ints",DataParser.FLOATS="floats",DataParser.STRINGS="strings",DataParser.TRANSFORM="transform",DataParser.PIVOT="pivot",DataParser.AABB="aabb",DataParser.COLOR="color",DataParser.VERSION="version",DataParser.COMPATIBLE_VERSION="compatibleVersion",DataParser.FRAME_RATE="frameRate",DataParser.TYPE="type",DataParser.SUB_TYPE="subType",DataParser.NAME="name",DataParser.PARENT="parent",DataParser.TARGET="target",DataParser.STAGE="stage",DataParser.SHARE="share",DataParser.PATH="path",DataParser.LENGTH="length",DataParser.DISPLAY_INDEX="displayIndex",DataParser.Z_ORDER="zOrder",DataParser.Z_INDEX="zIndex",DataParser.BLEND_MODE="blendMode",DataParser.INHERIT_TRANSLATION="inheritTranslation",DataParser.INHERIT_ROTATION="inheritRotation",DataParser.INHERIT_SCALE="inheritScale",DataParser.INHERIT_REFLECTION="inheritReflection",DataParser.INHERIT_ANIMATION="inheritAnimation",DataParser.INHERIT_DEFORM="inheritDeform",DataParser.SEGMENT_X="segmentX",DataParser.SEGMENT_Y="segmentY",DataParser.BEND_POSITIVE="bendPositive",DataParser.CHAIN="chain",DataParser.WEIGHT="weight",DataParser.BLEND_TYPE="blendType",DataParser.FADE_IN_TIME="fadeInTime",DataParser.PLAY_TIMES="playTimes",DataParser.SCALE="scale",DataParser.OFFSET="offset",DataParser.POSITION="position",DataParser.DURATION="duration",DataParser.TWEEN_EASING="tweenEasing",DataParser.TWEEN_ROTATE="tweenRotate",DataParser.TWEEN_SCALE="tweenScale",DataParser.CLOCK_WISE="clockwise",DataParser.CURVE="curve",DataParser.SOUND="sound",DataParser.EVENT="event",DataParser.ACTION="action",DataParser.X="x",DataParser.Y="y",DataParser.SKEW_X="skX",DataParser.SKEW_Y="skY",DataParser.SCALE_X="scX",DataParser.SCALE_Y="scY",DataParser.VALUE="value",DataParser.ROTATE="rotate",DataParser.SKEW="skew",DataParser.ALPHA="alpha",DataParser.ALPHA_OFFSET="aO",DataParser.RED_OFFSET="rO",DataParser.GREEN_OFFSET="gO",DataParser.BLUE_OFFSET="bO",DataParser.ALPHA_MULTIPLIER="aM",DataParser.RED_MULTIPLIER="rM",DataParser.GREEN_MULTIPLIER="gM",DataParser.BLUE_MULTIPLIER="bM",DataParser.UVS="uvs",DataParser.VERTICES="vertices",DataParser.TRIANGLES="triangles",DataParser.WEIGHTS="weights",DataParser.SLOT_POSE="slotPose",DataParser.BONE_POSE="bonePose",DataParser.BONES="bones",DataParser.POSITION_MODE="positionMode",DataParser.SPACING_MODE="spacingMode",DataParser.ROTATE_MODE="rotateMode",DataParser.SPACING="spacing",DataParser.ROTATE_OFFSET="rotateOffset",DataParser.ROTATE_MIX="rotateMix",DataParser.TRANSLATE_MIX="translateMix",DataParser.TARGET_DISPLAY="targetDisplay",DataParser.CLOSED="closed",DataParser.CONSTANT_SPEED="constantSpeed",DataParser.VERTEX_COUNT="vertexCount",DataParser.LENGTHS="lengths",DataParser.GOTO_AND_PLAY="gotoAndPlay",DataParser.DEFAULT_NAME="default",DataParser}();dragonBones.DataParser=DataParser}(dragonBones||(dragonBones={})),function(dragonBones){var ObjectDataParser=function(_super){function ObjectDataParser(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._rawTextureAtlasIndex=0,_this._rawBones=[],_this._data=null,_this._armature=null,_this._bone=null,_this._geometry=null,_this._slot=null,_this._skin=null,_this._mesh=null,_this._animation=null,_this._timeline=null,_this._rawTextureAtlases=null,_this._frameValueType=0,_this._defaultColorOffset=-1,_this._prevClockwise=0,_this._prevRotation=0,_this._frameDefaultValue=0,_this._frameValueScale=1,_this._helpMatrixA=new dragonBones.Matrix,_this._helpMatrixB=new dragonBones.Matrix,_this._helpTransform=new dragonBones.Transform,_this._helpColorTransform=new dragonBones.ColorTransform,_this._helpPoint=new dragonBones.Point,_this._helpArray=[],_this._intArray=[],_this._floatArray=[],_this._frameIntArray=[],_this._frameFloatArray=[],_this._frameArray=[],_this._timelineArray=[],_this._colorArray=[],_this._cacheRawMeshes=[],_this._cacheMeshes=[],_this._actionFrames=[],_this._weightSlotPose={},_this._weightBonePoses={},_this._cacheBones={},_this._slotChildActions={},_this}return __extends(ObjectDataParser,_super),ObjectDataParser._getBoolean=function(rawData,key,defaultValue){if(key in rawData){var value=rawData[key],type=typeof value;if("boolean"===type)return value;if("string"!==type)return!!value;switch(value){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return defaultValue},ObjectDataParser._getNumber=function(rawData,key,defaultValue){if(key in rawData){var value=rawData[key];return null===value||"NaN"===value?defaultValue:+value||0}return defaultValue},ObjectDataParser._getString=function(rawData,key,defaultValue){if(key in rawData){var value=rawData[key],type;return"string"===typeof value?value:String(value)}return defaultValue},ObjectDataParser.prototype._getCurvePoint=function(x1,y1,x2,y2,x3,y3,x4,y4,t,result){var l_t=1-t,powA=l_t*l_t,powB=t*t,kA=l_t*powA,kB=3*t*powA,kC=3*l_t*powB,kD=t*powB;result.x=kA*x1+kB*x2+kC*x3+kD*x4,result.y=kA*y1+kB*y2+kC*y3+kD*y4},ObjectDataParser.prototype._samplingEasingCurve=function(curve,samples){var curveCount=curve.length;if(curveCount%3==1){for(var stepIndex=-2,i=0,l=samples.length;i<l;++i){for(var t=(i+1)/(l+1);(stepIndex+6<curveCount?curve[stepIndex+6]:1)<t;)stepIndex+=6;for(var isInCurve=stepIndex>=0&&stepIndex+6<curveCount,x1=isInCurve?curve[stepIndex]:0,y1=isInCurve?curve[stepIndex+1]:0,x2=curve[stepIndex+2],y2=curve[stepIndex+3],x3=curve[stepIndex+4],y3=curve[stepIndex+5],x4=isInCurve?curve[stepIndex+6]:1,y4=isInCurve?curve[stepIndex+7]:1,lower=0,higher=1;higher-lower>1e-4;){var percentage=.5*(higher+lower);this._getCurvePoint(x1,y1,x2,y2,x3,y3,x4,y4,percentage,this._helpPoint),t-this._helpPoint.x>0?lower=percentage:higher=percentage}samples[i]=this._helpPoint.y}return!0}for(var stepIndex=0,i=0,l=samples.length;i<l;++i){for(var t=(i+1)/(l+1);curve[stepIndex+6]<t;)stepIndex+=6;for(var x1=curve[stepIndex],y1=curve[stepIndex+1],x2=curve[stepIndex+2],y2=curve[stepIndex+3],x3=curve[stepIndex+4],y3=curve[stepIndex+5],x4=curve[stepIndex+6],y4=curve[stepIndex+7],lower=0,higher=1;higher-lower>1e-4;){var percentage=.5*(higher+lower);this._getCurvePoint(x1,y1,x2,y2,x3,y3,x4,y4,percentage,this._helpPoint),t-this._helpPoint.x>0?lower=percentage:higher=percentage}samples[i]=this._helpPoint.y}return!1},ObjectDataParser.prototype._parseActionDataInFrame=function(rawData,frameStart,bone,slot){dragonBones.DataParser.EVENT in rawData&&this._mergeActionFrame(rawData[dragonBones.DataParser.EVENT],frameStart,10,bone,slot),dragonBones.DataParser.SOUND in rawData&&this._mergeActionFrame(rawData[dragonBones.DataParser.SOUND],frameStart,11,bone,slot),dragonBones.DataParser.ACTION in rawData&&this._mergeActionFrame(rawData[dragonBones.DataParser.ACTION],frameStart,0,bone,slot),dragonBones.DataParser.EVENTS in rawData&&this._mergeActionFrame(rawData[dragonBones.DataParser.EVENTS],frameStart,10,bone,slot),dragonBones.DataParser.ACTIONS in rawData&&this._mergeActionFrame(rawData[dragonBones.DataParser.ACTIONS],frameStart,0,bone,slot)},ObjectDataParser.prototype._mergeActionFrame=function(rawData,frameStart,type,bone,slot){for(var actionOffset=this._armature.actions.length,actions=this._parseActionData(rawData,type,bone,slot),frameIndex=0,frame=null,_i=0,actions_2=actions;_i<actions_2.length;_i++){var action=actions_2[_i];this._armature.addAction(action,!1)}0===this._actionFrames.length&&((frame=new ActionFrame).frameStart=0,this._actionFrames.push(frame),frame=null);for(var _a=0,_b=this._actionFrames;_a<_b.length;_a++){var eachFrame=_b[_a];if(eachFrame.frameStart===frameStart){frame=eachFrame;break}if(eachFrame.frameStart>frameStart)break;frameIndex++}null===frame&&((frame=new ActionFrame).frameStart=frameStart,this._actionFrames.splice(frameIndex,0,frame));for(var i=0;i<actions.length;++i)frame.actions.push(actionOffset+i)},ObjectDataParser.prototype._parseArmature=function(rawData,scale){var armature=dragonBones.BaseObject.borrowObject(dragonBones.ArmatureData);if(armature.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),armature.frameRate=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.FRAME_RATE,this._data.frameRate),armature.scale=scale,dragonBones.DataParser.TYPE in rawData&&"string"==typeof rawData[dragonBones.DataParser.TYPE]?armature.type=dragonBones.DataParser._getArmatureType(rawData[dragonBones.DataParser.TYPE]):armature.type=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.TYPE,0),0===armature.frameRate&&(armature.frameRate=24),this._armature=armature,dragonBones.DataParser.CANVAS in rawData){var rawCanvas=rawData[dragonBones.DataParser.CANVAS],canvas=dragonBones.BaseObject.borrowObject(dragonBones.CanvasData);dragonBones.DataParser.COLOR in rawCanvas?canvas.hasBackground=!0:canvas.hasBackground=!1,canvas.color=ObjectDataParser._getNumber(rawCanvas,dragonBones.DataParser.COLOR,0),canvas.x=ObjectDataParser._getNumber(rawCanvas,dragonBones.DataParser.X,0)*armature.scale,canvas.y=ObjectDataParser._getNumber(rawCanvas,dragonBones.DataParser.Y,0)*armature.scale,canvas.width=ObjectDataParser._getNumber(rawCanvas,dragonBones.DataParser.WIDTH,0)*armature.scale,canvas.height=ObjectDataParser._getNumber(rawCanvas,dragonBones.DataParser.HEIGHT,0)*armature.scale,armature.canvas=canvas}if(dragonBones.DataParser.AABB in rawData){var rawAABB=rawData[dragonBones.DataParser.AABB];armature.aabb.x=ObjectDataParser._getNumber(rawAABB,dragonBones.DataParser.X,0)*armature.scale,armature.aabb.y=ObjectDataParser._getNumber(rawAABB,dragonBones.DataParser.Y,0)*armature.scale,armature.aabb.width=ObjectDataParser._getNumber(rawAABB,dragonBones.DataParser.WIDTH,0)*armature.scale,armature.aabb.height=ObjectDataParser._getNumber(rawAABB,dragonBones.DataParser.HEIGHT,0)*armature.scale}if(dragonBones.DataParser.BONE in rawData)for(var rawBones,_i=0,rawBones_1=rawData[dragonBones.DataParser.BONE];_i<rawBones_1.length;_i++){var rawBone=rawBones_1[_i],parentName=ObjectDataParser._getString(rawBone,dragonBones.DataParser.PARENT,""),bone=this._parseBone(rawBone);if(parentName.length>0){var parent_1=armature.getBone(parentName);null!==parent_1?bone.parent=parent_1:(parentName in this._cacheBones||(this._cacheBones[parentName]=[]),this._cacheBones[parentName].push(bone))}if(bone.name in this._cacheBones){for(var _a=0,_b=this._cacheBones[bone.name];_a<_b.length;_a++){var child;_b[_a].parent=bone}delete this._cacheBones[bone.name]}armature.addBone(bone),this._rawBones.push(bone)}if(dragonBones.DataParser.IK in rawData)for(var rawIKS,_c=0,rawIKS_1=rawData[dragonBones.DataParser.IK];_c<rawIKS_1.length;_c++){var rawIK=rawIKS_1[_c],constraint;(constraint=this._parseIKConstraint(rawIK))&&armature.addConstraint(constraint)}if(armature.sortBones(),dragonBones.DataParser.SLOT in rawData)for(var zOrder=0,rawSlots,_d=0,rawSlots_1=rawData[dragonBones.DataParser.SLOT];_d<rawSlots_1.length;_d++){var rawSlot=rawSlots_1[_d];armature.addSlot(this._parseSlot(rawSlot,zOrder++))}if(dragonBones.DataParser.SKIN in rawData)for(var rawSkins,_e=0,rawSkins_1=rawData[dragonBones.DataParser.SKIN];_e<rawSkins_1.length;_e++){var rawSkin=rawSkins_1[_e];armature.addSkin(this._parseSkin(rawSkin))}if(dragonBones.DataParser.PATH_CONSTRAINT in rawData)for(var rawPaths,_f=0,rawPaths_1=rawData[dragonBones.DataParser.PATH_CONSTRAINT];_f<rawPaths_1.length;_f++){var rawPath=rawPaths_1[_f],constraint;(constraint=this._parsePathConstraint(rawPath))&&armature.addConstraint(constraint)}for(var i=0,l=this._cacheRawMeshes.length;i<l;++i){var rawData_1=this._cacheRawMeshes[i],shareName=ObjectDataParser._getString(rawData_1,dragonBones.DataParser.SHARE,"");if(0!==shareName.length){var skinName=ObjectDataParser._getString(rawData_1,dragonBones.DataParser.SKIN,dragonBones.DataParser.DEFAULT_NAME);0===skinName.length&&(skinName=dragonBones.DataParser.DEFAULT_NAME);var shareMesh=armature.getMesh(skinName,"",shareName),mesh;if(null!==shareMesh)this._cacheMeshes[i].geometry.shareFrom(shareMesh.geometry)}}if(dragonBones.DataParser.ANIMATION in rawData)for(var rawAnimations,_g=0,rawAnimations_1=rawData[dragonBones.DataParser.ANIMATION];_g<rawAnimations_1.length;_g++){var rawAnimation=rawAnimations_1[_g],animation=this._parseAnimation(rawAnimation);armature.addAnimation(animation)}if(dragonBones.DataParser.DEFAULT_ACTIONS in rawData)for(var actions,_h=0,actions_3=actions=this._parseActionData(rawData[dragonBones.DataParser.DEFAULT_ACTIONS],0,null,null);_h<actions_3.length;_h++){var action=actions_3[_h],animation;if(armature.addAction(action,!0),0===action.type)null!==(animation=armature.getAnimation(action.name))&&(armature.defaultAnimation=animation)}if(dragonBones.DataParser.ACTIONS in rawData)for(var actions,_j=0,actions_4=actions=this._parseActionData(rawData[dragonBones.DataParser.ACTIONS],0,null,null);_j<actions_4.length;_j++){var action=actions_4[_j];armature.addAction(action,!1)}for(var k in this._rawBones.length=0,this._cacheRawMeshes.length=0,this._cacheMeshes.length=0,this._armature=null,this._weightSlotPose)delete this._weightSlotPose[k];for(var k in this._weightBonePoses)delete this._weightBonePoses[k];for(var k in this._cacheBones)delete this._cacheBones[k];for(var k in this._slotChildActions)delete this._slotChildActions[k];return armature},ObjectDataParser.prototype._parseBone=function(rawData){var type=0;if(0===(type=dragonBones.DataParser.TYPE in rawData&&"string"==typeof rawData[dragonBones.DataParser.TYPE]?dragonBones.DataParser._getBoneType(rawData[dragonBones.DataParser.TYPE]):ObjectDataParser._getNumber(rawData,dragonBones.DataParser.TYPE,0))){var scale=this._armature.scale,bone=dragonBones.BaseObject.borrowObject(dragonBones.BoneData);return bone.inheritTranslation=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.INHERIT_TRANSLATION,!0),bone.inheritRotation=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.INHERIT_ROTATION,!0),bone.inheritScale=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.INHERIT_SCALE,!0),bone.inheritReflection=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.INHERIT_REFLECTION,!0),bone.length=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.LENGTH,0)*scale,bone.alpha=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ALPHA,1),bone.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),dragonBones.DataParser.TRANSFORM in rawData&&this._parseTransform(rawData[dragonBones.DataParser.TRANSFORM],bone.transform,scale),bone}var surface=dragonBones.BaseObject.borrowObject(dragonBones.SurfaceData);return surface.alpha=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ALPHA,1),surface.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),surface.segmentX=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SEGMENT_X,0),surface.segmentY=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SEGMENT_Y,0),this._parseGeometry(rawData,surface.geometry),surface},ObjectDataParser.prototype._parseIKConstraint=function(rawData){var bone=this._armature.getBone(ObjectDataParser._getString(rawData,dragonBones.DataParser.BONE,""));if(null===bone)return null;var target=this._armature.getBone(ObjectDataParser._getString(rawData,dragonBones.DataParser.TARGET,""));if(null===target)return null;var chain=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.CHAIN,0),constraint=dragonBones.BaseObject.borrowObject(dragonBones.IKConstraintData);return constraint.scaleEnabled=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.SCALE,!1),constraint.bendPositive=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.BEND_POSITIVE,!0),constraint.weight=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.WEIGHT,1),constraint.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),constraint.type=0,constraint.target=target,chain>0&&null!==bone.parent?(constraint.root=bone.parent,constraint.bone=bone):(constraint.root=bone,constraint.bone=null),constraint},ObjectDataParser.prototype._parsePathConstraint=function(rawData){var target=this._armature.getSlot(ObjectDataParser._getString(rawData,dragonBones.DataParser.TARGET,""));if(null===target)return null;var defaultSkin=this._armature.defaultSkin;if(null===defaultSkin)return null;var targetDisplay=defaultSkin.getDisplay(target.name,ObjectDataParser._getString(rawData,dragonBones.DataParser.TARGET_DISPLAY,target.name));if(null===targetDisplay||!(targetDisplay instanceof dragonBones.PathDisplayData))return null;var bones=rawData[dragonBones.DataParser.BONES];if(null===bones||0===bones.length)return null;var constraint=dragonBones.BaseObject.borrowObject(dragonBones.PathConstraintData);constraint.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),constraint.type=1,constraint.pathSlot=target,constraint.pathDisplayData=targetDisplay,constraint.target=target.parent,constraint.positionMode=dragonBones.DataParser._getPositionMode(ObjectDataParser._getString(rawData,dragonBones.DataParser.POSITION_MODE,"")),constraint.spacingMode=dragonBones.DataParser._getSpacingMode(ObjectDataParser._getString(rawData,dragonBones.DataParser.SPACING_MODE,"")),constraint.rotateMode=dragonBones.DataParser._getRotateMode(ObjectDataParser._getString(rawData,dragonBones.DataParser.ROTATE_MODE,"")),constraint.position=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.POSITION,0),constraint.spacing=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SPACING,0),constraint.rotateOffset=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ROTATE_OFFSET,0),constraint.rotateMix=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ROTATE_MIX,1),constraint.translateMix=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.TRANSLATE_MIX,1);for(var _i=0,bones_3=bones;_i<bones_3.length;_i++){var boneName=bones_3[_i],bone=this._armature.getBone(boneName);null!==bone&&(constraint.AddBone(bone),null===constraint.root&&(constraint.root=bone))}return constraint},ObjectDataParser.prototype._parseSlot=function(rawData,zOrder){var slot=dragonBones.BaseObject.borrowObject(dragonBones.SlotData);return slot.displayIndex=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.DISPLAY_INDEX,0),slot.zOrder=zOrder,slot.zIndex=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.Z_INDEX,0),slot.alpha=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ALPHA,1),slot.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),slot.parent=this._armature.getBone(ObjectDataParser._getString(rawData,dragonBones.DataParser.PARENT,"")),dragonBones.DataParser.BLEND_MODE in rawData&&"string"==typeof rawData[dragonBones.DataParser.BLEND_MODE]?slot.blendMode=dragonBones.DataParser._getBlendMode(rawData[dragonBones.DataParser.BLEND_MODE]):slot.blendMode=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.BLEND_MODE,0),dragonBones.DataParser.COLOR in rawData?(slot.color=dragonBones.SlotData.createColor(),this._parseColorTransform(rawData[dragonBones.DataParser.COLOR],slot.color)):slot.color=dragonBones.SlotData.DEFAULT_COLOR,dragonBones.DataParser.ACTIONS in rawData&&(this._slotChildActions[slot.name]=this._parseActionData(rawData[dragonBones.DataParser.ACTIONS],0,null,null)),slot},ObjectDataParser.prototype._parseSkin=function(rawData){var skin=dragonBones.BaseObject.borrowObject(dragonBones.SkinData);if(skin.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,dragonBones.DataParser.DEFAULT_NAME),0===skin.name.length&&(skin.name=dragonBones.DataParser.DEFAULT_NAME),dragonBones.DataParser.SLOT in rawData){var rawSlots=rawData[dragonBones.DataParser.SLOT];this._skin=skin;for(var _i=0,rawSlots_2=rawSlots;_i<rawSlots_2.length;_i++){var rawSlot=rawSlots_2[_i],slotName=ObjectDataParser._getString(rawSlot,dragonBones.DataParser.NAME,""),slot=this._armature.getSlot(slotName);if(null!==slot){if(this._slot=slot,dragonBones.DataParser.DISPLAY in rawSlot)for(var rawDisplays,_a=0,rawDisplays_1=rawSlot[dragonBones.DataParser.DISPLAY];_a<rawDisplays_1.length;_a++){var rawDisplay=rawDisplays_1[_a];rawDisplay?skin.addDisplay(slotName,this._parseDisplay(rawDisplay)):skin.addDisplay(slotName,null)}this._slot=null}}this._skin=null}return skin},ObjectDataParser.prototype._parseDisplay=function(rawData){var name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),path=ObjectDataParser._getString(rawData,dragonBones.DataParser.PATH,""),type=0,display=null;switch(type=dragonBones.DataParser.TYPE in rawData&&"string"==typeof rawData[dragonBones.DataParser.TYPE]?dragonBones.DataParser._getDisplayType(rawData[dragonBones.DataParser.TYPE]):ObjectDataParser._getNumber(rawData,dragonBones.DataParser.TYPE,type)){case 0:var imageDisplay=display=dragonBones.BaseObject.borrowObject(dragonBones.ImageDisplayData);imageDisplay.name=name,imageDisplay.path=path.length>0?path:name,this._parsePivot(rawData,imageDisplay);break;case 1:var armatureDisplay=display=dragonBones.BaseObject.borrowObject(dragonBones.ArmatureDisplayData);if(armatureDisplay.name=name,armatureDisplay.path=path.length>0?path:name,armatureDisplay.inheritAnimation=!0,dragonBones.DataParser.ACTIONS in rawData)for(var actions,_i=0,actions_5=this._parseActionData(rawData[dragonBones.DataParser.ACTIONS],0,null,null);_i<actions_5.length;_i++){var action=actions_5[_i];armatureDisplay.addAction(action)}else if(this._slot.name in this._slotChildActions){var displays=this._skin.getDisplays(this._slot.name);if(null===displays?0===this._slot.displayIndex:this._slot.displayIndex===displays.length){for(var _a=0,_b=this._slotChildActions[this._slot.name];_a<_b.length;_a++){var action=_b[_a];armatureDisplay.addAction(action)}delete this._slotChildActions[this._slot.name]}}break;case 2:var meshDisplay=display=dragonBones.BaseObject.borrowObject(dragonBones.MeshDisplayData);meshDisplay.geometry.inheritDeform=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.INHERIT_DEFORM,!0),meshDisplay.name=name,meshDisplay.path=path.length>0?path:name,dragonBones.DataParser.SHARE in rawData?(meshDisplay.geometry.data=this._data,this._cacheRawMeshes.push(rawData),this._cacheMeshes.push(meshDisplay)):this._parseMesh(rawData,meshDisplay);break;case 3:var boundingBox=this._parseBoundingBox(rawData);if(null!==boundingBox){var boundingBoxDisplay=display=dragonBones.BaseObject.borrowObject(dragonBones.BoundingBoxDisplayData);boundingBoxDisplay.name=name,boundingBoxDisplay.path=path.length>0?path:name,boundingBoxDisplay.boundingBox=boundingBox}break;case 4:var rawCurveLengths=rawData[dragonBones.DataParser.LENGTHS],pathDisplay=display=dragonBones.BaseObject.borrowObject(dragonBones.PathDisplayData);pathDisplay.closed=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.CLOSED,!1),pathDisplay.constantSpeed=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.CONSTANT_SPEED,!1),pathDisplay.name=name,pathDisplay.path=path.length>0?path:name,pathDisplay.curveLengths.length=rawCurveLengths.length;for(var i=0,l=rawCurveLengths.length;i<l;++i)pathDisplay.curveLengths[i]=rawCurveLengths[i];this._parsePath(rawData,pathDisplay)}return null!==display&&dragonBones.DataParser.TRANSFORM in rawData&&this._parseTransform(rawData[dragonBones.DataParser.TRANSFORM],display.transform,this._armature.scale),display},ObjectDataParser.prototype._parsePath=function(rawData,display){this._parseGeometry(rawData,display.geometry)},ObjectDataParser.prototype._parsePivot=function(rawData,display){if(dragonBones.DataParser.PIVOT in rawData){var rawPivot=rawData[dragonBones.DataParser.PIVOT];display.pivot.x=ObjectDataParser._getNumber(rawPivot,dragonBones.DataParser.X,0),display.pivot.y=ObjectDataParser._getNumber(rawPivot,dragonBones.DataParser.Y,0)}else display.pivot.x=.5,display.pivot.y=.5},ObjectDataParser.prototype._parseMesh=function(rawData,mesh){if(this._parseGeometry(rawData,mesh.geometry),dragonBones.DataParser.WEIGHTS in rawData){var rawSlotPose=rawData[dragonBones.DataParser.SLOT_POSE],rawBonePoses=rawData[dragonBones.DataParser.BONE_POSE],meshName=this._skin.name+"_"+this._slot.name+"_"+mesh.name;this._weightSlotPose[meshName]=rawSlotPose,this._weightBonePoses[meshName]=rawBonePoses}},ObjectDataParser.prototype._parseBoundingBox=function(rawData){var boundingBox=null,type=0;switch(type=dragonBones.DataParser.SUB_TYPE in rawData&&"string"==typeof rawData[dragonBones.DataParser.SUB_TYPE]?dragonBones.DataParser._getBoundingBoxType(rawData[dragonBones.DataParser.SUB_TYPE]):ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SUB_TYPE,type)){case 0:boundingBox=dragonBones.BaseObject.borrowObject(dragonBones.RectangleBoundingBoxData);break;case 1:boundingBox=dragonBones.BaseObject.borrowObject(dragonBones.EllipseBoundingBoxData);break;case 2:boundingBox=this._parsePolygonBoundingBox(rawData)}return null!==boundingBox&&(boundingBox.color=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.COLOR,0),0!==boundingBox.type&&1!==boundingBox.type||(boundingBox.width=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.WIDTH,0),boundingBox.height=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.HEIGHT,0))),boundingBox},ObjectDataParser.prototype._parsePolygonBoundingBox=function(rawData){var polygonBoundingBox=dragonBones.BaseObject.borrowObject(dragonBones.PolygonBoundingBoxData);if(dragonBones.DataParser.VERTICES in rawData){var scale=this._armature.scale,rawVertices=rawData[dragonBones.DataParser.VERTICES],vertices=polygonBoundingBox.vertices;vertices.length=rawVertices.length;for(var i=0,l=rawVertices.length;i<l;i+=2){var x=rawVertices[i]*scale,y=rawVertices[i+1]*scale;vertices[i]=x,vertices[i+1]=y,0===i?(polygonBoundingBox.x=x,polygonBoundingBox.y=y,polygonBoundingBox.width=x,polygonBoundingBox.height=y):(x<polygonBoundingBox.x?polygonBoundingBox.x=x:x>polygonBoundingBox.width&&(polygonBoundingBox.width=x),y<polygonBoundingBox.y?polygonBoundingBox.y=y:y>polygonBoundingBox.height&&(polygonBoundingBox.height=y))}polygonBoundingBox.width-=polygonBoundingBox.x,polygonBoundingBox.height-=polygonBoundingBox.y}else console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.");return polygonBoundingBox},ObjectDataParser.prototype._parseAnimation=function(rawData){var animation=dragonBones.BaseObject.borrowObject(dragonBones.AnimationData);if(animation.blendType=dragonBones.DataParser._getAnimationBlendType(ObjectDataParser._getString(rawData,dragonBones.DataParser.BLEND_TYPE,"")),animation.frameCount=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.DURATION,0),animation.playTimes=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.PLAY_TIMES,1),animation.duration=animation.frameCount/this._armature.frameRate,animation.fadeInTime=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.FADE_IN_TIME,0),animation.scale=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SCALE,1),animation.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,dragonBones.DataParser.DEFAULT_NAME),0===animation.name.length&&(animation.name=dragonBones.DataParser.DEFAULT_NAME),animation.frameIntOffset=this._frameIntArray.length,animation.frameFloatOffset=this._frameFloatArray.length,animation.frameOffset=this._frameArray.length,this._animation=animation,dragonBones.DataParser.FRAME in rawData){var rawFrames=rawData[dragonBones.DataParser.FRAME],keyFrameCount=rawFrames.length;if(keyFrameCount>0)for(var i=0,frameStart=0;i<keyFrameCount;++i){var rawFrame=rawFrames[i];this._parseActionDataInFrame(rawFrame,frameStart,null,null),frameStart+=ObjectDataParser._getNumber(rawFrame,dragonBones.DataParser.DURATION,1)}}if(dragonBones.DataParser.Z_ORDER in rawData&&(this._animation.zOrderTimeline=this._parseTimeline(rawData[dragonBones.DataParser.Z_ORDER],null,dragonBones.DataParser.FRAME,1,0,0,this._parseZOrderFrame)),dragonBones.DataParser.BONE in rawData)for(var rawTimelines,_i=0,rawTimelines_1=rawTimelines=rawData[dragonBones.DataParser.BONE];_i<rawTimelines_1.length;_i++){var rawTimeline=rawTimelines_1[_i];this._parseBoneTimeline(rawTimeline)}if(dragonBones.DataParser.SLOT in rawData)for(var rawTimelines,_a=0,rawTimelines_2=rawTimelines=rawData[dragonBones.DataParser.SLOT];_a<rawTimelines_2.length;_a++){var rawTimeline=rawTimelines_2[_a];this._parseSlotTimeline(rawTimeline)}if(dragonBones.DataParser.FFD in rawData)for(var rawTimelines,_b=0,rawTimelines_3=rawTimelines=rawData[dragonBones.DataParser.FFD];_b<rawTimelines_3.length;_b++){var rawTimeline=rawTimelines_3[_b],skinName=ObjectDataParser._getString(rawTimeline,dragonBones.DataParser.SKIN,dragonBones.DataParser.DEFAULT_NAME),slotName=ObjectDataParser._getString(rawTimeline,dragonBones.DataParser.SLOT,""),displayName=ObjectDataParser._getString(rawTimeline,dragonBones.DataParser.NAME,""),timeline;if(0===skinName.length&&(skinName=dragonBones.DataParser.DEFAULT_NAME),this._slot=this._armature.getSlot(slotName),this._mesh=this._armature.getMesh(skinName,slotName,displayName),null!==this._slot&&null!==this._mesh)null!==(timeline=this._parseTimeline(rawTimeline,null,dragonBones.DataParser.FRAME,22,2,0,this._parseSlotDeformFrame))&&this._animation.addSlotTimeline(slotName,timeline),this._slot=null,this._mesh=null}if(dragonBones.DataParser.IK in rawData)for(var rawTimelines,_c=0,rawTimelines_4=rawTimelines=rawData[dragonBones.DataParser.IK];_c<rawTimelines_4.length;_c++){var rawTimeline=rawTimelines_4[_c],constraintName=ObjectDataParser._getString(rawTimeline,dragonBones.DataParser.NAME,""),constraint,timeline;if(null!==this._armature.getConstraint(constraintName))null!==(timeline=this._parseTimeline(rawTimeline,null,dragonBones.DataParser.FRAME,30,1,2,this._parseIKConstraintFrame))&&this._animation.addConstraintTimeline(constraintName,timeline)}if(this._actionFrames.length>0&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,0,0,this._parseActionFrame),this._actionFrames.length=0),dragonBones.DataParser.TIMELINE in rawData)for(var rawTimelines,_d=0,rawTimelines_5=rawTimelines=rawData[dragonBones.DataParser.TIMELINE];_d<rawTimelines_5.length;_d++){var rawTimeline=rawTimelines_5[_d],timelineType=ObjectDataParser._getNumber(rawTimeline,dragonBones.DataParser.TYPE,0),timelineName=ObjectDataParser._getString(rawTimeline,dragonBones.DataParser.NAME,""),timeline=null;switch(timelineType){case 0:break;case 20:case 23:case 60:case 24:case 40:case 41:if(20===timelineType?(this._frameValueType=0,this._frameValueScale=1):(this._frameValueType=1,this._frameValueScale=23===timelineType?1:40===timelineType||41===timelineType?1e4:100),this._frameDefaultValue=60===timelineType||24===timelineType||41===timelineType?1:0,40===timelineType&&0!==animation.blendType){var animaitonTimeline=timeline=dragonBones.BaseObject.borrowObject(dragonBones.AnimationTimelineData);animaitonTimeline.x=ObjectDataParser._getNumber(rawTimeline,dragonBones.DataParser.X,0),animaitonTimeline.y=ObjectDataParser._getNumber(rawTimeline,dragonBones.DataParser.Y,0)}timeline=this._parseTimeline(rawTimeline,null,dragonBones.DataParser.FRAME,timelineType,this._frameValueType,1,this._parseSingleValueFrame,timeline);break;case 11:case 12:case 13:case 30:case 42:30===timelineType||42===timelineType?(this._frameValueType=1,this._frameValueScale=42===timelineType?1e4:100):(this._frameValueScale=12===timelineType?dragonBones.Transform.DEG_RAD:1,this._frameValueType=2),this._frameDefaultValue=13===timelineType||30===timelineType?1:0,timeline=this._parseTimeline(rawTimeline,null,dragonBones.DataParser.FRAME,timelineType,this._frameValueType,2,this._parseDoubleValueFrame);break;case 1:break;case 50:var surface=this._armature.getBone(timelineName);if(null===surface)continue;this._geometry=surface.geometry,timeline=this._parseTimeline(rawTimeline,null,dragonBones.DataParser.FRAME,timelineType,2,0,this._parseDeformFrame),this._geometry=null;break;case 22:for(var skinName in this._geometry=null,this._armature.skins){var skin=this._armature.skins[skinName];for(var slontName in skin.displays)for(var displays,_e=0,displays_1=skin.displays[slontName];_e<displays_1.length;_e++){var display=displays_1[_e];if(null!==display&&display.name===timelineName){this._geometry=display.geometry;break}}}if(null===this._geometry)continue;timeline=this._parseTimeline(rawTimeline,null,dragonBones.DataParser.FRAME,timelineType,2,0,this._parseDeformFrame),this._geometry=null;break;case 21:timeline=this._parseTimeline(rawTimeline,null,dragonBones.DataParser.FRAME,timelineType,1,1,this._parseSlotColorFrame)}if(null!==timeline)switch(timelineType){case 0:case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(timelineName,timeline);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(timelineName,timeline);break;case 30:this._animation.addConstraintTimeline(timelineName,timeline);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(timelineName,timeline)}}return this._animation=null,animation},ObjectDataParser.prototype._parseTimeline=function(rawData,rawFrames,framesKey,timelineType,frameValueType,frameValueCount,frameParser,timeline){if(void 0===timeline&&(timeline=null),null!==rawData&&framesKey.length>0&&framesKey in rawData&&(rawFrames=rawData[framesKey]),null===rawFrames)return null;var keyFrameCount=rawFrames.length;if(0===keyFrameCount)return null;var frameIntArrayLength=this._frameIntArray.length,frameFloatArrayLength=this._frameFloatArray.length,timelineOffset=this._timelineArray.length;switch(null===timeline&&(timeline=dragonBones.BaseObject.borrowObject(dragonBones.TimelineData)),timeline.type=timelineType,timeline.offset=timelineOffset,this._frameValueType=frameValueType,this._timeline=timeline,this._timelineArray.length+=5+keyFrameCount,null!==rawData?(this._timelineArray[timelineOffset+0]=Math.round(100*ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SCALE,1)),this._timelineArray[timelineOffset+1]=Math.round(100*ObjectDataParser._getNumber(rawData,dragonBones.DataParser.OFFSET,0))):(this._timelineArray[timelineOffset+0]=100,this._timelineArray[timelineOffset+1]=0),this._timelineArray[timelineOffset+2]=keyFrameCount,this._timelineArray[timelineOffset+3]=frameValueCount,this._frameValueType){case 0:this._timelineArray[timelineOffset+4]=0;break;case 1:this._timelineArray[timelineOffset+4]=frameIntArrayLength-this._animation.frameIntOffset;break;case 2:this._timelineArray[timelineOffset+4]=frameFloatArrayLength-this._animation.frameFloatOffset}if(1===keyFrameCount)timeline.frameIndicesOffset=-1,this._timelineArray[timelineOffset+5+0]=frameParser.call(this,rawFrames[0],0,0)-this._animation.frameOffset;else{var totalFrameCount=this._animation.frameCount+1,frameIndices=this._data.frameIndices,frameIndicesOffset=frameIndices.length;frameIndices.length+=totalFrameCount,timeline.frameIndicesOffset=frameIndicesOffset;for(var i=0,iK=0,frameStart=0,frameCount=0;i<totalFrameCount;++i){if(frameStart+frameCount<=i&&iK<keyFrameCount){var rawFrame=rawFrames[iK];frameStart=i,frameCount=iK===keyFrameCount-1?this._animation.frameCount-frameStart:rawFrame instanceof ActionFrame?this._actionFrames[iK+1].frameStart-frameStart:ObjectDataParser._getNumber(rawFrame,dragonBones.DataParser.DURATION,1),this._timelineArray[timelineOffset+5+iK]=frameParser.call(this,rawFrame,frameStart,frameCount)-this._animation.frameOffset,iK++}frameIndices[frameIndicesOffset+i]=iK-1}}return this._timeline=null,timeline},ObjectDataParser.prototype._parseBoneTimeline=function(rawData){var bone=this._armature.getBone(ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""));if(null!==bone){var timeline,timeline,timeline,timeline;if(this._bone=bone,this._slot=this._armature.getSlot(this._bone.name),dragonBones.DataParser.TRANSLATE_FRAME in rawData)this._frameDefaultValue=0,this._frameValueScale=1,null!==(timeline=this._parseTimeline(rawData,null,dragonBones.DataParser.TRANSLATE_FRAME,11,2,2,this._parseDoubleValueFrame))&&this._animation.addBoneTimeline(bone.name,timeline);if(dragonBones.DataParser.ROTATE_FRAME in rawData)this._frameDefaultValue=0,this._frameValueScale=1,null!==(timeline=this._parseTimeline(rawData,null,dragonBones.DataParser.ROTATE_FRAME,12,2,2,this._parseBoneRotateFrame))&&this._animation.addBoneTimeline(bone.name,timeline);if(dragonBones.DataParser.SCALE_FRAME in rawData)this._frameDefaultValue=1,this._frameValueScale=1,null!==(timeline=this._parseTimeline(rawData,null,dragonBones.DataParser.SCALE_FRAME,13,2,2,this._parseBoneScaleFrame))&&this._animation.addBoneTimeline(bone.name,timeline);if(dragonBones.DataParser.FRAME in rawData)null!==(timeline=this._parseTimeline(rawData,null,dragonBones.DataParser.FRAME,10,2,6,this._parseBoneAllFrame))&&this._animation.addBoneTimeline(bone.name,timeline);this._bone=null,this._slot=null}},ObjectDataParser.prototype._parseSlotTimeline=function(rawData){var slot=this._armature.getSlot(ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""));if(null!==slot){var displayTimeline=null,colorTimeline=null;this._slot=slot,displayTimeline=dragonBones.DataParser.DISPLAY_FRAME in rawData?this._parseTimeline(rawData,null,dragonBones.DataParser.DISPLAY_FRAME,20,0,0,this._parseSlotDisplayFrame):this._parseTimeline(rawData,null,dragonBones.DataParser.FRAME,20,0,0,this._parseSlotDisplayFrame),colorTimeline=dragonBones.DataParser.COLOR_FRAME in rawData?this._parseTimeline(rawData,null,dragonBones.DataParser.COLOR_FRAME,21,1,1,this._parseSlotColorFrame):this._parseTimeline(rawData,null,dragonBones.DataParser.FRAME,21,1,1,this._parseSlotColorFrame),null!==displayTimeline&&this._animation.addSlotTimeline(slot.name,displayTimeline),null!==colorTimeline&&this._animation.addSlotTimeline(slot.name,colorTimeline),this._slot=null}},ObjectDataParser.prototype._parseFrame=function(rawData,frameStart,frameCount){var frameOffset=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[frameOffset+0]=frameStart,frameOffset},ObjectDataParser.prototype._parseTweenFrame=function(rawData,frameStart,frameCount){var frameOffset=this._parseFrame(rawData,frameStart,frameCount);if(frameCount>0)if(dragonBones.DataParser.CURVE in rawData){var sampleCount=frameCount+1;this._helpArray.length=sampleCount;var isOmited=this._samplingEasingCurve(rawData[dragonBones.DataParser.CURVE],this._helpArray);this._frameArray.length+=2+this._helpArray.length,this._frameArray[frameOffset+1]=2,this._frameArray[frameOffset+2]=isOmited?sampleCount:-sampleCount;for(var i=0;i<sampleCount;++i)this._frameArray[frameOffset+3+i]=Math.round(1e4*this._helpArray[i])}else{var noTween=-2,tweenEasing=-2;dragonBones.DataParser.TWEEN_EASING in rawData&&(tweenEasing=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.TWEEN_EASING,-2)),-2===tweenEasing?(this._frameArray.length+=1,this._frameArray[frameOffset+1]=0):0===tweenEasing?(this._frameArray.length+=1,this._frameArray[frameOffset+1]=1):tweenEasing<0?(this._frameArray.length+=2,this._frameArray[frameOffset+1]=3,this._frameArray[frameOffset+2]=Math.round(100*-tweenEasing)):tweenEasing<=1?(this._frameArray.length+=2,this._frameArray[frameOffset+1]=4,this._frameArray[frameOffset+2]=Math.round(100*tweenEasing)):(this._frameArray.length+=2,this._frameArray[frameOffset+1]=5,this._frameArray[frameOffset+2]=Math.round(100*tweenEasing-100))}else this._frameArray.length+=1,this._frameArray[frameOffset+1]=0;return frameOffset},ObjectDataParser.prototype._parseSingleValueFrame=function(rawData,frameStart,frameCount){var frameOffset=0;switch(this._frameValueType){case 0:frameOffset=this._parseFrame(rawData,frameStart,frameCount),this._frameArray.length+=1,this._frameArray[frameOffset+1]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.VALUE,this._frameDefaultValue);break;case 1:frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount);var frameValueOffset=this._frameIntArray.length;this._frameIntArray.length+=1,this._frameIntArray[frameValueOffset]=Math.round(ObjectDataParser._getNumber(rawData,dragonBones.DataParser.VALUE,this._frameDefaultValue)*this._frameValueScale);break;case 2:frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount);var frameValueOffset=this._frameFloatArray.length;this._frameFloatArray.length+=1,this._frameFloatArray[frameValueOffset]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.VALUE,this._frameDefaultValue)*this._frameValueScale}return frameOffset},ObjectDataParser.prototype._parseDoubleValueFrame=function(rawData,frameStart,frameCount){var frameOffset=0;switch(this._frameValueType){case 0:frameOffset=this._parseFrame(rawData,frameStart,frameCount),this._frameArray.length+=2,this._frameArray[frameOffset+1]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.X,this._frameDefaultValue),this._frameArray[frameOffset+2]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.Y,this._frameDefaultValue);break;case 1:frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount);var frameValueOffset=this._frameIntArray.length;this._frameIntArray.length+=2,this._frameIntArray[frameValueOffset]=Math.round(ObjectDataParser._getNumber(rawData,dragonBones.DataParser.X,this._frameDefaultValue)*this._frameValueScale),this._frameIntArray[frameValueOffset+1]=Math.round(ObjectDataParser._getNumber(rawData,dragonBones.DataParser.Y,this._frameDefaultValue)*this._frameValueScale);break;case 2:frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount);var frameValueOffset=this._frameFloatArray.length;this._frameFloatArray.length+=2,this._frameFloatArray[frameValueOffset]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.X,this._frameDefaultValue)*this._frameValueScale,this._frameFloatArray[frameValueOffset+1]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.Y,this._frameDefaultValue)*this._frameValueScale}return frameOffset},ObjectDataParser.prototype._parseActionFrame=function(frame,frameStart,frameCount){var frameOffset=this._frameArray.length,actionCount=frame.actions.length;this._frameArray.length+=2+actionCount,this._frameArray[frameOffset+0]=frameStart,this._frameArray[frameOffset+0+1]=actionCount;for(var i=0;i<actionCount;++i)this._frameArray[frameOffset+0+2+i]=frame.actions[i];return frameOffset},ObjectDataParser.prototype._parseZOrderFrame=function(rawData,frameStart,frameCount){var frameOffset=this._parseFrame(rawData,frameStart,frameCount);if(dragonBones.DataParser.Z_ORDER in rawData){var rawZOrder=rawData[dragonBones.DataParser.Z_ORDER];if(rawZOrder.length>0){for(var slotCount=this._armature.sortedSlots.length,unchanged=new Array(slotCount-rawZOrder.length/2),zOrders=new Array(slotCount),i_1=0;i_1<unchanged.length;++i_1)unchanged[i_1]=0;for(var i_2=0;i_2<slotCount;++i_2)zOrders[i_2]=-1;for(var originalIndex=0,unchangedIndex=0,i_3=0,l=rawZOrder.length;i_3<l;i_3+=2){for(var slotIndex=rawZOrder[i_3],zOrderOffset=rawZOrder[i_3+1];originalIndex!==slotIndex;)unchanged[unchangedIndex++]=originalIndex++;var index;zOrders[originalIndex+zOrderOffset]=originalIndex++}for(;originalIndex<slotCount;)unchanged[unchangedIndex++]=originalIndex++;this._frameArray.length+=1+slotCount,this._frameArray[frameOffset+1]=slotCount;for(var i=slotCount;i--;)-1===zOrders[i]?this._frameArray[frameOffset+2+i]=unchanged[--unchangedIndex]||0:this._frameArray[frameOffset+2+i]=zOrders[i]||0;return frameOffset}}return this._frameArray.length+=1,this._frameArray[frameOffset+1]=0,frameOffset},ObjectDataParser.prototype._parseBoneAllFrame=function(rawData,frameStart,frameCount){this._helpTransform.identity(),dragonBones.DataParser.TRANSFORM in rawData&&this._parseTransform(rawData[dragonBones.DataParser.TRANSFORM],this._helpTransform,1);var rotation=this._helpTransform.rotation;0!==frameStart&&(0===this._prevClockwise?rotation=this._prevRotation+dragonBones.Transform.normalizeRadian(rotation-this._prevRotation):((this._prevClockwise>0?rotation>=this._prevRotation:rotation<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),rotation=this._prevRotation+rotation-this._prevRotation+dragonBones.Transform.PI_D*this._prevClockwise)),this._prevClockwise=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.TWEEN_ROTATE,0),this._prevRotation=rotation;var frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount),frameFloatOffset=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[frameFloatOffset++]=this._helpTransform.x,this._frameFloatArray[frameFloatOffset++]=this._helpTransform.y,this._frameFloatArray[frameFloatOffset++]=rotation,this._frameFloatArray[frameFloatOffset++]=this._helpTransform.skew,this._frameFloatArray[frameFloatOffset++]=this._helpTransform.scaleX,this._frameFloatArray[frameFloatOffset++]=this._helpTransform.scaleY,this._parseActionDataInFrame(rawData,frameStart,this._bone,this._slot),frameOffset},ObjectDataParser.prototype._parseBoneTranslateFrame=function(rawData,frameStart,frameCount){var frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount),frameFloatOffset=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[frameFloatOffset++]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.X,0),this._frameFloatArray[frameFloatOffset++]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.Y,0),frameOffset},ObjectDataParser.prototype._parseBoneRotateFrame=function(rawData,frameStart,frameCount){var rotation=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ROTATE,0)*dragonBones.Transform.DEG_RAD;0!==frameStart&&(0===this._prevClockwise?rotation=this._prevRotation+dragonBones.Transform.normalizeRadian(rotation-this._prevRotation):((this._prevClockwise>0?rotation>=this._prevRotation:rotation<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),rotation=this._prevRotation+rotation-this._prevRotation+dragonBones.Transform.PI_D*this._prevClockwise)),this._prevClockwise=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.CLOCK_WISE,0),this._prevRotation=rotation;var frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount),frameFloatOffset=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[frameFloatOffset++]=rotation,this._frameFloatArray[frameFloatOffset++]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SKEW,0)*dragonBones.Transform.DEG_RAD,frameOffset},ObjectDataParser.prototype._parseBoneScaleFrame=function(rawData,frameStart,frameCount){var frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount),frameFloatOffset=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[frameFloatOffset++]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.X,1),this._frameFloatArray[frameFloatOffset++]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.Y,1),frameOffset},ObjectDataParser.prototype._parseSlotDisplayFrame=function(rawData,frameStart,frameCount){var frameOffset=this._parseFrame(rawData,frameStart,frameCount);return this._frameArray.length+=1,dragonBones.DataParser.VALUE in rawData?this._frameArray[frameOffset+1]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.VALUE,0):this._frameArray[frameOffset+1]=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.DISPLAY_INDEX,0),this._parseActionDataInFrame(rawData,frameStart,this._slot.parent,this._slot),frameOffset},ObjectDataParser.prototype._parseSlotColorFrame=function(rawData,frameStart,frameCount){var frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount),colorOffset=-1;if(dragonBones.DataParser.VALUE in rawData||dragonBones.DataParser.COLOR in rawData){var rawColor=dragonBones.DataParser.VALUE in rawData?rawData[dragonBones.DataParser.VALUE]:rawData[dragonBones.DataParser.COLOR];for(var k in rawColor){this._parseColorTransform(rawColor,this._helpColorTransform),colorOffset=this._colorArray.length,this._colorArray.length+=8,this._colorArray[colorOffset++]=Math.round(100*this._helpColorTransform.alphaMultiplier),this._colorArray[colorOffset++]=Math.round(100*this._helpColorTransform.redMultiplier),this._colorArray[colorOffset++]=Math.round(100*this._helpColorTransform.greenMultiplier),this._colorArray[colorOffset++]=Math.round(100*this._helpColorTransform.blueMultiplier),this._colorArray[colorOffset++]=Math.round(this._helpColorTransform.alphaOffset),this._colorArray[colorOffset++]=Math.round(this._helpColorTransform.redOffset),this._colorArray[colorOffset++]=Math.round(this._helpColorTransform.greenOffset),this._colorArray[colorOffset++]=Math.round(this._helpColorTransform.blueOffset),colorOffset-=8;break}}colorOffset<0&&(this._defaultColorOffset<0&&(this._defaultColorOffset=colorOffset=this._colorArray.length,this._colorArray.length+=8,this._colorArray[colorOffset++]=100,this._colorArray[colorOffset++]=100,this._colorArray[colorOffset++]=100,this._colorArray[colorOffset++]=100,this._colorArray[colorOffset++]=0,this._colorArray[colorOffset++]=0,this._colorArray[colorOffset++]=0,this._colorArray[colorOffset++]=0),colorOffset=this._defaultColorOffset);var frameIntOffset=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[frameIntOffset]=colorOffset,frameOffset},ObjectDataParser.prototype._parseSlotDeformFrame=function(rawData,frameStart,frameCount){var frameFloatOffset=this._frameFloatArray.length,frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount),rawVertices=dragonBones.DataParser.VERTICES in rawData?rawData[dragonBones.DataParser.VERTICES]:null,offset=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.OFFSET,0),vertexCount=this._intArray[this._mesh.geometry.offset+0],meshName=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name,weight=this._mesh.geometry.weight,x=0,y=0,iB=0,iV=0;if(null!==weight){var rawSlotPose=this._weightSlotPose[meshName];this._helpMatrixA.copyFromArray(rawSlotPose,0),this._frameFloatArray.length+=2*weight.count,iB=weight.offset+2+weight.bones.length}else this._frameFloatArray.length+=2*vertexCount;for(var i=0;i<2*vertexCount;i+=2)if(null===rawVertices?(x=0,y=0):(x=i<offset||i-offset>=rawVertices.length?0:rawVertices[i-offset],y=i+1<offset||i+1-offset>=rawVertices.length?0:rawVertices[i+1-offset]),null!==weight){var rawBonePoses=this._weightBonePoses[meshName],vertexBoneCount=this._intArray[iB++];this._helpMatrixA.transformPoint(x,y,this._helpPoint,!0),x=this._helpPoint.x,y=this._helpPoint.y;for(var j=0;j<vertexBoneCount;++j){var boneIndex=this._intArray[iB++];this._helpMatrixB.copyFromArray(rawBonePoses,7*boneIndex+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(x,y,this._helpPoint,!0),this._frameFloatArray[frameFloatOffset+iV++]=this._helpPoint.x,this._frameFloatArray[frameFloatOffset+iV++]=this._helpPoint.y}}else this._frameFloatArray[frameFloatOffset+i]=x,this._frameFloatArray[frameFloatOffset+i+1]=y;if(0===frameStart){var frameIntOffset=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[frameIntOffset+0]=this._mesh.geometry.offset,this._frameIntArray[frameIntOffset+1]=this._frameFloatArray.length-frameFloatOffset,this._frameIntArray[frameIntOffset+2]=this._frameFloatArray.length-frameFloatOffset,this._frameIntArray[frameIntOffset+3]=0,this._frameIntArray[frameIntOffset+4]=frameFloatOffset-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=frameIntOffset-this._animation.frameIntOffset}return frameOffset},ObjectDataParser.prototype._parseIKConstraintFrame=function(rawData,frameStart,frameCount){var frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount),frameIntOffset=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[frameIntOffset++]=ObjectDataParser._getBoolean(rawData,dragonBones.DataParser.BEND_POSITIVE,!0)?1:0,this._frameIntArray[frameIntOffset++]=Math.round(100*ObjectDataParser._getNumber(rawData,dragonBones.DataParser.WEIGHT,1)),frameOffset},ObjectDataParser.prototype._parseActionData=function(rawData,type,bone,slot){var actions=new Array,action;if("string"==typeof rawData)(action=dragonBones.BaseObject.borrowObject(dragonBones.ActionData)).type=type,action.name=rawData,action.bone=bone,action.slot=slot,actions.push(action);else if(rawData instanceof Array)for(var _i=0,rawData_2=rawData;_i<rawData_2.length;_i++){var rawAction=rawData_2[_i],action=dragonBones.BaseObject.borrowObject(dragonBones.ActionData);if(dragonBones.DataParser.GOTO_AND_PLAY in rawAction?(action.type=0,action.name=ObjectDataParser._getString(rawAction,dragonBones.DataParser.GOTO_AND_PLAY,"")):(dragonBones.DataParser.TYPE in rawAction&&"string"==typeof rawAction[dragonBones.DataParser.TYPE]?action.type=dragonBones.DataParser._getActionType(rawAction[dragonBones.DataParser.TYPE]):action.type=ObjectDataParser._getNumber(rawAction,dragonBones.DataParser.TYPE,type),action.name=ObjectDataParser._getString(rawAction,dragonBones.DataParser.NAME,"")),dragonBones.DataParser.BONE in rawAction){var boneName=ObjectDataParser._getString(rawAction,dragonBones.DataParser.BONE,"");action.bone=this._armature.getBone(boneName)}else action.bone=bone;if(dragonBones.DataParser.SLOT in rawAction){var slotName=ObjectDataParser._getString(rawAction,dragonBones.DataParser.SLOT,"");action.slot=this._armature.getSlot(slotName)}else action.slot=slot;var userData=null;if(dragonBones.DataParser.INTS in rawAction){null===userData&&(userData=dragonBones.BaseObject.borrowObject(dragonBones.UserData));for(var rawInts,_a=0,rawInts_1=rawAction[dragonBones.DataParser.INTS];_a<rawInts_1.length;_a++){var rawValue=rawInts_1[_a];userData.addInt(rawValue)}}if(dragonBones.DataParser.FLOATS in rawAction){null===userData&&(userData=dragonBones.BaseObject.borrowObject(dragonBones.UserData));for(var rawFloats,_b=0,rawFloats_1=rawAction[dragonBones.DataParser.FLOATS];_b<rawFloats_1.length;_b++){var rawValue=rawFloats_1[_b];userData.addFloat(rawValue)}}if(dragonBones.DataParser.STRINGS in rawAction){null===userData&&(userData=dragonBones.BaseObject.borrowObject(dragonBones.UserData));for(var rawStrings,_c=0,rawStrings_1=rawAction[dragonBones.DataParser.STRINGS];_c<rawStrings_1.length;_c++){var rawValue=rawStrings_1[_c];userData.addString(rawValue)}}action.data=userData,actions.push(action)}return actions},ObjectDataParser.prototype._parseDeformFrame=function(rawData,frameStart,frameCount){var frameFloatOffset=this._frameFloatArray.length,frameOffset=this._parseTweenFrame(rawData,frameStart,frameCount),rawVertices=dragonBones.DataParser.VERTICES in rawData?rawData[dragonBones.DataParser.VERTICES]:dragonBones.DataParser.VALUE in rawData?rawData[dragonBones.DataParser.VALUE]:null,offset=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.OFFSET,0),vertexCount=this._intArray[this._geometry.offset+0],weight,x=0,y=0;if(null!==this._geometry.weight);else{this._frameFloatArray.length+=2*vertexCount;for(var i=0;i<2*vertexCount;i+=2)null!==rawVertices?(x=i<offset||i-offset>=rawVertices.length?0:rawVertices[i-offset],y=i+1<offset||i+1-offset>=rawVertices.length?0:rawVertices[i+1-offset]):(x=0,y=0),this._frameFloatArray[frameFloatOffset+i]=x,this._frameFloatArray[frameFloatOffset+i+1]=y}if(0===frameStart){var frameIntOffset=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[frameIntOffset+0]=this._geometry.offset,this._frameIntArray[frameIntOffset+1]=this._frameFloatArray.length-frameFloatOffset,this._frameIntArray[frameIntOffset+2]=this._frameFloatArray.length-frameFloatOffset,this._frameIntArray[frameIntOffset+3]=0,this._frameIntArray[frameIntOffset+4]=frameFloatOffset-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=frameIntOffset-this._animation.frameIntOffset}return frameOffset},ObjectDataParser.prototype._parseTransform=function(rawData,transform,scale){transform.x=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.X,0)*scale,transform.y=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.Y,0)*scale,dragonBones.DataParser.ROTATE in rawData||dragonBones.DataParser.SKEW in rawData?(transform.rotation=dragonBones.Transform.normalizeRadian(ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ROTATE,0)*dragonBones.Transform.DEG_RAD),transform.skew=dragonBones.Transform.normalizeRadian(ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SKEW,0)*dragonBones.Transform.DEG_RAD)):(dragonBones.DataParser.SKEW_X in rawData||dragonBones.DataParser.SKEW_Y in rawData)&&(transform.rotation=dragonBones.Transform.normalizeRadian(ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SKEW_Y,0)*dragonBones.Transform.DEG_RAD),transform.skew=dragonBones.Transform.normalizeRadian(ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SKEW_X,0)*dragonBones.Transform.DEG_RAD)-transform.rotation),transform.scaleX=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SCALE_X,1),transform.scaleY=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SCALE_Y,1)},ObjectDataParser.prototype._parseColorTransform=function(rawData,color){color.alphaMultiplier=.01*ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ALPHA_MULTIPLIER,100),color.redMultiplier=.01*ObjectDataParser._getNumber(rawData,dragonBones.DataParser.RED_MULTIPLIER,100),color.greenMultiplier=.01*ObjectDataParser._getNumber(rawData,dragonBones.DataParser.GREEN_MULTIPLIER,100),color.blueMultiplier=.01*ObjectDataParser._getNumber(rawData,dragonBones.DataParser.BLUE_MULTIPLIER,100),color.alphaOffset=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.ALPHA_OFFSET,0),color.redOffset=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.RED_OFFSET,0),color.greenOffset=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.GREEN_OFFSET,0),color.blueOffset=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.BLUE_OFFSET,0)},ObjectDataParser.prototype._parseGeometry=function(rawData,geometry){var rawVertices=rawData[dragonBones.DataParser.VERTICES],vertexCount=Math.floor(rawVertices.length/2),triangleCount=0,geometryOffset=this._intArray.length,verticesOffset=this._floatArray.length;geometry.offset=geometryOffset,geometry.data=this._data,this._intArray.length+=4,this._intArray[geometryOffset+0]=vertexCount,this._intArray[geometryOffset+2]=verticesOffset,this._intArray[geometryOffset+3]=-1,this._floatArray.length+=2*vertexCount;for(var i=0,l=2*vertexCount;i<l;++i)this._floatArray[verticesOffset+i]=rawVertices[i];if(dragonBones.DataParser.TRIANGLES in rawData){var rawTriangles=rawData[dragonBones.DataParser.TRIANGLES];triangleCount=Math.floor(rawTriangles.length/3),this._intArray.length+=3*triangleCount;for(var i=0,l=3*triangleCount;i<l;++i)this._intArray[geometryOffset+4+i]=rawTriangles[i]}if(this._intArray[geometryOffset+1]=triangleCount,dragonBones.DataParser.UVS in rawData){var rawUVs=rawData[dragonBones.DataParser.UVS],uvOffset=verticesOffset+2*vertexCount;this._floatArray.length+=2*vertexCount;for(var i=0,l=2*vertexCount;i<l;++i)this._floatArray[uvOffset+i]=rawUVs[i]}if(dragonBones.DataParser.WEIGHTS in rawData){var rawWeights=rawData[dragonBones.DataParser.WEIGHTS],weightCount=Math.floor(rawWeights.length-vertexCount)/2,weightOffset=this._intArray.length,floatOffset=this._floatArray.length,weightBoneCount=0,sortedBones=this._armature.sortedBones,weight=dragonBones.BaseObject.borrowObject(dragonBones.WeightData);if(weight.count=weightCount,weight.offset=weightOffset,this._intArray.length+=2+weightBoneCount+vertexCount+weightCount,this._intArray[weightOffset+1]=floatOffset,dragonBones.DataParser.BONE_POSE in rawData){var rawSlotPose=rawData[dragonBones.DataParser.SLOT_POSE],rawBonePoses=rawData[dragonBones.DataParser.BONE_POSE],weightBoneIndices=new Array;weightBoneCount=Math.floor(rawBonePoses.length/7),weightBoneIndices.length=weightBoneCount;for(var i=0;i<weightBoneCount;++i){var rawBoneIndex=rawBonePoses[7*i],bone=this._rawBones[rawBoneIndex];weight.addBone(bone),weightBoneIndices[i]=rawBoneIndex,this._intArray[weightOffset+2+i]=sortedBones.indexOf(bone)}this._floatArray.length+=3*weightCount,this._helpMatrixA.copyFromArray(rawSlotPose,0);for(var i=0,iW=0,iB=weightOffset+2+weightBoneCount,iV=floatOffset;i<vertexCount;++i){var iD=2*i,vertexBoneCount=this._intArray[iB++]=rawWeights[iW++],x=this._floatArray[verticesOffset+iD],y=this._floatArray[verticesOffset+iD+1];this._helpMatrixA.transformPoint(x,y,this._helpPoint),x=this._helpPoint.x,y=this._helpPoint.y;for(var j=0;j<vertexBoneCount;++j){var rawBoneIndex=rawWeights[iW++],boneIndex=weightBoneIndices.indexOf(rawBoneIndex);this._helpMatrixB.copyFromArray(rawBonePoses,7*boneIndex+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(x,y,this._helpPoint),this._intArray[iB++]=boneIndex,this._floatArray[iV++]=rawWeights[iW++],this._floatArray[iV++]=this._helpPoint.x,this._floatArray[iV++]=this._helpPoint.y}}}else{var rawBones=rawData[dragonBones.DataParser.BONES];weightBoneCount=rawBones.length;for(var i=0;i<weightBoneCount;i++){var rawBoneIndex=rawBones[i],bone=this._rawBones[rawBoneIndex];weight.addBone(bone),this._intArray[weightOffset+2+i]=sortedBones.indexOf(bone)}this._floatArray.length+=3*weightCount;for(var i=0,iW=0,iV=0,iB=weightOffset+2+weightBoneCount,iF=floatOffset;i<weightCount;i++){var vertexBoneCount=rawWeights[iW++];this._intArray[iB++]=vertexBoneCount;for(var j=0;j<vertexBoneCount;j++){var boneIndex=rawWeights[iW++],boneWeight=rawWeights[iW++],x=rawVertices[iV++],y=rawVertices[iV++];this._intArray[iB++]=rawBones.indexOf(boneIndex),this._floatArray[iF++]=boneWeight,this._floatArray[iF++]=x,this._floatArray[iF++]=y}}}geometry.weight=weight}},ObjectDataParser.prototype._parseArray=function(rawData){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0,this._colorArray.length=0},ObjectDataParser.prototype._modifyArray=function(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!=0&&this._timelineArray.push(0),this._timelineArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._colorArray.push(0);for(var l1=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,l2=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,l3=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,l4=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,l5=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,l6=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,l7=this._colorArray.length*Int16Array.BYTES_PER_ELEMENT,lTotal,binary=new ArrayBuffer(l1+l2+l3+l4+l5+l6+l7),intArray=new Int16Array(binary,0,this._intArray.length),floatArray=new Float32Array(binary,l1,this._floatArray.length),frameIntArray=new Int16Array(binary,l1+l2,this._frameIntArray.length),frameFloatArray=new Float32Array(binary,l1+l2+l3,this._frameFloatArray.length),frameArray=new Int16Array(binary,l1+l2+l3+l4,this._frameArray.length),timelineArray=new Uint16Array(binary,l1+l2+l3+l4+l5,this._timelineArray.length),colorArray=new Int16Array(binary,l1+l2+l3+l4+l5+l6,this._colorArray.length),i=0,l=this._intArray.length;i<l;++i)intArray[i]=this._intArray[i];for(var i=0,l=this._floatArray.length;i<l;++i)floatArray[i]=this._floatArray[i];for(var i=0,l=this._frameIntArray.length;i<l;++i)frameIntArray[i]=this._frameIntArray[i];for(var i=0,l=this._frameFloatArray.length;i<l;++i)frameFloatArray[i]=this._frameFloatArray[i];for(var i=0,l=this._frameArray.length;i<l;++i)frameArray[i]=this._frameArray[i];for(var i=0,l=this._timelineArray.length;i<l;++i)timelineArray[i]=this._timelineArray[i];for(var i=0,l=this._colorArray.length;i<l;++i)colorArray[i]=this._colorArray[i];this._data.binary=binary,this._data.intArray=intArray,this._data.floatArray=floatArray,this._data.frameIntArray=frameIntArray,this._data.frameFloatArray=frameFloatArray,this._data.frameArray=frameArray,this._data.timelineArray=timelineArray,this._data.colorArray=colorArray,this._defaultColorOffset=-1},ObjectDataParser.prototype.parseDragonBonesData=function(rawData,scale){void 0===scale&&(scale=1),console.assert(null!=rawData,"Data error.");var version=ObjectDataParser._getString(rawData,dragonBones.DataParser.VERSION,""),compatibleVersion=ObjectDataParser._getString(rawData,dragonBones.DataParser.COMPATIBLE_VERSION,"");if(dragonBones.DataParser.DATA_VERSIONS.indexOf(version)>=0||dragonBones.DataParser.DATA_VERSIONS.indexOf(compatibleVersion)>=0){var data=dragonBones.BaseObject.borrowObject(dragonBones.DragonBonesData);if(data.version=version,data.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),data.frameRate=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.FRAME_RATE,24),0===data.frameRate&&(data.frameRate=24),dragonBones.DataParser.ARMATURE in rawData){this._data=data,this._parseArray(rawData);for(var rawArmatures,_i=0,rawArmatures_1=rawData[dragonBones.DataParser.ARMATURE];_i<rawArmatures_1.length;_i++){var rawArmature=rawArmatures_1[_i];data.addArmature(this._parseArmature(rawArmature,scale))}this._data.binary||this._modifyArray(),dragonBones.DataParser.STAGE in rawData?data.stage=data.getArmature(ObjectDataParser._getString(rawData,dragonBones.DataParser.STAGE,"")):data.armatureNames.length>0&&(data.stage=data.getArmature(data.armatureNames[0])),this._data=null}return dragonBones.DataParser.TEXTURE_ATLAS in rawData&&(this._rawTextureAtlases=rawData[dragonBones.DataParser.TEXTURE_ATLAS]),data}return console.assert(!1,"Nonsupport data version: "+version+"\nPlease convert DragonBones data to support version.\nRead more: https://github.com/DragonBones/Tools/"),null},ObjectDataParser.prototype.parseTextureAtlasData=function(rawData,textureAtlasData,scale){if(void 0===scale&&(scale=1),console.assert(void 0!==rawData),null===rawData){if(null===this._rawTextureAtlases||0===this._rawTextureAtlases.length)return!1;var rawTextureAtlas=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(rawTextureAtlas,textureAtlasData,scale),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(textureAtlasData.width=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.WIDTH,0),textureAtlasData.height=ObjectDataParser._getNumber(rawData,dragonBones.DataParser.HEIGHT,0),textureAtlasData.scale=1===scale?1/ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SCALE,1):scale,textureAtlasData.name=ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,""),textureAtlasData.imagePath=ObjectDataParser._getString(rawData,dragonBones.DataParser.IMAGE_PATH,""),dragonBones.DataParser.SUB_TEXTURE in rawData)for(var rawTextures=rawData[dragonBones.DataParser.SUB_TEXTURE],i=0,l=rawTextures.length;i<l;++i){var rawTexture=rawTextures[i],frameWidth=ObjectDataParser._getNumber(rawTexture,dragonBones.DataParser.FRAME_WIDTH,-1),frameHeight=ObjectDataParser._getNumber(rawTexture,dragonBones.DataParser.FRAME_HEIGHT,-1),textureData=textureAtlasData.createTexture();textureData.rotated=ObjectDataParser._getBoolean(rawTexture,dragonBones.DataParser.ROTATED,!1),textureData.name=ObjectDataParser._getString(rawTexture,dragonBones.DataParser.NAME,""),textureData.region.x=ObjectDataParser._getNumber(rawTexture,dragonBones.DataParser.X,0),textureData.region.y=ObjectDataParser._getNumber(rawTexture,dragonBones.DataParser.Y,0),textureData.region.width=ObjectDataParser._getNumber(rawTexture,dragonBones.DataParser.WIDTH,0),textureData.region.height=ObjectDataParser._getNumber(rawTexture,dragonBones.DataParser.HEIGHT,0),frameWidth>0&&frameHeight>0&&(textureData.frame=dragonBones.TextureData.createRectangle(),textureData.frame.x=ObjectDataParser._getNumber(rawTexture,dragonBones.DataParser.FRAME_X,0),textureData.frame.y=ObjectDataParser._getNumber(rawTexture,dragonBones.DataParser.FRAME_Y,0),textureData.frame.width=frameWidth,textureData.frame.height=frameHeight),textureAtlasData.addTexture(textureData)}return!0},ObjectDataParser.getInstance=function(){return null===ObjectDataParser._objectDataParserInstance&&(ObjectDataParser._objectDataParserInstance=new ObjectDataParser),ObjectDataParser._objectDataParserInstance},ObjectDataParser._objectDataParserInstance=null,ObjectDataParser}(dragonBones.DataParser);dragonBones.ObjectDataParser=ObjectDataParser;var ActionFrame=function(){function ActionFrame(){this.frameStart=0,this.actions=[]}return ActionFrame}();dragonBones.ActionFrame=ActionFrame}(dragonBones||(dragonBones={})),function(dragonBones){var BinaryDataParser=function(_super){function BinaryDataParser(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(BinaryDataParser,_super),BinaryDataParser.prototype._inRange=function(a,min,max){return min<=a&&a<=max},BinaryDataParser.prototype._decodeUTF8=function(data){for(var EOF_byte=-1,EOF_code_point=-1,FATAL_POINT=65533,pos=0,result="",code_point,utf8_code_point=0,utf8_bytes_needed=0,utf8_bytes_seen=0,utf8_lower_boundary=0;data.length>pos;){var _byte=data[pos++];if(-1===_byte)code_point=0!==utf8_bytes_needed?65533:-1;else if(0===utf8_bytes_needed)this._inRange(_byte,0,127)?code_point=_byte:(this._inRange(_byte,194,223)?(utf8_bytes_needed=1,utf8_lower_boundary=128,utf8_code_point=_byte-192):this._inRange(_byte,224,239)?(utf8_bytes_needed=2,utf8_lower_boundary=2048,utf8_code_point=_byte-224):this._inRange(_byte,240,244)&&(utf8_bytes_needed=3,utf8_lower_boundary=65536,utf8_code_point=_byte-240),utf8_code_point*=Math.pow(64,utf8_bytes_needed),code_point=null);else if(this._inRange(_byte,128,191))if(utf8_bytes_seen+=1,utf8_code_point+=(_byte-128)*Math.pow(64,utf8_bytes_needed-utf8_bytes_seen),utf8_bytes_seen!==utf8_bytes_needed)code_point=null;else{var cp=utf8_code_point,lower_boundary=utf8_lower_boundary;utf8_code_point=0,utf8_bytes_needed=0,utf8_bytes_seen=0,utf8_lower_boundary=0,code_point=this._inRange(cp,lower_boundary,1114111)&&!this._inRange(cp,55296,57343)?cp:_byte}else utf8_code_point=0,utf8_bytes_needed=0,utf8_bytes_seen=0,utf8_lower_boundary=0,pos--,code_point=_byte;null!==code_point&&-1!==code_point&&(code_point<=65535?code_point>0&&(result+=String.fromCharCode(code_point)):(code_point-=65536,result+=String.fromCharCode(55296+(code_point>>10&1023)),result+=String.fromCharCode(56320+(1023&code_point))))}return result},BinaryDataParser.prototype._parseBinaryTimeline=function(type,offset,timelineData){void 0===timelineData&&(timelineData=null);var timeline=null!==timelineData?timelineData:dragonBones.BaseObject.borrowObject(dragonBones.TimelineData);timeline.type=type,timeline.offset=offset,this._timeline=timeline;var keyFrameCount=this._timelineArrayBuffer[timeline.offset+2];if(1===keyFrameCount)timeline.frameIndicesOffset=-1;else{var frameIndicesOffset=0,totalFrameCount=this._animation.frameCount+1,frameIndices=this._data.frameIndices;frameIndicesOffset=frameIndices.length,frameIndices.length+=totalFrameCount,timeline.frameIndicesOffset=frameIndicesOffset;for(var i=0,iK=0,frameStart=0,frameCount=0;i<totalFrameCount;++i)frameStart+frameCount<=i&&iK<keyFrameCount&&(frameStart=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[timeline.offset+5+iK]],frameCount=iK===keyFrameCount-1?this._animation.frameCount-frameStart:this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[timeline.offset+5+iK+1]]-frameStart,iK++),frameIndices[frameIndicesOffset+i]=iK-1}return this._timeline=null,timeline},BinaryDataParser.prototype._parseAnimation=function(rawData){var animation=dragonBones.BaseObject.borrowObject(dragonBones.AnimationData);animation.blendType=dragonBones.DataParser._getAnimationBlendType(dragonBones.ObjectDataParser._getString(rawData,dragonBones.DataParser.BLEND_TYPE,"")),animation.frameCount=dragonBones.ObjectDataParser._getNumber(rawData,dragonBones.DataParser.DURATION,0),animation.playTimes=dragonBones.ObjectDataParser._getNumber(rawData,dragonBones.DataParser.PLAY_TIMES,1),animation.duration=animation.frameCount/this._armature.frameRate,animation.fadeInTime=dragonBones.ObjectDataParser._getNumber(rawData,dragonBones.DataParser.FADE_IN_TIME,0),animation.scale=dragonBones.ObjectDataParser._getNumber(rawData,dragonBones.DataParser.SCALE,1),animation.name=dragonBones.ObjectDataParser._getString(rawData,dragonBones.DataParser.NAME,dragonBones.DataParser.DEFAULT_NAME),0===animation.name.length&&(animation.name=dragonBones.DataParser.DEFAULT_NAME);var offsets=rawData[dragonBones.DataParser.OFFSET];if(animation.frameIntOffset=offsets[0],animation.frameFloatOffset=offsets[1],animation.frameOffset=offsets[2],this._animation=animation,dragonBones.DataParser.ACTION in rawData&&(animation.actionTimeline=this._parseBinaryTimeline(0,rawData[dragonBones.DataParser.ACTION])),dragonBones.DataParser.Z_ORDER in rawData&&(animation.zOrderTimeline=this._parseBinaryTimeline(1,rawData[dragonBones.DataParser.Z_ORDER])),dragonBones.DataParser.BONE in rawData){var rawTimeliness=rawData[dragonBones.DataParser.BONE];for(var k in rawTimeliness){var rawTimelines=rawTimeliness[k],bone=this._armature.getBone(k);if(null!==bone)for(var i=0,l=rawTimelines.length;i<l;i+=2){var timelineType=rawTimelines[i],timelineOffset=rawTimelines[i+1],timeline=this._parseBinaryTimeline(timelineType,timelineOffset);this._animation.addBoneTimeline(bone.name,timeline)}}}if(dragonBones.DataParser.SLOT in rawData){var rawTimeliness=rawData[dragonBones.DataParser.SLOT];for(var k in rawTimeliness){var rawTimelines=rawTimeliness[k],slot=this._armature.getSlot(k);if(null!==slot)for(var i=0,l=rawTimelines.length;i<l;i+=2){var timelineType=rawTimelines[i],timelineOffset=rawTimelines[i+1],timeline=this._parseBinaryTimeline(timelineType,timelineOffset);this._animation.addSlotTimeline(slot.name,timeline)}}}if(dragonBones.DataParser.CONSTRAINT in rawData){var rawTimeliness=rawData[dragonBones.DataParser.CONSTRAINT];for(var k in rawTimeliness){var rawTimelines=rawTimeliness[k],constraint=this._armature.getConstraint(k);if(null!==constraint)for(var i=0,l=rawTimelines.length;i<l;i+=2){var timelineType=rawTimelines[i],timelineOffset=rawTimelines[i+1],timeline=this._parseBinaryTimeline(timelineType,timelineOffset);this._animation.addConstraintTimeline(constraint.name,timeline)}}}if(dragonBones.DataParser.TIMELINE in rawData)for(var rawTimelines,_i=0,rawTimelines_6=rawTimelines=rawData[dragonBones.DataParser.TIMELINE];_i<rawTimelines_6.length;_i++){var rawTimeline=rawTimelines_6[_i],timelineOffset;if((timelineOffset=dragonBones.ObjectDataParser._getNumber(rawTimeline,dragonBones.DataParser.OFFSET,0))>=0){var timelineType=dragonBones.ObjectDataParser._getNumber(rawTimeline,dragonBones.DataParser.TYPE,0),timelineName=dragonBones.ObjectDataParser._getString(rawTimeline,dragonBones.DataParser.NAME,""),timeline=null;if(40===timelineType&&0!==animation.blendType){var animaitonTimeline=timeline=dragonBones.BaseObject.borrowObject(dragonBones.AnimationTimelineData);animaitonTimeline.x=dragonBones.ObjectDataParser._getNumber(rawTimeline,dragonBones.DataParser.X,0),animaitonTimeline.y=dragonBones.ObjectDataParser._getNumber(rawTimeline,dragonBones.DataParser.Y,0)}switch(timeline=this._parseBinaryTimeline(timelineType,timelineOffset,timeline),timelineType){case 0:case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(timelineName,timeline);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(timelineName,timeline);break;case 30:this._animation.addConstraintTimeline(timelineName,timeline);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(timelineName,timeline)}}}return this._animation=null,animation},BinaryDataParser.prototype._parseGeometry=function(rawData,geometry){geometry.offset=rawData[dragonBones.DataParser.OFFSET],geometry.data=this._data;var weightOffset=this._intArrayBuffer[geometry.offset+3];if(weightOffset<-1&&(weightOffset+=65536),weightOffset>=0){var weight=dragonBones.BaseObject.borrowObject(dragonBones.WeightData),vertexCount=this._intArrayBuffer[geometry.offset+0],boneCount=this._intArrayBuffer[weightOffset+0];weight.offset=weightOffset;for(var i=0;i<boneCount;++i){var boneIndex=this._intArrayBuffer[weightOffset+2+i];weight.addBone(this._rawBones[boneIndex])}for(var boneIndicesOffset=weightOffset+2+boneCount,weightCount=0,i=0,l=vertexCount;i<l;++i){var vertexBoneCount=this._intArrayBuffer[boneIndicesOffset++];weightCount+=vertexBoneCount,boneIndicesOffset+=vertexBoneCount}weight.count=weightCount,geometry.weight=weight}},BinaryDataParser.prototype._parseArray=function(rawData){var offsets=rawData[dragonBones.DataParser.OFFSET],l1=offsets[1],l2=offsets[3],l3=offsets[5],l4=offsets[7],l5=offsets[9],l6=offsets[11],l7=offsets.length>12?offsets[13]:0,intArray=new Int16Array(this._binary,this._binaryOffset+offsets[0],l1/Int16Array.BYTES_PER_ELEMENT),floatArray=new Float32Array(this._binary,this._binaryOffset+offsets[2],l2/Float32Array.BYTES_PER_ELEMENT),frameIntArray=new Int16Array(this._binary,this._binaryOffset+offsets[4],l3/Int16Array.BYTES_PER_ELEMENT),frameFloatArray=new Float32Array(this._binary,this._binaryOffset+offsets[6],l4/Float32Array.BYTES_PER_ELEMENT),frameArray=new Int16Array(this._binary,this._binaryOffset+offsets[8],l5/Int16Array.BYTES_PER_ELEMENT),timelineArray=new Uint16Array(this._binary,this._binaryOffset+offsets[10],l6/Uint16Array.BYTES_PER_ELEMENT),colorArray=l7>0?new Int16Array(this._binary,this._binaryOffset+offsets[12],l7/Uint16Array.BYTES_PER_ELEMENT):intArray;this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=intArray,this._data.floatArray=floatArray,this._data.frameIntArray=frameIntArray,this._data.frameFloatArray=frameFloatArray,this._data.frameArray=this._frameArrayBuffer=frameArray,this._data.timelineArray=this._timelineArrayBuffer=timelineArray,this._data.colorArray=colorArray},BinaryDataParser.prototype.parseDragonBonesData=function(rawData,scale){void 0===scale&&(scale=1),console.assert(null!=rawData&&rawData instanceof ArrayBuffer,"Data error.");var tag=new Uint8Array(rawData,0,8);if(tag[0]!=="D".charCodeAt(0)||tag[1]!=="B".charCodeAt(0)||tag[2]!=="D".charCodeAt(0)||tag[3]!=="T".charCodeAt(0))return console.assert(!1,"Nonsupport data."),null;var headerLength=new Uint32Array(rawData,8,1)[0],headerBytes=new Uint8Array(rawData,12,headerLength),headerString=this._decodeUTF8(headerBytes),header=JSON.parse(headerString);return this._binaryOffset=12+headerLength,this._binary=rawData,_super.prototype.parseDragonBonesData.call(this,header,scale)},BinaryDataParser.getInstance=function(){return null===BinaryDataParser._binaryDataParserInstance&&(BinaryDataParser._binaryDataParserInstance=new BinaryDataParser),BinaryDataParser._binaryDataParserInstance},BinaryDataParser._binaryDataParserInstance=null,BinaryDataParser}(dragonBones.ObjectDataParser);dragonBones.BinaryDataParser=BinaryDataParser}(dragonBones||(dragonBones={})),function(dragonBones){var BaseFactory=function(){function BaseFactory(dataParser){void 0===dataParser&&(dataParser=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dragonBones=null,this._dataParser=null,null===BaseFactory._objectParser&&(BaseFactory._objectParser=new dragonBones.ObjectDataParser),null===BaseFactory._binaryParser&&(BaseFactory._binaryParser=new dragonBones.BinaryDataParser),this._dataParser=null!==dataParser?dataParser:BaseFactory._objectParser}return BaseFactory.prototype._isSupportMesh=function(){return!0},BaseFactory.prototype._getTextureData=function(textureAtlasName,textureName){if(textureAtlasName in this._textureAtlasDataMap)for(var _i=0,_a=this._textureAtlasDataMap[textureAtlasName];_i<_a.length;_i++){var textureAtlasData,textureData;if(null!==(textureData=(textureAtlasData=_a[_i]).getTexture(textureName)))return textureData}if(this.autoSearch)for(var k in this._textureAtlasDataMap)for(var _b=0,_c=this._textureAtlasDataMap[k];_b<_c.length;_b++){var textureAtlasData,textureData;if((textureAtlasData=_c[_b]).autoSearch)if(null!==(textureData=textureAtlasData.getTexture(textureName)))return textureData}return null},BaseFactory.prototype._fillBuildArmaturePackage=function(dataPackage,dragonBonesName,armatureName,skinName,textureAtlasName){var dragonBonesData=null,armatureData=null;if(dragonBonesName.length>0&&dragonBonesName in this._dragonBonesDataMap&&(armatureData=(dragonBonesData=this._dragonBonesDataMap[dragonBonesName]).getArmature(armatureName)),null===armatureData&&(0===dragonBonesName.length||this.autoSearch))for(var k in this._dragonBonesDataMap)if(dragonBonesData=this._dragonBonesDataMap[k],(0===dragonBonesName.length||dragonBonesData.autoSearch)&&null!==(armatureData=dragonBonesData.getArmature(armatureName))){dragonBonesName=k;break}if(null!==armatureData){if(dataPackage.dataName=dragonBonesName,dataPackage.textureAtlasName=textureAtlasName,dataPackage.data=dragonBonesData,dataPackage.armature=armatureData,dataPackage.skin=null,skinName.length>0&&(dataPackage.skin=armatureData.getSkin(skinName),null===dataPackage.skin&&this.autoSearch))for(var k in this._dragonBonesDataMap){var skinDragonBonesData,skinArmatureData=this._dragonBonesDataMap[k].getArmature(skinName);if(null!==skinArmatureData){dataPackage.skin=skinArmatureData.defaultSkin;break}}return null===dataPackage.skin&&(dataPackage.skin=armatureData.defaultSkin),!0}return!1},BaseFactory.prototype._buildBones=function(dataPackage,armature){for(var _i=0,_a=dataPackage.armature.sortedBones;_i<_a.length;_i++){var boneData=_a[_i],bone;dragonBones.BaseObject.borrowObject(0===boneData.type?dragonBones.Bone:dragonBones.Surface).init(boneData,armature)}},BaseFactory.prototype._buildSlots=function(dataPackage,armature){var currentSkin=dataPackage.skin,defaultSkin=dataPackage.armature.defaultSkin;if(null!==currentSkin&&null!==defaultSkin){var skinSlots={};for(var k in defaultSkin.displays){var displays=defaultSkin.getDisplays(k);skinSlots[k]=displays}if(currentSkin!==defaultSkin)for(var k in currentSkin.displays){var displays=currentSkin.getDisplays(k);skinSlots[k]=displays}for(var _i=0,_a=dataPackage.armature.sortedSlots;_i<_a.length;_i++){var slotData=_a[_i],displayDatas=slotData.name in skinSlots?skinSlots[slotData.name]:null,slot=this._buildSlot(dataPackage,slotData,armature);if(null!==displayDatas){slot.displayFrameCount=displayDatas.length;for(var i=0,l=slot.displayFrameCount;i<l;++i){var displayData=displayDatas[i];if(slot.replaceRawDisplayData(displayData,i),null!==displayData){if(dataPackage.textureAtlasName.length>0){var textureData=this._getTextureData(dataPackage.textureAtlasName,displayData.path);slot.replaceTextureData(textureData,i)}var display=this._getSlotDisplay(dataPackage,displayData,slot);slot.replaceDisplay(display,i)}else slot.replaceDisplay(null)}}slot._setDisplayIndex(slotData.displayIndex,!0)}}},BaseFactory.prototype._buildConstraints=function(dataPackage,armature){var constraints=dataPackage.armature.constraints;for(var k in constraints){var constraintData=constraints[k];switch(constraintData.type){case 0:var ikConstraint=dragonBones.BaseObject.borrowObject(dragonBones.IKConstraint);ikConstraint.init(constraintData,armature),armature._addConstraint(ikConstraint);break;case 1:var pathConstraint=dragonBones.BaseObject.borrowObject(dragonBones.PathConstraint);pathConstraint.init(constraintData,armature),armature._addConstraint(pathConstraint);break;default:var constraint=dragonBones.BaseObject.borrowObject(dragonBones.IKConstraint);constraint.init(constraintData,armature),armature._addConstraint(constraint)}}},BaseFactory.prototype._buildChildArmature=function(dataPackage,_slot,displayData){return this.buildArmature(displayData.path,null!==dataPackage?dataPackage.dataName:"","",null!==dataPackage?dataPackage.textureAtlasName:"")},BaseFactory.prototype._getSlotDisplay=function(dataPackage,displayData,slot){var dataName=null!==dataPackage?dataPackage.dataName:displayData.parent.parent.parent.name,display=null;switch(displayData.type){case 0:var imageDisplayData=displayData;null===imageDisplayData.texture&&(imageDisplayData.texture=this._getTextureData(dataName,displayData.path)),display=slot.rawDisplay;break;case 2:var meshDisplayData=displayData;null===meshDisplayData.texture&&(meshDisplayData.texture=this._getTextureData(dataName,meshDisplayData.path)),display=this._isSupportMesh()?slot.meshDisplay:slot.rawDisplay;break;case 1:var armatureDisplayData=displayData,childArmature=this._buildChildArmature(dataPackage,slot,armatureDisplayData);if(null!==childArmature){if(childArmature.inheritAnimation=armatureDisplayData.inheritAnimation,!childArmature.inheritAnimation){var actions=armatureDisplayData.actions.length>0?armatureDisplayData.actions:childArmature.armatureData.defaultActions;if(actions.length>0)for(var _i=0,actions_6=actions;_i<actions_6.length;_i++){var action=actions_6[_i],eventObject=dragonBones.BaseObject.borrowObject(dragonBones.EventObject);dragonBones.EventObject.actionDataToInstance(action,eventObject,slot.armature),eventObject.slot=slot,slot.armature._bufferAction(eventObject,!1)}else childArmature.animation.play()}armatureDisplayData.armature=childArmature.armatureData}display=childArmature}return display},BaseFactory.prototype.parseDragonBonesData=function(rawData,name,scale){void 0===name&&(name=null),void 0===scale&&(scale=1);for(var dataParser=rawData instanceof ArrayBuffer?BaseFactory._binaryParser:this._dataParser,dragonBonesData=dataParser.parseDragonBonesData(rawData,scale);;){var textureAtlasData=this._buildTextureAtlasData(null,null);if(!dataParser.parseTextureAtlasData(null,textureAtlasData,scale)){textureAtlasData.returnToPool();break}this.addTextureAtlasData(textureAtlasData,name)}return null!==dragonBonesData&&this.addDragonBonesData(dragonBonesData,name),dragonBonesData},BaseFactory.prototype.parseTextureAtlasData=function(rawData,textureAtlas,name,scale){void 0===name&&(name=null),void 0===scale&&(scale=1);var textureAtlasData=this._buildTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(rawData,textureAtlasData,scale),this._buildTextureAtlasData(textureAtlasData,textureAtlas||null),this.addTextureAtlasData(textureAtlasData,name),textureAtlasData},BaseFactory.prototype.updateTextureAtlases=function(textureAtlases,name){var textureAtlasDatas=this.getTextureAtlasData(name);if(null!==textureAtlasDatas)for(var i=0,l=textureAtlasDatas.length;i<l;++i)i<textureAtlases.length&&this._buildTextureAtlasData(textureAtlasDatas[i],textureAtlases[i])},BaseFactory.prototype.getDragonBonesData=function(name){return name in this._dragonBonesDataMap?this._dragonBonesDataMap[name]:null},BaseFactory.prototype.addDragonBonesData=function(data,name){if(void 0===name&&(name=null),(name=null!==name?name:data.name)in this._dragonBonesDataMap){if(this._dragonBonesDataMap[name]===data)return;console.warn("Can not add same name data: "+name)}else this._dragonBonesDataMap[name]=data},BaseFactory.prototype.removeDragonBonesData=function(name,disposeData){void 0===disposeData&&(disposeData=!0),name in this._dragonBonesDataMap&&(disposeData&&this._dragonBones.bufferObject(this._dragonBonesDataMap[name]),delete this._dragonBonesDataMap[name])},BaseFactory.prototype.getTextureAtlasData=function(name){return name in this._textureAtlasDataMap?this._textureAtlasDataMap[name]:null},BaseFactory.prototype.addTextureAtlasData=function(data,name){void 0===name&&(name=null);var textureAtlasList=(name=null!==name?name:data.name)in this._textureAtlasDataMap?this._textureAtlasDataMap[name]:this._textureAtlasDataMap[name]=[];textureAtlasList.indexOf(data)<0&&textureAtlasList.push(data)},BaseFactory.prototype.removeTextureAtlasData=function(name,disposeData){if(void 0===disposeData&&(disposeData=!0),name in this._textureAtlasDataMap){var textureAtlasDataList=this._textureAtlasDataMap[name];if(disposeData)for(var _i=0,textureAtlasDataList_1=textureAtlasDataList;_i<textureAtlasDataList_1.length;_i++){var textureAtlasData=textureAtlasDataList_1[_i];this._dragonBones.bufferObject(textureAtlasData)}delete this._textureAtlasDataMap[name]}},BaseFactory.prototype.getArmatureData=function(name,dragonBonesName){void 0===dragonBonesName&&(dragonBonesName="");var dataPackage=new BuildArmaturePackage;return this._fillBuildArmaturePackage(dataPackage,dragonBonesName,name,"","")?dataPackage.armature:null},BaseFactory.prototype.clear=function(disposeData){for(var k in void 0===disposeData&&(disposeData=!0),this._dragonBonesDataMap)disposeData&&this._dragonBones.bufferObject(this._dragonBonesDataMap[k]),delete this._dragonBonesDataMap[k];for(var k in this._textureAtlasDataMap){if(disposeData)for(var textureAtlasDataList,_i=0,textureAtlasDataList_2=this._textureAtlasDataMap[k];_i<textureAtlasDataList_2.length;_i++){var textureAtlasData=textureAtlasDataList_2[_i];this._dragonBones.bufferObject(textureAtlasData)}delete this._textureAtlasDataMap[k]}},BaseFactory.prototype.buildArmature=function(armatureName,dragonBonesName,skinName,textureAtlasName){void 0===dragonBonesName&&(dragonBonesName=""),void 0===skinName&&(skinName=""),void 0===textureAtlasName&&(textureAtlasName="");var dataPackage=new BuildArmaturePackage;if(!this._fillBuildArmaturePackage(dataPackage,dragonBonesName||"",armatureName,skinName||"",textureAtlasName||""))return console.warn("No armature data: "+armatureName+", "+(null!==dragonBonesName?dragonBonesName:"")),null;var armature=this._buildArmature(dataPackage);return this._buildBones(dataPackage,armature),this._buildSlots(dataPackage,armature),this._buildConstraints(dataPackage,armature),armature.invalidUpdate(null,!0),armature.advanceTime(0),armature},BaseFactory.prototype.replaceDisplay=function(slot,displayData,displayIndex){if(void 0===displayIndex&&(displayIndex=-1),displayIndex<0&&(displayIndex=slot.displayIndex),displayIndex<0&&(displayIndex=0),slot.replaceDisplayData(displayData,displayIndex),null!==displayData){var display=this._getSlotDisplay(null,displayData,slot);if(0===displayData.type){var rawDisplayData=slot.getDisplayFrameAt(displayIndex).rawDisplayData;null!==rawDisplayData&&2===rawDisplayData.type&&(display=slot.meshDisplay)}slot.replaceDisplay(display,displayIndex)}else slot.replaceDisplay(null,displayIndex)},BaseFactory.prototype.replaceSlotDisplay=function(dragonBonesName,armatureName,slotName,displayName,slot,displayIndex){void 0===displayIndex&&(displayIndex=-1);var armatureData=this.getArmatureData(armatureName,dragonBonesName||"");if(null===armatureData||null===armatureData.defaultSkin)return!1;var displayData=armatureData.defaultSkin.getDisplay(slotName,displayName);return this.replaceDisplay(slot,displayData,displayIndex),!0},BaseFactory.prototype.replaceSlotDisplayList=function(dragonBonesName,armatureName,slotName,slot){var armatureData=this.getArmatureData(armatureName,dragonBonesName||"");if(!armatureData||!armatureData.defaultSkin)return!1;var displayDatas=armatureData.defaultSkin.getDisplays(slotName);if(!displayDatas)return!1;slot.displayFrameCount=displayDatas.length;for(var i=0,l=slot.displayFrameCount;i<l;++i){var displayData=displayDatas[i];this.replaceDisplay(slot,displayData,i)}return!0},BaseFactory.prototype.replaceSkin=function(armature,skin,isOverride,exclude){void 0===isOverride&&(isOverride=!1),void 0===exclude&&(exclude=null);for(var success=!1,defaultSkin=skin.parent.defaultSkin,_i=0,_a=armature.getSlots();_i<_a.length;_i++){var slot=_a[_i];if(!(null!==exclude&&exclude.indexOf(slot.name)>=0)){var displayDatas=skin.getDisplays(slot.name);if(null!==displayDatas||(null!==defaultSkin&&skin!==defaultSkin&&(displayDatas=defaultSkin.getDisplays(slot.name)),null!==displayDatas)){slot.displayFrameCount=displayDatas.length;for(var i=0,l=slot.displayFrameCount;i<l;++i){var displayData=displayDatas[i];slot.replaceRawDisplayData(displayData,i),null!==displayData?slot.replaceDisplay(this._getSlotDisplay(null,displayData,slot),i):slot.replaceDisplay(null,i)}success=!0}else isOverride&&(slot.displayFrameCount=0)}}return success},BaseFactory.prototype.replaceAnimation=function(armature,armatureData,isOverride){void 0===isOverride&&(isOverride=!0);var skinData=armatureData.defaultSkin;if(null===skinData)return!1;if(isOverride)armature.animation.animations=armatureData.animations;else{var rawAnimations=armature.animation.animations,animations={};for(var k in rawAnimations)animations[k]=rawAnimations[k];for(var k in armatureData.animations)animations[k]=armatureData.animations[k];armature.animation.animations=animations}for(var _i=0,_a=armature.getSlots();_i<_a.length;_i++)for(var slot=_a[_i],index=0,_b=0,_c=slot.displayList;_b<_c.length;_b++){var display=_c[_b];if(display instanceof dragonBones.Armature){var displayDatas=skinData.getDisplays(slot.name);if(null!==displayDatas&&index<displayDatas.length){var displayData=displayDatas[index];if(null!==displayData&&1===displayData.type){var childArmatureData=this.getArmatureData(displayData.path,displayData.parent.parent.parent.name);childArmatureData&&this.replaceAnimation(display,childArmatureData,isOverride)}}}index++}return!0},BaseFactory.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},BaseFactory.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},Object.defineProperty(BaseFactory.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:!0,configurable:!0}),Object.defineProperty(BaseFactory.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:!0,configurable:!0}),BaseFactory._objectParser=null,BaseFactory._binaryParser=null,BaseFactory}();dragonBones.BaseFactory=BaseFactory;var BuildArmaturePackage=function(){function BuildArmaturePackage(){this.dataName="",this.textureAtlasName="",this.skin=null}return BuildArmaturePackage}();dragonBones.BuildArmaturePackage=BuildArmaturePackage}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var util;!function(util){var EventDispatcher=function(_super){function EventDispatcher(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(EventDispatcher,_super),EventDispatcher.prototype.hasDBEventListener=function(type){return this.listenerCount(type)>0},EventDispatcher.prototype.dispatchDBEvent=function(type,eventObject){this.emit(type,eventObject)},EventDispatcher.prototype.addDBEventListener=function(type,listener,thisObject){this.on(type,listener,thisObject)},EventDispatcher.prototype.removeDBEventListener=function(type,listener,thisObject){this.off(type,listener,thisObject)},EventDispatcher}(Phaser.Events.EventEmitter);util.EventDispatcher=EventDispatcher}(util=phaser.util||(phaser.util={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var util;!function(util){util.Skew={getSkewX:function(){return this.skewX||0},setSkewX:function(v){this.skewX=v},getSkewY:function(){return this.skewY||0},setSkewY:function(v){this.skewY=v},setSkew:function(sx,sy){sy=void 0===sy?sx:sy,this.skewX=sx,this.skewY=sy},getLocalTransformMatrix:function(tempMatrix){return void 0===tempMatrix&&(tempMatrix=new util.TransformMatrix),util.TransformMatrix.applyITRSC(tempMatrix,this.x,this.y,this._rotation,this._scaleX,this._scaleY,this.skewX,this.skewY)},getWorldTransformMatrix:function(tempMatrix,parentMatrix){void 0===tempMatrix&&(tempMatrix=new util.TransformMatrix),void 0===parentMatrix&&(parentMatrix=new util.TransformMatrix);var parent=this.parentContainer;if(!parent)return this.getLocalTransformMatrix(tempMatrix);for(tempMatrix=this.getLocalTransformMatrix(tempMatrix);parent;)(parentMatrix=parent.getLocalTransformMatrix(parentMatrix)).multiply(tempMatrix,tempMatrix),parent=parent.parentContainer;return tempMatrix}},util.extendSkew=function(clazz){Object.defineProperty(clazz.prototype,"skewX",{get:util.Skew.getSkewX,set:util.Skew.setSkewX,enumerable:!0,configurable:!0}),Object.defineProperty(clazz.prototype,"skewY",{get:util.Skew.getSkewY,set:util.Skew.setSkewY,enumerable:!0,configurable:!0}),clazz.prototype.setSkew=util.Skew.setSkew,clazz.prototype.getLocalTransformMatrix=util.Skew.getLocalTransformMatrix,clazz.prototype.getWorldTransformMatrix=util.Skew.getWorldTransformMatrix}}(util=phaser.util||(phaser.util={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var util;!function(util){var TransformMatrix=function(_super){function TransformMatrix(a,b,c,d,tx,ty){return _super.call(this,a,b,c,d,tx,ty)||this}return __extends(TransformMatrix,_super),TransformMatrix.applyITRSC=function(tempMatrix,x,y,rotation,scaleX,scaleY,skewX,skewY){return tempMatrix.a=Math.cos(rotation-skewY)*scaleX,tempMatrix.b=Math.sin(rotation-skewY)*scaleX,tempMatrix.c=-Math.sin(rotation+skewX)*scaleY,tempMatrix.d=Math.cos(rotation+skewX)*scaleY,tempMatrix.tx=x,tempMatrix.ty=y,tempMatrix},TransformMatrix.prototype.skew=function(sx,sy){return this.applyITRS(this.tx,this.ty,this.rotation,this.scaleX,this.scaleY,sx,sy),this},TransformMatrix}(Phaser.GameObjects.Components.TransformMatrix);util.TransformMatrix=TransformMatrix}(util=phaser.util||(phaser.util={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var display;!function(display){var DisplayContainer=function(_super){function DisplayContainer(scene,x,y,children){var _this=_super.call(this,scene,x,y,children)||this;return _this.tempTransformMatrix=new phaser.util.TransformMatrix,_this}return __extends(DisplayContainer,_super),DisplayContainer.prototype.pointToContainer=function(source,output){if(void 0===output&&(output=new Phaser.Math.Vector2),this.parentContainer)return this.parentContainer.pointToContainer(source,output);var tempMatrix=this.tempTransformMatrix;return tempMatrix.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.skewX,this.skewY),tempMatrix.invert(),tempMatrix.transformPoint(source.x,source.y,output),output},DisplayContainer}(Phaser.GameObjects.Container);display.DisplayContainer=DisplayContainer}(display=phaser.display||(phaser.display={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var display,display_1,ArmatureDisplay;display_1=display=phaser.display||(phaser.display={}),ArmatureDisplay=function(_super){function ArmatureDisplay(scene){var _this=_super.call(this,scene)||this;return _this.debugDraw=!1,_this}return __extends(ArmatureDisplay,_super),ArmatureDisplay.prototype.dbInit=function(armature){this._armature=armature},ArmatureDisplay.prototype.dbClear=function(){this.removeAllListeners(),this._armature&&this._armature.dispose(),this._armature=null},ArmatureDisplay.prototype.dbUpdate=function(){this.debugDraw},ArmatureDisplay.prototype.dispose=function(disposeProxy){this.dbClear(),!0===disposeProxy&&_super.prototype.destroy.call(this)},ArmatureDisplay.prototype.destroy=function(){this.dispose(!0)},ArmatureDisplay.prototype.dispatchDBEvent=function(type,eventObject){this.emit(type,eventObject)},ArmatureDisplay.prototype.hasDBEventListener=function(type){return this.listenerCount(type)>0},ArmatureDisplay.prototype.addDBEventListener=function(type,listener,scope){this.on(type,listener,scope)},ArmatureDisplay.prototype.removeDBEventListener=function(type,listener,scope){this.off(type,listener,scope)},Object.defineProperty(ArmatureDisplay.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(ArmatureDisplay.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),ArmatureDisplay.prototype.getBounds=function(output){void 0===output&&(output=new Phaser.Geom.Rectangle);for(var helpRectangle=new Phaser.Geom.Rectangle,matrix=this.getBoundsTransformMatrix(),isFirst=!0,_i=0,_a=this._armature.getSlots();_i<_a.length;_i++){var slot=_a[_i],display_2=slot.display;if(display_2){if(display_2===slot.meshDisplay){var vertices=display_2.fakeVertices;if(!(vertices&&vertices.length>0))continue;helpRectangle.setTo(999999,999999,-999999,-999999);for(var i=0,l=vertices.length;i<l;i+=2){var x=vertices[i],y=vertices[i+1];helpRectangle.x>x&&(helpRectangle.x=x),helpRectangle.width<x&&(helpRectangle.width=x),helpRectangle.y>y&&(helpRectangle.y=y),helpRectangle.height<y&&(helpRectangle.height=y)}helpRectangle.width-=helpRectangle.x,helpRectangle.height-=helpRectangle.y}else if(slot._displayFrame){var textureData=slot._displayFrame.getTextureData();if(!textureData)continue;var scale=textureData.parent.scale;helpRectangle.width=textureData.region.width*scale,helpRectangle.height=textureData.region.height*scale,helpRectangle.x=-helpRectangle.width/2,helpRectangle.y=-helpRectangle.height/2}helpRectangle.width*=this.scaleX,helpRectangle.height*=this.scaleY,matrix.transformPoint(helpRectangle.x,helpRectangle.y,helpRectangle),isFirst?(output.x=helpRectangle.x,output.y=helpRectangle.y,output.width=helpRectangle.width,output.height=helpRectangle.height,isFirst=!1):Phaser.Geom.Rectangle.Union(helpRectangle,output,output)}}return output},ArmatureDisplay}(display_1.DisplayContainer),display_1.ArmatureDisplay=ArmatureDisplay}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var display;!function(display){var SlotImage=function(_super){function SlotImage(scene,x,y,texture,frame){var _this=_super.call(this,scene,x,y,texture,frame)||this;return _this.setPipeline("SkewPipeline"),_this.hasOwnProperty("hasBind")||Object.defineProperties(_this,{hasBind:{value:!1,writable:!0}}),_this}return __extends(SlotImage,_super),SlotImage.prototype.bind=function(key){if(key){this.texture.hasOwnProperty("useCount")||Object.defineProperties(this.texture,{useCount:{value:0,writable:!0}});var res=this.scene.load.get(key);res&&(this.hasBind=!0,this.texture.useCount++,res.bind(this))}},SlotImage.prototype.loose=function(key){if(key){var res=this.scene.load.get(key);res&&(this.hasBind=!1,this.texture.useCount--,res.loose(this))}},SlotImage.prototype.setTexture=function(key,frame){return this.texture=this.scene.sys.textures.get(key),this.hasBind||this.bind(key),this.setFrame(frame)},SlotImage.prototype.destroy=function(fromScene){if(this.texture&&this.hasBind){var key=this.texture.key;this.loose(key)}_super.prototype.destroy.call(this,fromScene)},SlotImage}(Phaser.GameObjects.Image);display.SlotImage=SlotImage}(display=phaser.display||(phaser.display={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var display;!function(display){var SlotSprite=function(_super){function SlotSprite(scene,x,y,texture,frame){var _this=_super.call(this,scene,x,y,texture,frame)||this;return _this.setPipeline("SkewPipeline"),_this}return __extends(SlotSprite,_super),SlotSprite}(Phaser.GameObjects.Sprite);display.SlotSprite=SlotSprite,phaser.util.extendSkew(SlotSprite)}(display=phaser.display||(phaser.display={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var display;!function(display){var SlotMesh=function(_super){function SlotMesh(scene,x,y,vertices,uv,colors,alphas,texture,frame){var _this=this,containsZ=null,normals=null;return(_this=_super.call(this,scene,x,y,texture,frame,vertices,uv,null,null,colors,alphas)||this).setPipeline("SkewPipeline"),_this.hideCCW=!1,_this.setOrtho(_this.width,_this.height),_this}return __extends(SlotMesh,_super),SlotMesh.prototype.setTint=function(topLeft,topRight,bottomLeft,bottomRight){},SlotMesh.prototype.updateVertices=function(){},SlotMesh}(Phaser.GameObjects.Mesh);display.SlotMesh=SlotMesh}(display=phaser.display||(phaser.display={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var display;!function(display){var Slot=function(_super){function Slot(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Slot,_super),Slot.toString=function(){return"[class dragonBones.PhaserSlot]"},Slot.prototype._onClear=function(){_super.prototype._onClear.call(this),this._textureScale=1,this._renderDisplay&&(this._renderDisplay.destroy(),this._renderDisplay=null)},Slot.prototype._initDisplay=function(rawDisplay,isRetain){},Slot.prototype._disposeDisplay=function(prevDisplay,isRelease){},Slot.prototype._onUpdateDisplay=function(){this._renderDisplay=this._display||this._rawDisplay},Slot.prototype._addDisplay=function(){this.armature.display.add(this._renderDisplay)},Slot.prototype._replaceDisplay=function(prevDisplay){this._renderDisplay.setSkew?(this.armature.display.replace(prevDisplay,this._renderDisplay),this._renderDisplay.parentContainer=this.armature.display):console.warn("please call dragonBones.phaser.util.extendSkew to mix skew component into your display object,\n                                and set its pipeline to 'SkewPipeline' by calling 'setPipeline' method, more detail please refer to the 'ReplaceSlotDisplay.ts' example")},Slot.prototype._removeDisplay=function(){this._renderDisplay.parentContainer.remove(this._renderDisplay)},Slot.prototype._updateDisplayData=function(){_super.prototype._updateDisplayData.call(this),null!==this.armature.replacedTexture&&(this._textureDirty=!0)},Slot.prototype._updateZOrder=function(){this._renderDisplay.depth!==this._zOrder&&this._renderDisplay.setDepth(this._zOrder)},Slot.prototype._updateVisible=function(){this._renderDisplay.setVisible(this._parent.visible&&this._visible)},Slot.prototype._updateBlendMode=function(){var mode=Phaser.BlendModes.NORMAL;switch(this._blendMode){case 0:mode=Phaser.BlendModes.NORMAL;break;case 1:mode=Phaser.BlendModes.ADD;break;case 3:mode=Phaser.BlendModes.DARKEN;break;case 4:mode=Phaser.BlendModes.DIFFERENCE;break;case 6:mode=Phaser.BlendModes.HARD_LIGHT;break;case 9:mode=Phaser.BlendModes.LIGHTEN;break;case 10:mode=Phaser.BlendModes.MULTIPLY;break;case 11:mode=Phaser.BlendModes.OVERLAY;break;case 12:mode=Phaser.BlendModes.SCREEN}this._renderDisplay.setBlendMode(mode)},Slot.prototype._updateColor=function(){var c=this._colorTransform,a=this._globalAlpha*c.alphaMultiplier+c.alphaOffset;if(this._renderDisplay.setAlpha(a),!(this._renderDisplay instanceof display.DisplayContainer)){var r,g,b,rgb=255*c.redMultiplier+c.redOffset<<16|255*c.greenMultiplier+c.greenOffset<<8|255*c.blueMultiplier+c.blueOffset;this._renderDisplay.setTint(rgb)}},Slot.prototype._updateFrame=function(){if(!(this._renderDisplay instanceof display.DisplayContainer)){var currentTextureData=this._textureData;if(this._displayIndex>=0&&null!==this._display&&null!==currentTextureData){var currentTextureAtlasData=currentTextureData.parent;null!==this.armature.replacedTexture&&(null===this.armature._replaceTextureAtlasData?((currentTextureAtlasData=dragonBones.BaseObject.borrowObject(display.TextureAtlasData)).copyFrom(currentTextureData.parent),currentTextureAtlasData.renderTexture=this.armature.replacedTexture,this.armature._replaceTextureAtlasData=currentTextureAtlasData):currentTextureAtlasData=this.armature._replaceTextureAtlasData,currentTextureData=currentTextureAtlasData.getTexture(currentTextureData.name));var frame=currentTextureData.renderTexture;if(null!==frame){if(null!==this._geometryData){var data=this._geometryData.data,intArray=data.intArray,floatArray=data.floatArray,vertexCount=intArray[this._geometryData.offset+0],triangleCount=intArray[this._geometryData.offset+1],vertexOffset=intArray[this._geometryData.offset+2];vertexOffset<0&&(vertexOffset+=65536);for(var uvOffset=vertexOffset+2*vertexCount,scale=this._armature._armatureData.scale,meshDisplay=this._renderDisplay,region=currentTextureData.region,fakeVertices=[],fakeUvs=[],fakeIndices=[],i=0,l=2*vertexCount;i<l;++i)fakeVertices[i]=floatArray[vertexOffset+i]*scale,console.assert(null!=fakeVertices[i]);for(var i=0;i<3*triangleCount;++i)fakeIndices[i]=intArray[this._geometryData.offset+4+i];for(var i=0,l=2*vertexCount;i<l;i+=2){var u=floatArray[uvOffset+i],v=floatArray[uvOffset+i+1];currentTextureData.rotated?(fakeUvs[i]=(region.x+(1-v)*region.width)/currentTextureAtlasData.width,fakeUvs[i+1]=(region.y+u*region.height)/currentTextureAtlasData.height):(fakeUvs[i]=(region.x+u*region.width)/currentTextureAtlasData.width,fakeUvs[i+1]=(region.y+v*region.height)/currentTextureAtlasData.height)}meshDisplay.clear(),console.assert(fakeVertices.length%2==0),console.assert(fakeVertices.length>1||null!=fakeVertices[0]),meshDisplay.addVertices(fakeVertices,fakeUvs,fakeIndices),console.assert(meshDisplay.vertices.length>0),console.assert(null!=meshDisplay.vertices[0]),this._textureScale=1,meshDisplay.texture=frame.texture,meshDisplay.frame=frame,meshDisplay.updateVertices();var isSkinned=null!==this._geometryData.weight,isSurface=0!==this._parent._boneData.type;(isSkinned||isSurface)&&this._identityTransform()}else{var renderDisplay;(renderDisplay=this._renderDisplay).texture=frame.texture,renderDisplay.frame=frame,renderDisplay.setDisplayOrigin(this._pivotX,this._pivotY),this._textureScale=currentTextureData.parent.scale*this.armature.armatureData.scale,renderDisplay.setScale(this._textureScale)}return void(this._visibleDirty=!0)}}else{var renderDisplay;(renderDisplay=this._renderDisplay).x=0,renderDisplay.y=0,renderDisplay.setTexture&&renderDisplay.setTexture(void 0)}}},Slot.prototype._updateMesh=function(){var scale=this._armature._armatureData.scale,deformVertices=this._displayFrame.deformVertices,bones=this._geometryBones,geometryData=this._geometryData,weightData=geometryData.weight,hasDeform=deformVertices.length>0&&geometryData.inheritDeform,meshDisplay=this._renderDisplay;if(null!==weightData){var data,intArray=(data=geometryData.data).intArray,floatArray=data.floatArray,vertexCount=intArray[geometryData.offset+0],weightFloatOffset=intArray[weightData.offset+1];weightFloatOffset<0&&(weightFloatOffset+=65536);for(var i=0,iD=0,iB=weightData.offset+2+bones.length,iV=weightFloatOffset,iF=0;i<vertexCount;++i){for(var boneCount=intArray[iB++],xG=0,yG=0,j=0;j<boneCount;++j){var boneIndex,bone=bones[intArray[iB++]];if(null!==bone){var matrix=bone.globalTransformMatrix,weight=floatArray[iV++],xL=floatArray[iV++]*scale,yL=floatArray[iV++]*scale;hasDeform&&(xL+=deformVertices[iF++],yL+=deformVertices[iF++]),xG+=(matrix.a*xL+matrix.c*yL+matrix.tx)*weight,yG+=(matrix.b*xL+matrix.d*yL+matrix.ty)*weight}}console.assert(iD<meshDisplay.vertices.length),console.assert(null!=meshDisplay.vertices[iD]),meshDisplay.vertices[iD].x=xG,meshDisplay.vertices[iD].y=yG,iD+=1}}else{var isSurface=0!==this._parent._boneData.type,data,intArray=(data=geometryData.data).intArray,floatArray=data.floatArray,vertexCount=intArray[geometryData.offset+0],vertexOffset=intArray[geometryData.offset+2];vertexOffset<0&&(vertexOffset+=65536);for(var i=0;i<vertexCount;++i){var x=floatArray[vertexOffset+2*i]*scale,y=floatArray[vertexOffset+2*i+1]*scale;if(hasDeform&&(x+=deformVertices[2*i],y+=deformVertices[2*i+1]),isSurface){var matrix=this._parent._getGlobalTransformMatrix(x,y);console.assert(i<meshDisplay.vertices.length),console.assert(null!=meshDisplay.vertices[i]),meshDisplay.vertices[i].x=matrix.a*x+matrix.c*y+matrix.tx,meshDisplay.vertices[i].y=matrix.b*x+matrix.d*y+matrix.ty}else console.assert(i<meshDisplay.vertices.length),console.assert(null!=meshDisplay.vertices[i]),meshDisplay.vertices[i].x=x,meshDisplay.vertices[i].y=y}}meshDisplay.updateVertices()},Slot.prototype._updateTransform=function(){this.updateGlobalTransform();var transform=this.global;this._renderDisplay.x=transform.x,this._renderDisplay.y=transform.y,this._renderDisplay.rotation=transform.rotation,this._renderDisplay.setSkew&&this._renderDisplay.setSkew(transform.skew,0),this._renderDisplay.setScale(transform.scaleX*this._textureScale,transform.scaleY*this._textureScale)},Slot.prototype._identityTransform=function(){this._renderDisplay.setPosition(),this._renderDisplay.setRotation(),this._textureScale=1,this._renderDisplay.setScale(this._textureScale),this._renderDisplay.setSkew(0)},Slot}(dragonBones.Slot);display.Slot=Slot}(display=phaser.display||(phaser.display={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var display;!function(display){var TextureAtlasData=function(_super){function TextureAtlasData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._renderTexture=null,_this}return __extends(TextureAtlasData,_super),TextureAtlasData.toString=function(){return"[class dragonBones.PhaserTextureAtlasData]"},TextureAtlasData.prototype._onClear=function(){_super.prototype._onClear.call(this),null!==this._renderTexture&&this._renderTexture.destroy(),this._renderTexture=null},TextureAtlasData.prototype.createTexture=function(){return dragonBones.BaseObject.borrowObject(TextureData)},Object.defineProperty(TextureAtlasData.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(value){if(value&&this._renderTexture!==value)for(var k in this._renderTexture&&this._renderTexture.destroy(),this._renderTexture=value,this.textures){var data=this.textures[k],frame=this._renderTexture.add(k,0,data.region.x,data.region.y,data.region.width,data.region.height);data.rotated&&(frame.rotated=!0,frame.updateUVsInverted()),data.renderTexture=frame}},enumerable:!0,configurable:!0}),TextureAtlasData.prototype.releaseRenderTexture=function(){this._renderTexture=null},TextureAtlasData}(dragonBones.TextureAtlasData);display.TextureAtlasData=TextureAtlasData;var TextureData=function(_super){function TextureData(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.renderTexture=null,_this}return __extends(TextureData,_super),TextureData.toString=function(){return"[class dragonBones.PhaserTextureData]"},TextureData.prototype._onClear=function(){_super.prototype._onClear.call(this),null!==this.renderTexture&&this.renderTexture.destroy(),this.renderTexture=null},TextureData}(dragonBones.TextureData);display.TextureData=TextureData}(display=phaser.display||(phaser.display={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var pipeline;!function(pipeline){var SkewPipeline=function(_super){function SkewPipeline(config){var _this=_super.call(this,config)||this;return _this._tempMatrix1=new phaser.util.TransformMatrix,_this._tempMatrix2=new phaser.util.TransformMatrix,_this._tempMatrix3=new phaser.util.TransformMatrix,_this}return __extends(SkewPipeline,_super),SkewPipeline.prototype.batchSprite=function(sprite,camera,parentTransformMatrix){var frame=sprite.frame;if(frame&&frame.source){this.manager.set(this,sprite);var camMatrix=this._tempMatrix1,spriteMatrix=this._tempMatrix2,calcMatrix=this._tempMatrix3,texture=frame.glTexture,u0=frame.u0,v0=frame.v0,u1=frame.u1,v1=frame.v1,frameX=frame.x,frameY=frame.y,frameWidth=frame.width,frameHeight=frame.height,customPivot=frame.customPivot,displayOriginX=sprite.displayOriginX,displayOriginY=sprite.displayOriginY,x=-sprite.displayOriginX+frameX,y=-sprite.displayOriginY+frameY;if(sprite.isCropped){var crop=sprite._crop;crop.flipX===sprite.flipX&&crop.flipY===sprite.flipY||frame.updateCropUVs(crop,sprite.flipX,sprite.flipY),u0=crop.u0,v0=crop.v0,u1=crop.u1,v1=crop.v1,frameWidth=crop.width,frameHeight=crop.height,frameX=crop.x,frameY=crop.y,x=-sprite.displayOriginX+frameX,y=-sprite.displayOriginY+frameY}var flipX=1,flipY=1;sprite.flipX&&(customPivot||(x+=-frame.realWidth+2*displayOriginX),flipX=-1,x+=frameWidth,frameWidth*=-1),(sprite.flipY||frame.source.isGLTexture&&texture.flipY)&&(customPivot||(y+=-frame.realHeight+2*displayOriginY),flipY=-1),spriteMatrix.applyITRS(sprite.x,sprite.y,sprite.rotation,sprite.scaleX*flipX,sprite.scaleY*flipY,sprite.skewX||0,sprite.skewY||0),camMatrix.copyFrom(camera.matrix),parentTransformMatrix?(camMatrix.multiplyWithOffset(parentTransformMatrix,-camera.scrollX*sprite.scrollFactorX,-camera.scrollY*sprite.scrollFactorY),spriteMatrix.e=sprite.x,spriteMatrix.f=sprite.y):(spriteMatrix.e-=camera.scrollX*sprite.scrollFactorX,spriteMatrix.f-=camera.scrollY*sprite.scrollFactorY),camMatrix.multiply(spriteMatrix,calcMatrix);var xw=x+frameWidth,yh=y+frameHeight,tx0=calcMatrix.getX(x,y),ty0=calcMatrix.getY(x,y),tx1=calcMatrix.getX(x,yh),ty1=calcMatrix.getY(x,yh),tx2=calcMatrix.getX(xw,yh),ty2=calcMatrix.getY(xw,yh),tx3=calcMatrix.getX(xw,y),ty3=calcMatrix.getY(xw,y),getTint=Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha,spriteAlpha=sprite,tintTL=getTint(sprite.tintTopLeft,camera.alpha*spriteAlpha._alphaTL),tintTR=getTint(sprite.tintTopRight,camera.alpha*spriteAlpha._alphaTR),tintBL=getTint(sprite.tintBottomLeft,camera.alpha*spriteAlpha._alphaBL),tintBR=getTint(sprite.tintBottomRight,camera.alpha*spriteAlpha._alphaBR);this.shouldFlush(6)&&this.flush();var unit=this.setGameObject(sprite,frame);this.manager.preBatch(sprite),this.batchQuad(sprite,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,sprite.tintFill,texture,unit),this.manager.postBatch(sprite)}},SkewPipeline}(Phaser.Renderer.WebGL.Pipelines.MultiPipeline);pipeline.SkewPipeline=SkewPipeline}(pipeline=phaser.pipeline||(phaser.pipeline={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var plugin;!function(plugin){plugin.FileTypes={IMAGE:"imageFile",JSON:"jsonFile",BINARY:"binaryFile",map:{imageFile:Phaser.Loader.FileTypes.ImageFile,jsonFile:Phaser.Loader.FileTypes.JSONFile,binaryFile:Phaser.Loader.FileTypes.BinaryFile},setType:function(type,clazz){plugin.FileTypes.map[type]=clazz},getType:function(type){return plugin.FileTypes.map[type]}}}(plugin=phaser.plugin||(phaser.plugin={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones){var phaser;!function(phaser){var plugin;!function(plugin){var DragonBonesFile=function(_super){function DragonBonesFile(loader,key,textureURL,atlasURL,boneURL,textureXhrSettings,atlasXhrSettings,boneXhrSettings){var _this=this,image,data,boneData,keyName,binFileType=plugin.FileTypes.getType(plugin.FileTypes.BINARY),jsonFileType=plugin.FileTypes.getType(plugin.FileTypes.JSON),imageFileType=plugin.FileTypes.getType(plugin.FileTypes.IMAGE),createBoneFileByType=function(loader,key,boneURL,boneXhrSettings){var type="json";if(boneXhrSettings&&boneXhrSettings.responseType)switch(boneXhrSettings.responseType){case"arraybuffer":case"blob":type="bin";break;case"json":case"text":type="json"}return"bin"===type?new binFileType(loader,key,boneURL,boneXhrSettings):new jsonFileType(loader,key,boneURL,boneXhrSettings)};if(Phaser.Utils.Objects.IsPlainObject(key)){var config=key;image=new imageFileType(loader,{key:keyName=Phaser.Utils.Objects.GetFastValue(config,"key"),url:Phaser.Utils.Objects.GetFastValue(config,"textureURL"),extension:Phaser.Utils.Objects.GetFastValue(config,"textureExtension","png"),xhrSettings:Phaser.Utils.Objects.GetFastValue(config,"textureXhrSettings")}),data=new jsonFileType(loader,{key:keyName+"_atlasjson",url:Phaser.Utils.Objects.GetFastValue(config,"atlasURL"),extension:Phaser.Utils.Objects.GetFastValue(config,"atlasExtension","json"),xhrSettings:Phaser.Utils.Objects.GetFastValue(config,"atlasXhrSettings")}),boneData=createBoneFileByType(loader,keyName,Phaser.Utils.Objects.GetFastValue(config,"boneURL"),Phaser.Utils.Objects.GetFastValue(config,"boneXhrSettings"))}else image=new imageFileType(loader,keyName=key,textureURL,textureXhrSettings),data=new jsonFileType(loader,keyName+"_atlasjson",atlasURL,atlasXhrSettings),boneData=createBoneFileByType(loader,keyName,boneURL,boneXhrSettings);return boneData.cache=loader.cacheManager.custom.dragonbone,_this=_super.call(this,loader,"dragonbone",keyName,[image,data,boneData])||this}return __extends(DragonBonesFile,_super),DragonBonesFile.prototype.addToCache=function(){if(this.isReadyToProcess()){var image=this.files[0],json=this.files[1],bone=this.files[2];json.addToCache(),bone.addToCache(),image.addToCache(),this.complete=!0}},DragonBonesFile}(Phaser.Loader.MultiFile);plugin.DragonBonesFile=DragonBonesFile}(plugin=phaser.plugin||(phaser.plugin={}))}(phaser=dragonBones.phaser||(dragonBones.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones_2){var phaser;!function(phaser){var plugin;!function(plugin){var DragonBonesScenePlugin=function(_super){function DragonBonesScenePlugin(scene,pluginManager){var _this=_super.call(this,scene,pluginManager)||this,game=_this.game;if(game.cache.addCustom("dragonbone"),_this.game.config.renderType===Phaser.WEBGL){var renderer=_this.game.renderer;renderer.pipelines.has("SkewPipeline")||renderer.pipelines.add("SkewPipeline",new phaser.pipeline.SkewPipeline({game:game}))}return pluginManager.registerGameObject("dragonBones",CreateDragonBonesRegisterHandler),pluginManager.registerGameObject("armature",CreateArmatureRegisterHandler),pluginManager.registerFileType("dragonbone",DragonBoneFileRegisterHandler,scene),pluginManager.registerGameObject("dbSlotImage",(function(x,y,texture,frame){return this.displayList.add(new phaser.display.SlotImage(this.scene,x,y,texture,frame))})),pluginManager.registerGameObject("dbSlotSprite",(function(x,y,texture,frame){return this.displayList.add(new phaser.display.SlotSprite(this.scene,x,y,texture,frame))})),pluginManager.registerGameObject("dbSlotMesh",(function(x,y,vertices,uv,colors,alphas,texture,frame){return this.displayList.add(new phaser.display.SlotMesh(this.scene,x,y,vertices,uv,colors,alphas,texture,frame))})),_this}return __extends(DragonBonesScenePlugin,_super),DragonBonesScenePlugin.prototype.createArmature=function(armature,dragonBones,skinName,atlasTextureName,textureScale){void 0===textureScale&&(textureScale=1);var display=this.factory.buildArmatureDisplay(armature,dragonBones,skinName,atlasTextureName,textureScale);return this.systems.displayList.add(display),this._dbInst.clock.add(display.armature),display},DragonBonesScenePlugin.prototype.createDragonBones=function(dragonBonesName,textureScale){return void 0===textureScale&&(textureScale=1),this.factory.buildDragonBonesData(dragonBonesName,textureScale)},Object.defineProperty(DragonBonesScenePlugin.prototype,"factory",{get:function(){return this._factory||(this._dbInst=new dragonBones.DragonBones(new phaser.util.EventDispatcher),this._factory=new phaser.Factory(this._dbInst,this.scene)),this._factory},enumerable:!0,configurable:!0}),DragonBonesScenePlugin.prototype.createSlotDisplayPlaceholder=function(){return new phaser.display.SlotImage(this.scene,0,0)},DragonBonesScenePlugin.prototype.boot=function(){this.systems.events.once("destroy",this.destroy,this),this.start()},DragonBonesScenePlugin.prototype.start=function(){var ee=this.systems.events;ee.on("update",this.update,this),ee.once("shutdown",this.shutdown,this)},DragonBonesScenePlugin.prototype.update=function(time,delta){this._dbInst&&this._dbInst.advanceTime(.001*delta)},DragonBonesScenePlugin.prototype.shutdown=function(){var ee=this.systems.events;ee.off("update",this.update,this),ee.off("shutdown",this.shutdown,this)},DragonBonesScenePlugin.prototype.destroy=function(){this.shutdown(),this._factory=this._dbInst=null,this.pluginManager=this.game=this.scene=this.systems=null},DragonBonesScenePlugin.prototype.createMeshDisplayPlaceholder=function(){return new phaser.display.SlotMesh(this.scene,0,0,[],[],[],[],null,null)},DragonBonesScenePlugin}(Phaser.Plugins.ScenePlugin);plugin.DragonBonesScenePlugin=DragonBonesScenePlugin;var CreateDragonBonesRegisterHandler=function(dragonBonesName,textureScale){return void 0===textureScale&&(textureScale=1),this.scene.dragonbone.createDragonBones(dragonBonesName,textureScale)},CreateArmatureRegisterHandler=function(armature,dragonBones,skinName,atlasTextureName){return this.scene.dragonbone.createArmature(armature,dragonBones,skinName,atlasTextureName)},DragonBoneFileRegisterHandler=function(dragonbonesName,textureURL,atlasURL,boneURL,textureXhrSettings,atlasXhrSettings,boneXhrSettings){var multifile=new plugin.DragonBonesFile(this,dragonbonesName,textureURL,atlasURL,boneURL,textureXhrSettings,atlasXhrSettings,boneXhrSettings);return this.addFile(multifile.files),this}}(plugin=phaser.plugin||(phaser.plugin={}))}(phaser=dragonBones_2.phaser||(dragonBones_2.phaser={}))}(dragonBones||(dragonBones={})),function(dragonBones_3){var phaser;!function(phaser){var Factory=function(_super){function Factory(dragonBones,scene,dataParser){var _this=_super.call(this,dataParser)||this;return _this._scene=scene,_this._dragonBones=dragonBones,_this}return __extends(Factory,_super),Factory.prototype._isSupportMesh=function(){return!0},Factory.prototype._buildTextureAtlasData=function(textureAtlasData,textureAtlas){return textureAtlasData?textureAtlasData.renderTexture=textureAtlas:textureAtlasData=dragonBones_3.BaseObject.borrowObject(phaser.display.TextureAtlasData),textureAtlasData},Factory.prototype._buildArmature=function(dataPackage){var armature=dragonBones_3.BaseObject.borrowObject(dragonBones_3.Armature),armatureDisplay=new phaser.display.ArmatureDisplay(this._scene);return armature.init(dataPackage.armature,armatureDisplay,armatureDisplay,this._dragonBones),armature},Factory.prototype._buildSlot=function(dataPackage,slotData,armature){var slot=dragonBones_3.BaseObject.borrowObject(phaser.display.Slot),rawDisplay=this._scene.dragonbone.createSlotDisplayPlaceholder(),meshDisplay=this._scene.dragonbone.createMeshDisplayPlaceholder();return slot.init(slotData,armature,rawDisplay,meshDisplay),slot},Factory.prototype.buildArmatureDisplay=function(armatureName,dragonBonesName,skinName,textureAtlasName,textureScale){var armature;return void 0===skinName&&(skinName=""),void 0===textureAtlasName&&(textureAtlasName=""),void 0===textureScale&&(textureScale=1),this.buildDragonBonesData(dragonBonesName,textureScale)&&(armature=this.buildArmature(armatureName,dragonBonesName,skinName,textureAtlasName)),armature.display},Factory.prototype.buildDragonBonesData=function(dragonBonesName,textureScale){void 0===textureScale&&(textureScale=1);var data=this._dragonBonesDataMap[dragonBonesName];if(!data){var cache=this._scene.cache,boneRawData=cache.custom.dragonbone.get(dragonBonesName);if(boneRawData){data=this.parseDragonBonesData(boneRawData,dragonBonesName,textureScale);var texture=this._scene.textures.get(dragonBonesName),json=cache.json.get(dragonBonesName+"_atlasjson");this.parseTextureAtlasData(json,texture,texture.key,textureScale)}}return data},Object.defineProperty(Factory.prototype,"soundEventManager",{get:function(){return this._dragonBones.eventManager},enumerable:!0,configurable:!0}),Factory}(dragonBones_3.BaseFactory);phaser.Factory=Factory}(phaser=dragonBones_3.phaser||(dragonBones_3.phaser={}))}(dragonBones||(dragonBones={}));